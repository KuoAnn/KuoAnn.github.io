[{"title":"AI 通識","url":"/posts/3327344738/","content":"<h2 id=\"What-is-AI\"><a href=\"#What-is-AI\" class=\"headerlink\" title=\"What is AI\"></a>What is AI</h2><ul>\n<li>工人智慧 vs. 人工智慧</li>\n</ul>\n<p><img data-src=\"https://hackmd.io/_uploads/rkrlxiLLT.png\" alt=\"image\"></p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9oYWNrbWQuaW8vQHdlYmNvbmYvQmtJbVEwRHMzLyUyRlR6NFhEaDc0U3FHRERaaUdjV0JhS2c=\">WebConf 2023 共筆<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"Generative-AI\"><a href=\"#Generative-AI\" class=\"headerlink\" title=\"Generative AI\"></a>Generative AI</h2><ul>\n<li>隨機性：連 AI 開發者都很難追溯其結果是怎麼產生的</li>\n</ul>\n<h3 id=\"LLM\"><a href=\"#LLM\" class=\"headerlink\" title=\"LLM\"></a>LLM</h3><ul>\n<li>Google - <span class=\"exturl\" data-url=\"aHR0cHM6Ly9iYXJkLmdvb2dsZS5jb20vY2hhdA==\">Bard<i class=\"fa fa-external-link-alt\"></i></span></li>\n<li>Microsoft - <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb3BpbG90Lm1pY3Jvc29mdC5jb20v\">Copilot<i class=\"fa fa-external-link-alt\"></i></span><ul>\n<li>具上網搜尋能力</li>\n<li>可生成圖像</li>\n<li> 2023/12/05 升級底層技術至新版 DALL-E 3 與 GPT-4 Turbo<br><img data-src=\"https://hackmd.io/_uploads/S1HBys88T.png\" alt=\"image\"></li>\n</ul>\n</li>\n<li>xAI - <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ncm9rLnguYWkv\">Grok<i class=\"fa fa-external-link-alt\"></i></span></li>\n<li>Anthropic - <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbGF1ZGUuYWkvY2hhdHM=\">Claude 2<i class=\"fa fa-external-link-alt\"></i></span><ul>\n<li>前 ChatGPT 開發團隊跳出來做的產品</li>\n<li>支援上傳附件 (for 免費仔)</li>\n</ul>\n</li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9vcGVuYWkuY29tLw==\">Open AI<i class=\"fa fa-external-link-alt\"></i></span> - <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jaGF0Lm9wZW5haS5jb20v\">ChatGPT<i class=\"fa fa-external-link-alt\"></i></span><table>\n<thead>\n<tr>\n<th>模型</th>\n<th>用途</th>\n<th>使用情境</th>\n</tr>\n</thead>\n<tbody><tr>\n<td> GPT 系列</td>\n<td>一系列的模型，可以理解和生成自然語言或代碼</td>\n<td>自然語言處理、對話機器人、文本生成</td>\n</tr>\n<tr>\n<td> DALL·E</td>\n<td> 一個可以根據自然語言提示生成和編輯圖像的模型</td>\n<td>圖像生成、圖像編輯、視覺藝術</td>\n</tr>\n<tr>\n<td> Whisper</td>\n<td> 一個可以將語音轉換為文本的模型</td>\n<td>語音識別、語音轉文字</td>\n</tr>\n<tr>\n<td> Embeddings</td>\n<td> 一系列的模型，可以將文本轉換為數值形式</td>\n<td>自然語言處理、文本分析、情感分析</td>\n</tr>\n<tr>\n<td> Codex</td>\n<td> 一系列的模型，可以理解和生成代碼，包括將自然語言轉換為代碼</td>\n<td>代碼生成、代碼編輯、自然語言處理</td>\n</tr>\n<tr>\n<td> Moderation</td>\n<td> 一個經過微調的模型，可以檢測文本是否可能敏感或不安全</td>\n<td>在線社交平台、內容審查</td>\n</tr>\n</tbody></table>\n<ul>\n<li><p> 2021 年 9 月前的訓練資料</p>\n</li>\n<li><p>GPT 4/GPT Plus 須付費解鎖</p>\n</li>\n<li><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9wbGF0Zm9ybS5vcGVuYWkuY29tL3Rva2VuaXplcg==\">Token<i class=\"fa fa-external-link-alt\"></i></span>：</p>\n<ul>\n<li>GPT-3.5 Turbo：4097(4k) tokens</li>\n<li>GPT-4：32,768 (32K)</li>\n<li>GPT-4 Turbo：128K (約可容納或考慮逾 300 頁的文字)<blockquote>\n<p>For example, the string “ChatGPT is great!” is encoded into six tokens: [“Chat”, “G”, “PT”, “ is”, “ great”, “!”]</p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li><p>Role：<code>user</code> <code>assistant</code> <code>system</code></p>\n<figure class=\"highlight json\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">{</span></span><br><span class=\"line\">  <span class=\"attr\">\"messages\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">    <span class=\"punctuation\">{</span></span><br><span class=\"line\">      <span class=\"attr\">\"role\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"user\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">\"content\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"tell me a joke\"</span></span><br><span class=\"line\">    <span class=\"punctuation\">}</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"punctuation\">{</span></span><br><span class=\"line\">      <span class=\"attr\">\"role\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"assistant\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">\"content\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"why did the chicken cross the road\"</span></span><br><span class=\"line\">    <span class=\"punctuation\">}</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"punctuation\">{</span></span><br><span class=\"line\">      <span class=\"attr\">\"role\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"user\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">\"content\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"I don't know, why did the chicken cross the road\"</span></span><br><span class=\"line\">    <span class=\"punctuation\">}</span></span><br><span class=\"line\">  <span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">}</span></span><br></pre></td></tr></tbody></table></figure>\n\n<figure class=\"highlight json\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">{</span></span><br><span class=\"line\">  <span class=\"attr\">\"messages\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">    <span class=\"punctuation\">{</span></span><br><span class=\"line\">      <span class=\"attr\">\"role\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"system\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">\"content\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"You are an assistant that speaks like Shakespeare.\"</span></span><br><span class=\"line\">    <span class=\"punctuation\">}</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"punctuation\">{</span></span><br><span class=\"line\">      <span class=\"attr\">\"role\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"user\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">\"content\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"tell me a joke\"</span></span><br><span class=\"line\">    <span class=\"punctuation\">}</span></span><br><span class=\"line\">  <span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">}</span></span><br></pre></td></tr></tbody></table></figure>\n\n<figure class=\"highlight json\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">{</span></span><br><span class=\"line\">  <span class=\"attr\">\"message\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">{</span></span><br><span class=\"line\">    <span class=\"attr\">\"role\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"assistant\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"content\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"Why did the chicken cross the road? To get to the other side, but verily, the other side was full of peril and danger, so it quickly returned from whence it came, forsooth!\"</span></span><br><span class=\"line\">  <span class=\"punctuation\">}</span></span><br><span class=\"line\"><span class=\"punctuation\">}</span></span><br></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>自訂指令</p>\n</li>\n<li><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9vcGVuYWkuY29tL2Jsb2cvaW50cm9kdWNpbmctZ3B0cw==\">GPTs<i class=\"fa fa-external-link-alt\"></i></span></p>\n</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"for-Developer\"><a href=\"#for-Developer\" class=\"headerlink\" title=\"for Developer\"></a>for Developer</h4><ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZ2LmFpL3po\">Devv<i class=\"fa fa-external-link-alt\"></i></span>：著重程式面</li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuc3FsY2hhdC5haS8=\"> SqlChat<i class=\"fa fa-external-link-alt\"></i></span>：著重 SQL</li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ2l0Zmx1ZW5jZS5jb20v\">GitFluence<i class=\"fa fa-external-link-alt\"></i></span>：著重 Git 指令</li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLm1pbmlhc3AuY29tL3Bvc3QvMjAyMy8xMC8xOC9XaWxsLUFJLVRvb2xzLUxpc3Q=\"> Will 保哥的 AI 協作工具清單<i class=\"fa fa-external-link-alt\"></i></span></li>\n</ul>\n<h3 id=\"Visual-Image\"><a href=\"#Visual-Image\" class=\"headerlink\" title=\"Visual/Image\"></a>Visual/Image</h3><ul>\n<li>Open AI - GPT4<br>  <img data-src=\"https://hackmd.io/_uploads/SymdljU8T.png\" alt=\"image\"></li>\n<li>Vercel - <span class=\"exturl\" data-url=\"aHR0cHM6Ly92MC5kZXYv\">v0<i class=\"fa fa-external-link-alt\"></i></span></li>\n<li>Google - <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZWVwbWluZC5nb29nbGUvdGVjaG5vbG9naWVzL2dlbWluaS8jaW50cm9kdWN0aW9u\">Gemini<i class=\"fa fa-external-link-alt\"></i></span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWlkam91cm5leS5jb20vaG9tZT9jYWxsYmFja1VybD0vZXhwbG9yZQ==\">Midjourney<i class=\"fa fa-external-link-alt\"></i></span></li>\n</ul>\n<hr>\n","categories":["Others"],"tags":["AI"]},{"title":"Change Git Upstream to Origin","url":"/posts/3949037657/","content":"<figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/sh</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 遍歷資料夾下的所有子資料夾</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">dir</span> <span class=\"keyword\">in</span> */; <span class=\"keyword\">do</span></span><br><span class=\"line\">  <span class=\"comment\"># 進入子資料夾</span></span><br><span class=\"line\">  <span class=\"built_in\">cd</span> <span class=\"string\">\"<span class=\"variable\">$dir</span>\"</span> || <span class=\"built_in\">continue</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># 檢查是否為 git 專案</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> [ -d <span class=\"string\">\".git\"</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    <span class=\"comment\"># 獲取當前分支名稱</span></span><br><span class=\"line\">    current_branch=$(git symbolic-ref --short HEAD)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 設置 upstream 至 origin 下</span></span><br><span class=\"line\">    git branch --set-upstream-to=<span class=\"string\">\"origin/<span class=\"variable\">$current_branch</span>\"</span> <span class=\"string\">\"<span class=\"variable\">$current_branch</span>\"</span></span><br><span class=\"line\">  <span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># 返回上一級資料夾</span></span><br><span class=\"line\">  <span class=\"built_in\">cd</span> ..</span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></tbody></table></figure>\n","categories":["Git"],"tags":["Git","Bash"]},{"title":"OpenAI API in Javascript","url":"/posts/3263803727/","content":"<ul>\n<li>透過 Js 發送 OpenAI 官方提供的 API (<span class=\"exturl\" data-url=\"aHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25z\">https://api.openai.com/v1/chat/completions<i class=\"fa fa-external-link-alt\"></i></span>)，需至 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9wbGF0Zm9ybS5vcGVuYWkuY29tL2FjY291bnQvYXBpLWtleXM=\">官方網站<i class=\"fa fa-external-link-alt\"></i></span> 申請 API Key 才能使用</li>\n<li> API 規格參考：<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9wbGF0Zm9ybS5vcGVuYWkuY29tL2RvY3MvYXBpLXJlZmVyZW5jZS9tYWtpbmctcmVxdWVzdHM=\">https://platform.openai.com/docs/api-reference/making-requests<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n<span id=\"more\"></span></li>\n</ul>\n<h2 id=\"Rq\"><a href=\"#Rq\" class=\"headerlink\" title=\"Rq\"></a>Rq</h2><h3 id=\"Header\"><a href=\"#Header\" class=\"headerlink\" title=\"Header\"></a>Header</h3><figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">curl https://api.openai.com/v1/completions \\</span><br><span class=\"line\">  -H <span class=\"string\">\"Content-Type: application/json\"</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">\"Authorization: Bearer <span class=\"variable\">$OPENAI_API_KEY</span>\"</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">'{</span></span><br><span class=\"line\"><span class=\"string\">    \"model\": \"text-davinci-003\",</span></span><br><span class=\"line\"><span class=\"string\">    \"prompt\": \"Say this is a test\",</span></span><br><span class=\"line\"><span class=\"string\">    \"max_tokens\": 7,</span></span><br><span class=\"line\"><span class=\"string\">    \"temperature\": 0</span></span><br><span class=\"line\"><span class=\"string\">  }'</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"Body\"><a href=\"#Body\" class=\"headerlink\" title=\"Body\"></a>Body</h3><figure class=\"highlight js\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">{</span><br><span class=\"line\">     <span class=\"string\">\"model\"</span>: <span class=\"string\">\"gpt-3.5-turbo\"</span>,</span><br><span class=\"line\">     <span class=\"string\">\"messages\"</span>: [{<span class=\"string\">\"role\"</span>: <span class=\"string\">\"user\"</span>, <span class=\"string\">\"content\"</span>: <span class=\"string\">\"Say this is a test!\"</span>}],</span><br><span class=\"line\">     <span class=\"string\">\"temperature\"</span>: <span class=\"number\">0.7</span></span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n\n<ul>\n<li>model：指定語言模型，不同語言模型的上行內容會不同，以下以 <code>gpt-3.5-turbo</code> 參考<ul>\n<li>雖上行指定 <code>gpt3.5-turbo</code>，但從下行的資訊可以看出實際使用的會是 <code>gpt-3.5-turbo-0301</code>，但該模型</li>\n</ul>\n</li>\n<li> message：<ul>\n<li>role=<code>system</code>：指定角色 (非必填)，可用中文，範例用英文的目的是為了降 Token 數，以節省成本</li>\n<li> role=<code>user</code>：問題內容，如有延續關係可串多組</li>\n</ul>\n</li>\n<li> temperature：What sampling temperature to use, between 0 and 2. Higher values like 0.8 will make the output more random, while lower values like 0.2 will make it more focused and deterministic.</li>\n</ul>\n<h2 id=\"Rs\"><a href=\"#Rs\" class=\"headerlink\" title=\"Rs\"></a>Rs</h2><figure class=\"highlight js\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">{</span><br><span class=\"line\">   <span class=\"string\">\"id\"</span>:<span class=\"string\">\"chatcmpl-abc123\"</span>,</span><br><span class=\"line\">   <span class=\"string\">\"object\"</span>:<span class=\"string\">\"chat.completion\"</span>,</span><br><span class=\"line\">   <span class=\"string\">\"created\"</span>:<span class=\"number\">1677858242</span>,</span><br><span class=\"line\">   <span class=\"string\">\"model\"</span>:<span class=\"string\">\"gpt-3.5-turbo-0301\"</span>,</span><br><span class=\"line\">   <span class=\"string\">\"usage\"</span>:{</span><br><span class=\"line\">      <span class=\"string\">\"prompt_tokens\"</span>:<span class=\"number\">13</span>,</span><br><span class=\"line\">      <span class=\"string\">\"completion_tokens\"</span>:<span class=\"number\">7</span>,</span><br><span class=\"line\">      <span class=\"string\">\"total_tokens\"</span>:<span class=\"number\">20</span></span><br><span class=\"line\">   },</span><br><span class=\"line\">   <span class=\"string\">\"choices\"</span>:[</span><br><span class=\"line\">      {</span><br><span class=\"line\">         <span class=\"string\">\"message\"</span>:{</span><br><span class=\"line\">            <span class=\"string\">\"role\"</span>:<span class=\"string\">\"assistant\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"content\"</span>:<span class=\"string\">\"\\n\\nThis is a test!\"</span></span><br><span class=\"line\">         },</span><br><span class=\"line\">         <span class=\"string\">\"finish_reason\"</span>:<span class=\"string\">\"stop\"</span>,</span><br><span class=\"line\">         <span class=\"string\">\"index\"</span>:<span class=\"number\">0</span></span><br><span class=\"line\">      }</span><br><span class=\"line\">   ]</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"Js-Sample\"><a href=\"#Js-Sample\" class=\"headerlink\" title=\"Js Sample\"></a>Js Sample</h2><p>範例以 Vanilla js 開發，可使用其他能 POST 的套件</p>\n<figure class=\"highlight js\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">send2Gpt</span>(<span class=\"params\">sQuestion</span>) {</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable constant_\">OPENAI_API_KEY</span> == <span class=\"literal\">null</span>) {</span><br><span class=\"line\">        <span class=\"variable constant_\">OPENAI_API_KEY</span> = <span class=\"title function_\">prompt</span>(<span class=\"string\">\"Enter Your OPENAI_API_KEY\"</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable constant_\">OPENAI_API_KEY</span> === <span class=\"literal\">null</span>) {</span><br><span class=\"line\">            <span class=\"title function_\">alert</span>(<span class=\"string\">\"You did not enter OPENAI_API_KEY\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (sQuestion === <span class=\"string\">\"\"</span>) {</span><br><span class=\"line\">        <span class=\"title function_\">alert</span>(<span class=\"string\">\"Type in your question!\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">let</span> q = <span class=\"string\">\"Translate into zh-TW\\n\"</span> + sQuestion;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">\"Send Gpt: \"</span> + q);</span><br><span class=\"line\"></span><br><span class=\"line\">    $(<span class=\"string\">\"#btnTransAll\"</span>).<span class=\"title function_\">text</span>(<span class=\"string\">\"Translating...\"</span>).<span class=\"title function_\">prop</span>(<span class=\"string\">\"disabled\"</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">const</span> oHttp = <span class=\"keyword\">new</span> <span class=\"title class_\">XMLHttpRequest</span>();</span><br><span class=\"line\">    oHttp.<span class=\"title function_\">open</span>(<span class=\"string\">\"POST\"</span>, <span class=\"string\">\"https://api.openai.com/v1/chat/completions\"</span>);</span><br><span class=\"line\">    oHttp.<span class=\"title function_\">setRequestHeader</span>(<span class=\"string\">\"Accept\"</span>, <span class=\"string\">\"application/json\"</span>);</span><br><span class=\"line\">    oHttp.<span class=\"title function_\">setRequestHeader</span>(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/json\"</span>);</span><br><span class=\"line\">    oHttp.<span class=\"title function_\">setRequestHeader</span>(<span class=\"string\">\"Authorization\"</span>, <span class=\"string\">\"Bearer \"</span> + <span class=\"variable constant_\">OPENAI_API_KEY</span>);</span><br><span class=\"line\">    oHttp.<span class=\"property\">onreadystatechange</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) {</span><br><span class=\"line\">        $(<span class=\"string\">\"#btnTransAll\"</span>).<span class=\"title function_\">text</span>(<span class=\"string\">\"Done\"</span>).<span class=\"title function_\">prop</span>(<span class=\"string\">\"disabled\"</span>, <span class=\"literal\">false</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (oHttp.<span class=\"property\">readyState</span> === <span class=\"number\">4</span>) {</span><br><span class=\"line\">            <span class=\"keyword\">var</span> oJson = {};</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">try</span> {</span><br><span class=\"line\">                oJson = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>(oHttp.<span class=\"property\">responseText</span>);</span><br><span class=\"line\">            } <span class=\"keyword\">catch</span> (ex) {</span><br><span class=\"line\">                <span class=\"title function_\">alert</span>(<span class=\"string\">\"GPT Parse Error: \"</span> + ex.<span class=\"property\">message</span>);</span><br><span class=\"line\">                log.<span class=\"title function_\">console</span>(<span class=\"string\">\"Resp:\"</span> + oHttp.<span class=\"property\">responseText</span>);</span><br><span class=\"line\">            }</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (oJson.<span class=\"property\">error</span> &amp;&amp; oJson.<span class=\"property\">error</span>.<span class=\"property\">message</span>) {</span><br><span class=\"line\">                <span class=\"title function_\">alert</span>(<span class=\"string\">\"GPT Error: \"</span> + oJson.<span class=\"property\">error</span>.<span class=\"property\">message</span>);</span><br><span class=\"line\">                <span class=\"variable language_\">console</span>.<span class=\"title function_\">eror</span>(<span class=\"string\">\"GPT Error: \"</span> + oJson.<span class=\"property\">error</span>.<span class=\"property\">message</span>);</span><br><span class=\"line\">            } <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (oJson.<span class=\"property\">choices</span> &amp;&amp; oJson.<span class=\"property\">choices</span>[<span class=\"number\">0</span>].<span class=\"property\">message</span>) {</span><br><span class=\"line\">                <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(oJson);</span><br><span class=\"line\">                <span class=\"keyword\">var</span> s = oJson.<span class=\"property\">choices</span>[<span class=\"number\">0</span>].<span class=\"property\">message</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (s == <span class=\"string\">\"\"</span>) {</span><br><span class=\"line\">                    <span class=\"title function_\">alert</span>(<span class=\"string\">\"GPT response empty\"</span>);</span><br><span class=\"line\">                } <span class=\"keyword\">else</span> {</span><br><span class=\"line\">                    <span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">setItem</span>(<span class=\"string\">\"OPENAI_API_KEY\"</span>, <span class=\"variable constant_\">OPENAI_API_KEY</span>);</span><br><span class=\"line\">                    </span><br><span class=\"line\">                    <span class=\"comment\">// Get Answer</span></span><br><span class=\"line\">                    <span class=\"title function_\">alert</span>(s.<span class=\"property\">content</span>);</span><br><span class=\"line\">                }</span><br><span class=\"line\">            } <span class=\"keyword\">else</span> {</span><br><span class=\"line\">                <span class=\"title function_\">alert</span>(<span class=\"string\">\"GPT Occurs Exception: \"</span> + oHttp.<span class=\"property\">responseText</span>);</span><br><span class=\"line\">                <span class=\"variable language_\">console</span>.<span class=\"title function_\">error</span>(<span class=\"string\">\"GPT Occurs Exception: \"</span> + oHttp.<span class=\"property\">responseText</span>);</span><br><span class=\"line\">            }</span><br><span class=\"line\">        }</span><br><span class=\"line\">    };</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = {</span><br><span class=\"line\">        <span class=\"attr\">model</span>: <span class=\"string\">\"gpt-3.5-turbo\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">messages</span>: [</span><br><span class=\"line\">            { <span class=\"attr\">role</span>: <span class=\"string\">\"system\"</span>, <span class=\"attr\">content</span>: <span class=\"string\">\"Translator\"</span> },</span><br><span class=\"line\">            { <span class=\"attr\">role</span>: <span class=\"string\">\"user\"</span>, <span class=\"attr\">content</span>: q },</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    };</span><br><span class=\"line\"></span><br><span class=\"line\">    oHttp.<span class=\"title function_\">send</span>(<span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(data));</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n","categories":["Javascript"],"tags":["Openai","ChatGPT","Javascript"]},{"title":"Github copilot","url":"/posts/582090662/","content":"<h2 id=\"簡介\"><a href=\"#簡介\" class=\"headerlink\" title=\"簡介\"></a>簡介</h2><ul>\n<li>基於 AI / LLM 技術的開發助手，用於改善開發者體驗 (DX)</li>\n<li> 核心技術來自於 OpenAI 的 GPT-3.5 Turbo 模型<ul>\n<li>該模型基於海量的自然語言文本資料集進行訓練，並具備一定的推理能力</li>\n</ul>\n</li>\n<li>明年初有機會到 GPT 4 (32K)</li>\n<li> 幾乎支援「任何」程式語言</li>\n<li>官方宣稱不會用客戶資料作為訓練模型<span id=\"more\"></span></li>\n</ul>\n<h3 id=\"用途\"><a href=\"#用途\" class=\"headerlink\" title=\"用途\"></a>用途</h3><ul>\n<li>重複 / 單調的開發</li>\n<li>回想語法</li>\n<li>保持心流</li>\n<li>確保程式一致性</li>\n<li>精準的判斷上下文，並自動完成程式碼</li>\n<li>有很複雜的快取機制，避免瘋狂 DDOS</li>\n<li> 沒有足夠的上下文，也可以透過「註解」提供更完整的上下文資訊</li>\n<li>可透過妥善命名的類別、方法、參數即可自動產生適合的程式碼</li>\n<li>擅長撰寫重複的程式碼，可幫助開發人員節省時間和精力，提高開發效率</li>\n<li>可自動建立與撰寫單元測試程式碼</li>\n<li>可促進程式碼的標準化和可讀性</li>\n<li>可以快速生成程式碼，節省開發人員的時間和精力</li>\n<li>可以在不熟悉的領域提高寫 Code 的自信度</li>\n<li>強調寫 Code 的「心流」模式不被破壞</li>\n</ul>\n<h3 id=\"上下文-Context-包含哪些\"><a href=\"#上下文-Context-包含哪些\" class=\"headerlink\" title=\"上下文 (Context) 包含哪些\"></a>上下文 (Context) 包含哪些</h3><p>GitHub Copilot 會依據「上下文」自動組成 GPT-3.5 Turbo 所需的提示</p>\n<ul>\n<li>目前正在編輯的程式</li>\n<li>目前鍵盤游標的前 / 後幾行</li>\n<li>還包含了所有已經開啟的程式碼檔案</li>\n<li>他會分析你的程式碼結構並取出重要的資訊</li>\n<li>註解、檔案名稱、類別名稱、函式名稱、參數名稱…</li>\n<li> 刪掉的字</li>\n</ul>\n<h4 id=\"CDD-Comment-Driven-Development\"><a href=\"#CDD-Comment-Driven-Development\" class=\"headerlink\" title=\"CDD (Comment Driven Development)\"></a>CDD (Comment Driven Development)</h4><p>註解導向的開發模式</p>\n<ul>\n<li>違反人性，通常都是直接寫 Code</li>\n<li> 太多註解很干擾</li>\n<li>錯誤的註解比 bug 還可怕</li>\n</ul>\n<h2 id=\"支援-IDE-設定\"><a href=\"#支援-IDE-設定\" class=\"headerlink\" title=\"支援 IDE/設定\"></a>支援 IDE / 設定</h2><p><img data-src=\"https://hackmd.io/_uploads/Skl4AsLUa.png\" alt=\"image\"></p>\n<h2 id=\"支援的程式語言\"><a href=\"#支援的程式語言\" class=\"headerlink\" title=\"支援的程式語言\"></a>支援的程式語言</h2><ul>\n<li>包含但不限於 Java、PHP、Python、JavaScript、Ruby、Go、C#、C++…<ul>\n<li> 目前 Github 上最多的語言是 js &gt; python</li>\n</ul>\n</li>\n<li> 只要是 GitHub 公開儲存庫找的到的 Code 它都看的懂！</li>\n<li>越少公開的程式語言範例，產生的程式碼就越爛！</li>\n</ul>\n<h2 id=\"版權\"><a href=\"#版權\" class=\"headerlink\" title=\"版權\"></a>版權</h2><p>可能存在版權和隱私問題</p>\n<ul>\n<li>若有比對到和 Github 上一致的 Code 的話，會有 Code Reference 提示</li>\n<li>發生機率 1%</li>\n</ul>\n<h2 id=\"費用\"><a href=\"#費用\" class=\"headerlink\" title=\"費用\"></a>費用</h2><ul>\n<li><p>個人版：</p>\n<p><img data-src=\"https://hackmd.io/_uploads/Hk9MMT8UT.png\" alt=\"image\"></p>\n</li>\n<li><p>商業 / 企業版：月繳 $19/$39 美元 / 使用者<br>(主要使用在組織帳戶中)</p>\n<p><img data-src=\"https://hackmd.io/_uploads/HydJfaLLp.png\" alt=\"image\"></p>\n</li>\n</ul>\n<h2 id=\"基本使用技巧\"><a href=\"#基本使用技巧\" class=\"headerlink\" title=\"基本使用技巧\"></a>基本使用技巧</h2><h2 id=\"Github-Copilot-Chat\"><a href=\"#Github-Copilot-Chat\" class=\"headerlink\" title=\"Github Copilot Chat\"></a>Github Copilot Chat</h2><ul>\n<li>一個以「對話」為基礎的工具</li>\n<li>對於對話內容有一定程度的短期記憶能力</li>\n<li>提問會跟當前游標所在程式碼自動關聯  </li>\n<li>提供各種強大的程式碼生成功能</li>\n</ul>\n<h2 id=\"指令\"><a href=\"#指令\" class=\"headerlink\" title=\"指令\"></a>指令</h2><h3 id=\"workspace-關於您當前工作區中的檔案或專案提出問題\"><a href=\"#workspace-關於您當前工作區中的檔案或專案提出問題\" class=\"headerlink\" title=\"@workspace 關於您當前工作區中的檔案或專案提出問題\"></a>@workspace 關於您當前工作區中的檔案或專案提出問題</h3><p><code>/fix</code>: Bug 修正<br><code>/explain</code>: 解釋 Code<br><code>/doc</code>: 產生文件<br><code>/tests</code>: 產生單元測試<br><code>/clear</code>: clear session<br><code>/terminal</code>: 用 cli 做事<br><code>/new</code>: 建立系統架構<br><code>/newNotebook</code>：建立新的 Jupyter 筆記本  </p>\n<h3 id=\"快捷鍵\"><a href=\"#快捷鍵\" class=\"headerlink\" title=\"快捷鍵\"></a>快捷鍵</h3><p>VsCode</p>\n<ul>\n<li>inline-chat: <code>ctrl + i</code></li>\n<li>new chat: <code>ctrl + shift + i</code></li>\n</ul>\n<h3 id=\"vscode-提問關於-VS-Code-的問題\"><a href=\"#vscode-提問關於-VS-Code-的問題\" class=\"headerlink\" title=\"@vscode 提問關於 VS Code 的問題\"></a>@vscode 提問關於 VS Code 的問題</h3><ul>\n<li>/api 請教有關 VS Code 擴充套件開發的問題</li>\n</ul>\n<h2 id=\"Github-Next\"><a href=\"#Github-Next\" class=\"headerlink\" title=\"Github Next\"></a>Github Next</h2><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWJuZXh0LmNvbS8=\">https://githubnext.com/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","categories":["Others"],"tags":["AI","Github Copilot"]},{"title":"Github Page Blog with Hexo","url":"/posts/534415561/","content":"<p>最近決定養成寫 Blog 的習慣，以隨手筆記技術文章，基於以下理由決定選用 Github Page + Hexo + NexT</p>\n<ol>\n<li>快速寫作 -&gt; Markdown</li>\n<li> 自主管理相關資源 -&gt; Git</li>\n<li> 免費 -&gt; Github Page</li>\n<li> 具搜尋功能，方便查找筆記 -&gt; Hexo</li>\n<li> 畫面簡單易讀 -&gt; Hexo + NexT (Theme)</li>\n</ol>\n<span id=\"more\"></span>\n\n<h2 id=\"Hexo\"><a href=\"#Hexo\" class=\"headerlink\" title=\"Hexo\"></a>Hexo</h2><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL3poLXR3Lw==\">Hexo<i class=\"fa fa-external-link-alt\"></i></span> 是一個靜態頁面生成框架，搭配 Github 的話也能在線上編輯</p>\n<h3 id=\"Hexo-cli\"><a href=\"#Hexo-cli\" class=\"headerlink\" title=\"Hexo-cli\"></a>Hexo-cli</h3><p>Require</p>\n<ul>\n<li>Node.js</li>\n<li>Hexo-cli</li>\n</ul>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">npm install -g hexo-cli</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"初始化\"><a href=\"#初始化\" class=\"headerlink\" title=\"初始化\"></a>初始化</h3><figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">hexo init &lt;folder&gt;</span><br><span class=\"line\"><span class=\"built_in\">cd</span> &lt;folder&gt;</span><br><span class=\"line\">npm i</span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"寫作\"><a href=\"#寫作\" class=\"headerlink\" title=\"寫作\"></a>寫作</h2><h3 id=\"新增文章\"><a href=\"#新增文章\" class=\"headerlink\" title=\"新增文章\"></a>新增文章</h3><figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"新增草稿\"><a href=\"#新增草稿\" class=\"headerlink\" title=\"新增草稿\"></a>新增草稿</h3><p>建立時會預設儲存於 source/_drafts 資料夾</p>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">hexo new draft &lt;title&gt;</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"發布草稿\"><a href=\"#發布草稿\" class=\"headerlink\" title=\"發布草稿\"></a>發布草稿</h3><figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">hexo publish &lt;title&gt;</span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"部署\"><a href=\"#部署\" class=\"headerlink\" title=\"部署\"></a>部署</h2><h3 id=\"產生靜態檔\"><a href=\"#產生靜態檔\" class=\"headerlink\" title=\"產生靜態檔\"></a>產生靜態檔</h3><p>產生靜態檔至 public 資料夾</p>\n<ul>\n<li>-w,–watch: 監看檔案變更</li>\n<li> -d,–deploy: 產生完成即部署網站 </li>\n</ul>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">hexo generate --watch</span><br><span class=\"line\">hexo g -w</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"清除靜態檔\"><a href=\"#清除靜態檔\" class=\"headerlink\" title=\"清除靜態檔\"></a>清除靜態檔</h3><p>清除 public 資料夾及相關部署檔</p>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"本機部署\"><a href=\"#本機部署\" class=\"headerlink\" title=\"本機部署\"></a>本機部署</h3><p>需安裝外掛 hexo-server</p>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">npm i hexo-server</span><br><span class=\"line\">hexo server</span><br><span class=\"line\">hexo s</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"手動部署\"><a href=\"#手動部署\" class=\"headerlink\" title=\"手動部署\"></a>手動部署</h3><p>需安裝外掛</p>\n<ul>\n<li>-g, –generate: 部署網站前先產生靜態檔案 </li>\n</ul>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">npm i hexo-deployer-git</span><br><span class=\"line\">hexo deploy --generate</span><br><span class=\"line\">hexo d -g</span><br></pre></td></tr></tbody></table></figure>\n\n<p>須於設定檔完成相關設定才有效</p>\n<blockquote>\n<p>參考： <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudA==\">https://hexo.io/docs/one-command-deployment<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n<figure class=\"highlight yml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">type:</span> <span class=\"string\">'git'</span></span><br><span class=\"line\">  <span class=\"attr\">repo:</span> <span class=\"string\">&lt;https://github.com/KuoAnn/kuoann.github.io.git&gt;</span></span><br><span class=\"line\">  <span class=\"attr\">branch:</span> <span class=\"string\">gh-pages</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"自動部署-Github-Action\"><a href=\"#自動部署-Github-Action\" class=\"headerlink\" title=\"自動部署 - Github Action\"></a>自動部署 - Github Action</h3><blockquote>\n<p>參考： <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL3poLXR3L2RvY3MvZ2l0aHViLXBhZ2Vz\">https://hexo.io/zh-tw/docs/github-pages<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n<ol>\n<li><p>儲存庫根目錄下建立 .github/workflows/pages.yml</p>\n</li>\n<li><p>貼上以下設定，須注意第 16 行的 node-version 需修改為本機 node.js 版本</p>\n <figure class=\"highlight yml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Pages</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span></span><br><span class=\"line\"><span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">branches:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">main</span>  <span class=\"comment\"># default branch</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\"><span class=\"attr\">pages:</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@v2</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Use</span> <span class=\"string\">Node.js</span> <span class=\"number\">16.</span><span class=\"string\">x</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/setup-node@v2</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">        <span class=\"attr\">node-version:</span> <span class=\"string\">'16'</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Cache</span> <span class=\"string\">NPM</span> <span class=\"string\">dependencies</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/cache@v2</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">        <span class=\"attr\">path:</span> <span class=\"string\">node_modules</span></span><br><span class=\"line\">        <span class=\"attr\">key:</span> <span class=\"string\">${{</span> <span class=\"string\">runner.OS</span> <span class=\"string\">}}-npm-cache</span></span><br><span class=\"line\">        <span class=\"attr\">restore-keys:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">            ${{ runner.OS }}-npm-cache</span></span><br><span class=\"line\"><span class=\"string\"></span>    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Install</span> <span class=\"string\">Dependencies</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">npm</span> <span class=\"string\">install</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Build</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">npm</span> <span class=\"string\">run</span> <span class=\"string\">build</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Deploy</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">peaceiris/actions-gh-pages@v3</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">        <span class=\"attr\">github_token:</span> <span class=\"string\">${{</span> <span class=\"string\">secrets.GITHUB_TOKEN</span> <span class=\"string\">}}</span></span><br><span class=\"line\">        <span class=\"attr\">publish_dir:</span> <span class=\"string\">./public</span></span><br></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>push pages.yml</p>\n</li>\n<li><p>在儲存庫中前往 <strong>Settings &gt; Pages &gt; Source</strong>，並將 branch 改為 <code>gh-pages</code></p>\n</li>\n<li><p>當 Github Action 偵測到 main branch 有新版本時會自動部署</p>\n<ul>\n<li>部署狀況可至 Action 頁籤觀察</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"設定\"><a href=\"#設定\" class=\"headerlink\" title=\"設定\"></a>設定</h2><blockquote>\n<p>請參考 <a href=\"/posts/587752702\">Hexo 推薦外掛及相關設定</a></p>\n</blockquote>\n","categories":["Others"],"tags":["Hexo","Hexo NexT","Github","Github Page","Github Action"]},{"title":"Hexo Theme - Next","url":"/posts/2185127750/","content":"<p>本站 Hexo 使用 <span class=\"exturl\" data-url=\"aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy8=\">NexT<i class=\"fa fa-external-link-alt\"></i></span> 主題，須注意 Github Repo 有新舊版之分，舊版已不再維護，為避免混亂以下僅提供新版連結</p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL25leHQtdGhlbWUvaGV4by10aGVtZS1uZXh0\">https://github.com/next-theme/hexo-theme-next<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n<h2 id=\"安裝\"><a href=\"#安裝\" class=\"headerlink\" title=\"安裝\"></a>安裝</h2><p>官方提供兩種安裝方式：</p>\n<ol>\n<li><p>npm 下載 (建議)</p>\n <figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">npm install hexo-theme-next</span><br></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>Git Clone</p>\n <figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/next-theme/hexo-theme-next themes/next</span><br></pre></td></tr></tbody></table></figure></li>\n</ol>\n<p>Hexo 的 <code>_config.yml</code> 須將 theme 切換至 <code>next</code></p>\n<figure class=\"highlight yml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">theme:</span> <span class=\"string\">next</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"NexT-設定\"><a href=\"#NexT-設定\" class=\"headerlink\" title=\"NexT 設定\"></a>NexT 設定</h2><p>詳細設定內容網路上滿多，以下僅提供需特別注意的部分</p>\n<ul>\n<li>若是用 git clone 的方式安裝，請盡量避免直接修改 themes 下的 <code>_config.yml</code>。</li>\n<li>Hexo 本身有提供覆寫方法，可於根目錄下建立 <code>_config.next.yml</code>，並將相關設定無腦複製進來再做修改。</li>\n</ul>\n<span id=\"more\"></span>\n\n<h2 id=\"NexT-標籤語法\"><a href=\"#NexT-標籤語法\" class=\"headerlink\" title=\"NexT 標籤語法\"></a>NexT 標籤語法</h2><h3 id=\"Note\"><a href=\"#Note\" class=\"headerlink\" title=\"Note\"></a>Note</h3><p>可直接用 Html 或是標籤撰寫文章</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"note default\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Html範例<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">{% note default %}標籤範例{% endnote %}</span><br><span class=\"line\">{% note primary %}標籤範例{% endnote %}</span><br><span class=\"line\">{% note success %}標籤範例{% endnote %}</span><br><span class=\"line\">{% note info %}標籤範例{% endnote %}</span><br><span class=\"line\">{% note warning %}標籤範例{% endnote %}</span><br><span class=\"line\">{% note danger %}標籤範例{% endnote %}</span><br></pre></td></tr></tbody></table></figure>\n\n<p>Sample:</p>\n<div class=\"note default\"><p>Html 範例</p></div>\n<div class=\"note default\"><p>標籤範例</p>\n</div>\n<div class=\"note primary\"><p>標籤範例</p>\n</div>\n<div class=\"note success\"><p>標籤範例</p>\n</div>\n<div class=\"note info\"><p>標籤範例</p>\n</div>\n<div class=\"note warning\"><p>標籤範例</p>\n</div>\n<div class=\"note danger\"><p>標籤範例</p>\n</div>\n\n<p>相關樣式可於 <code>_config.next.yml</code> 設定：</p>\n<figure class=\"highlight yaml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Note tag (bootstrap callout)</span></span><br><span class=\"line\"><span class=\"attr\">note:</span></span><br><span class=\"line\">  <span class=\"comment\"># Note tag style values:</span></span><br><span class=\"line\">  <span class=\"comment\">#  - simple    bootstrap callout old alert style. Default.</span></span><br><span class=\"line\">  <span class=\"comment\">#  - modern    bootstrap callout new (v2-v3) alert style.</span></span><br><span class=\"line\">  <span class=\"comment\">#  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span></span><br><span class=\"line\">  <span class=\"comment\">#  - disabled  disable all CSS styles import of note tag.</span></span><br><span class=\"line\">  <span class=\"attr\">style:</span> <span class=\"string\">modern</span></span><br><span class=\"line\">  <span class=\"attr\">icons:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\"># Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class=\"line\">  <span class=\"comment\"># Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class=\"line\">  <span class=\"attr\">light_bg_offset:</span> <span class=\"number\">0</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"Label\"><a href=\"#Label\" class=\"headerlink\" title=\"Label\"></a>Label</h3><figure class=\"highlight text\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">{% label default@default標籤 %}</span><br><span class=\"line\">{% label primary@primary標籤 %}</span><br><span class=\"line\">{% label success@success標籤 %}</span><br><span class=\"line\">{% label info@info標籤 %}</span><br><span class=\"line\">{% label warning@warning標籤 %}</span><br><span class=\"line\">{% label danger@danger標籤 %}</span><br></pre></td></tr></tbody></table></figure>\n\n<p>Sample:</p>\n<mark class=\"label default\">default 標籤</mark>\n<mark class=\"label primary\"> primary 標籤</mark>\n<mark class=\"label success\"> success 標籤</mark>\n<mark class=\"label info\"> info 標籤</mark>\n<mark class=\"label warning\"> warning 標籤</mark>\n<mark class=\"label danger\"> danger 標籤</mark>\n\n<h2 id=\"自訂樣式\"><a href=\"#自訂樣式\" class=\"headerlink\" title=\"自訂樣式\"></a>自訂樣式</h2><p>與設定檔一樣，不建議直接修改原始檔內容，可於 <code>_config.next.yml</code> 啟用自訂內容</p>\n<figure class=\"highlight yml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">custom_file_path:</span></span><br><span class=\"line\">  <span class=\"comment\">#head: source/_data/head.njk</span></span><br><span class=\"line\">  <span class=\"comment\">#header: source/_data/header.njk</span></span><br><span class=\"line\">  <span class=\"attr\">sidebar:</span> <span class=\"string\">source/_data/sidebar.njk</span></span><br><span class=\"line\">  <span class=\"comment\">#postMeta: source/_data/post-meta.njk</span></span><br><span class=\"line\">  <span class=\"comment\">#postBodyEnd: source/_data/post-body-end.njk</span></span><br><span class=\"line\">  <span class=\"comment\">#footer: source/_data/footer.njk</span></span><br><span class=\"line\">  <span class=\"comment\">#bodyEnd: source/_data/body-end.njk</span></span><br><span class=\"line\">  <span class=\"comment\">#variable: source/_data/variables.styl</span></span><br><span class=\"line\">  <span class=\"comment\">#mixin: source/_data/mixins.styl</span></span><br><span class=\"line\">  <span class=\"attr\">style:</span> <span class=\"string\">source/_data/styles.styl</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p><code>styles.styl</code>：本站有特別調整的樣式內容如下</p>\n<figure class=\"highlight css\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">$heavy-bluegreen = <span class=\"selector-id\">#005757</span>;</span><br><span class=\"line\">$bg-green = <span class=\"selector-id\">#D1E9E9</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">body</span> {</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: $bg-green;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.posts-expand</span> <span class=\"selector-class\">.post-title</span>, <span class=\"selector-class\">.posts-expand</span> <span class=\"selector-class\">.post-title-link</span> {</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: $heavy-bluegreen;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.exturl</span> {</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#3D7878</span>;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\">// 短 <span class=\"selector-tag\">Code</span> 樣式</span><br><span class=\"line\"><span class=\"selector-tag\">code</span> {</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#c7254e</span>; //文字顏色</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#f9f2f4</span>; //底色</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">2px</span>;</span><br><span class=\"line\">}</span><br><span class=\"line\"><span class=\"selector-class\">.highlight</span>, pre {</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">5px</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">4px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">3px</span>;</span><br><span class=\"line\">}</span><br><span class=\"line\"><span class=\"selector-class\">.highlight</span>, <span class=\"selector-tag\">code</span>, pre {</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#d6d6d6</span>;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\">// 修改選中文字底色</span><br><span class=\"line\"><span class=\"comment\">/* webkit, opera, IE9 */</span></span><br><span class=\"line\"><span class=\"selector-pseudo\">::selection</span> { </span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#408080</span>;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#f7f7f7</span>;</span><br><span class=\"line\">}</span><br><span class=\"line\"><span class=\"comment\">/* firefox */</span></span><br><span class=\"line\">::-moz-selection {</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#408080</span>;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#f7f7f7</span>;</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n","categories":["Others"],"tags":["Hexo","Hexo NexT"]},{"title":"Hexo 推薦外掛及相關設定","url":"/posts/587752702/","content":"<h2 id=\"推薦外掛\"><a href=\"#推薦外掛\" class=\"headerlink\" title=\"推薦外掛\"></a>推薦外掛</h2><ol>\n<li><strong>hexo-abbrlink</strong>: 產生永久連結 for SEO，建立文章時會產生隨機編號的 url，以避免更換文章結構 (/2022/10/5/xxx) 時連結失效，同時也能避開中文的 urlencoding 讓連結更簡短些</li>\n<li><strong> hexo-filter-nofollow</strong>: 避免爬蟲爬到外部連結會回不來 for SEO</li>\n<li><strong>hexo-generator-sitemap</strong>: 產生 sitemap.xml for SEO</li>\n<li><strong>hexo-generator-searchdb</strong>: 搜尋功能</li>\n<li><strong> hexo-generator-feed</strong>: 產生 RSS</li>\n</ol>\n<p>相關設定可參考最下方的 <a href=\"#%E5%A4%96%E6%8E%9B%E8%A8%AD%E5%AE%9A\">外掛設定</a></p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL3BsdWdpbnMv\">Plugins<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n<h2 id=\"Hexo-設定\"><a href=\"#Hexo-設定\" class=\"headerlink\" title=\"Hexo 設定\"></a>Hexo 設定</h2><p>直接參考以下設定檔 <code>_config.yml</code> 註解</p>\n<blockquote>\n<p>Hexo version: 6.3.0<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL3poLXR3L2RvY3Mv\">官方設定說明<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n<span id=\"more\"></span>\n<h3 id=\"站台設定\"><a href=\"#站台設定\" class=\"headerlink\" title=\"站台設定\"></a>站台設定</h3><ol>\n<li>permalink: SEO 用，避免 URL 太長或中文被 encode，需安裝 <code>hexo-abbrlink</code><ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL3poLWNuL2RvY3MvcGVybWFsaW5rcy5odG1s\">permalink 官方說明<i class=\"fa fa-external-link-alt\"></i></span></li>\n</ul>\n</li>\n</ol>\n<figure class=\"highlight yml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Site</span></span><br><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">KuoAnn's</span> <span class=\"string\">Gate</span></span><br><span class=\"line\"><span class=\"attr\">subtitle:</span> <span class=\"string\">'郭安的真理之門'</span></span><br><span class=\"line\"><span class=\"attr\">description:</span> <span class=\"string\">這裡是郭安的筆記碎片&lt;br&gt;因為是碎片所以看不懂很正常</span></span><br><span class=\"line\"><span class=\"attr\">keywords:</span> <span class=\"string\">'KuoAnn,github page'</span></span><br><span class=\"line\"><span class=\"attr\">author:</span> <span class=\"string\">KuoAnn</span></span><br><span class=\"line\"><span class=\"attr\">language:</span> <span class=\"string\">'zh-TW'</span></span><br><span class=\"line\"><span class=\"attr\">timezone:</span> <span class=\"string\">'Asia/Taipei'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># URL</span></span><br><span class=\"line\"><span class=\"attr\">url:</span> <span class=\"string\">https://kuoann.github.io/</span></span><br><span class=\"line\"><span class=\"attr\">permalink:</span> <span class=\"string\">posts/:abbrlink/</span></span><br><span class=\"line\"><span class=\"attr\">permalink_defaults:</span></span><br><span class=\"line\"><span class=\"attr\">pretty_urls:</span></span><br><span class=\"line\">  <span class=\"attr\">trailing_index:</span> <span class=\"literal\">true</span> <span class=\"comment\"># Set to false to remove trailing 'index.html' from permalinks</span></span><br><span class=\"line\">  <span class=\"attr\">trailing_html:</span> <span class=\"literal\">true</span> <span class=\"comment\"># Set to false to remove trailing '.html' from permalinks</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Directory &gt; 預設產檔的資料夾</span></span><br><span class=\"line\"><span class=\"attr\">source_dir:</span> <span class=\"string\">source</span></span><br><span class=\"line\"><span class=\"attr\">public_dir:</span> <span class=\"string\">public</span></span><br><span class=\"line\"><span class=\"attr\">tag_dir:</span> <span class=\"string\">tags</span></span><br><span class=\"line\"><span class=\"attr\">archive_dir:</span> <span class=\"string\">archives</span></span><br><span class=\"line\"><span class=\"attr\">category_dir:</span> <span class=\"string\">categories</span></span><br><span class=\"line\"><span class=\"attr\">code_dir:</span> <span class=\"string\">downloads/code</span></span><br><span class=\"line\"><span class=\"attr\">i18n_dir:</span> <span class=\"string\">:lang</span></span><br><span class=\"line\"><span class=\"attr\">skip_render:</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"寫作設定\"><a href=\"#寫作設定\" class=\"headerlink\" title=\"寫作設定\"></a>寫作設定</h3><ol>\n<li>external_link: 啟用以新分頁開啟外部連結</li>\n<li> post_asset_folder: 啟用後，在建立檔案時，Hexo 會自動建立一個與文章同名的資料夾，可用來放置文章相關資源<ul>\n<li> marked/prependRoot + postAsset: 啟用後可直接用 Markdown 抓到對應資料夾的資源<ul>\n<li> Ex. <code>![](image.jpg)</code> -&gt; <code>&lt;img src=\"/2020/01/02/foo/image.jpg\"&gt;</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>highlight: 預設使用 highlight.js 設定；highlight/prismjs 只能擇一啟用 </li>\n</ol>\n<figure class=\"highlight yml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">new_post_name:</span> <span class=\"string\">:title.md</span> <span class=\"comment\"># File name of new posts</span></span><br><span class=\"line\"><span class=\"attr\">default_layout:</span> <span class=\"string\">post</span></span><br><span class=\"line\"><span class=\"attr\">titlecase:</span> <span class=\"literal\">false</span> <span class=\"comment\"># Transform title into titlecase</span></span><br><span class=\"line\"><span class=\"attr\">external_link:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span> <span class=\"comment\"># Open external links in new tab</span></span><br><span class=\"line\">  <span class=\"attr\">field:</span> <span class=\"string\">site</span> <span class=\"comment\"># Apply to the whole site</span></span><br><span class=\"line\">  <span class=\"attr\">exclude:</span> <span class=\"string\">''</span></span><br><span class=\"line\"><span class=\"attr\">filename_case:</span> <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"attr\">render_drafts:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">post_asset_folder:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">marked:</span></span><br><span class=\"line\">  <span class=\"attr\">prependRoot:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">postAsset:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">relative_link:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">future:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">highlight:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">line_number:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">auto_detect:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">  <span class=\"attr\">tab_replace:</span> <span class=\"string\">''</span></span><br><span class=\"line\">  <span class=\"attr\">wrap:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">hljs:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">prismjs:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">  <span class=\"attr\">preprocess:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">line_number:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">  <span class=\"attr\">tab_replace:</span> <span class=\"string\">''</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"顯示設定\"><a href=\"#顯示設定\" class=\"headerlink\" title=\"顯示設定\"></a>顯示設定</h3><figure class=\"highlight yml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 首頁顯示</span></span><br><span class=\"line\"><span class=\"attr\">index_generator:</span></span><br><span class=\"line\">  <span class=\"attr\">path:</span> <span class=\"string\">''</span></span><br><span class=\"line\">  <span class=\"attr\">per_page:</span> <span class=\"number\">10</span></span><br><span class=\"line\">  <span class=\"comment\"># 依日期反序</span></span><br><span class=\"line\">  <span class=\"attr\">order_by:</span> <span class=\"string\">-date</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Category &amp; Tag</span></span><br><span class=\"line\"><span class=\"attr\">default_category:</span> <span class=\"string\">uncategorized</span></span><br><span class=\"line\"><span class=\"attr\">category_map:</span></span><br><span class=\"line\"><span class=\"attr\">tag_map:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Metadata elements</span></span><br><span class=\"line\"><span class=\"comment\">## https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta</span></span><br><span class=\"line\"><span class=\"attr\">meta_generator:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Date / Time format</span></span><br><span class=\"line\"><span class=\"comment\">## Hexo uses Moment.js to parse and display date</span></span><br><span class=\"line\"><span class=\"comment\">## You can customize the date format as defined in</span></span><br><span class=\"line\"><span class=\"comment\">## http://momentjs.com/docs/#/displaying/format/</span></span><br><span class=\"line\"><span class=\"attr\">date_format:</span> <span class=\"string\">YYYY-MM-DD</span></span><br><span class=\"line\"><span class=\"attr\">time_format:</span> <span class=\"string\">HH:mm:ss</span></span><br><span class=\"line\"><span class=\"comment\">## updated_option supports 'mtime', 'date', 'empty'</span></span><br><span class=\"line\"><span class=\"attr\">updated_option:</span> <span class=\"string\">'mtime'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Pagination</span></span><br><span class=\"line\"><span class=\"comment\">## Set per_page to 0 to disable pagination</span></span><br><span class=\"line\"><span class=\"attr\">per_page:</span> <span class=\"number\">10</span></span><br><span class=\"line\"><span class=\"attr\">pagination_dir:</span> <span class=\"string\">page</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Include / Exclude file(s)</span></span><br><span class=\"line\"><span class=\"comment\">## include:/exclude: options only apply to the 'source/' folder</span></span><br><span class=\"line\"><span class=\"attr\">include:</span> []</span><br><span class=\"line\"><span class=\"attr\">exclude:</span> []</span><br><span class=\"line\"><span class=\"attr\">ignore:</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"外掛設定\"><a href=\"#外掛設定\" class=\"headerlink\" title=\"外掛設定\"></a>外掛設定</h2><figure class=\"highlight yml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># hexo-abbrlink</span></span><br><span class=\"line\"><span class=\"attr\">abbrlink:</span></span><br><span class=\"line\">  <span class=\"attr\">alg:</span> <span class=\"string\">crc32</span>  <span class=\"comment\"># 演算法：crc16(default) and crc32 </span></span><br><span class=\"line\">  <span class=\"attr\">rep:</span> <span class=\"string\">dec</span>    <span class=\"comment\"># 進位制：dec(default) and hex</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># hexo-filter-nofollow</span></span><br><span class=\"line\"><span class=\"attr\">nofollow:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">field:</span> <span class=\"string\">site</span></span><br><span class=\"line\">  <span class=\"attr\">exclude:</span>  <span class=\"comment\"># 不加上 nofollow 的友情連結可以放在這邊。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># hexo-generator-sitemap</span></span><br><span class=\"line\"><span class=\"attr\">sitemap:</span></span><br><span class=\"line\">  <span class=\"attr\">path:</span> <span class=\"string\">sitemap.xml</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># hexo-generator-feed</span></span><br><span class=\"line\"><span class=\"attr\">feed:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">type:</span> <span class=\"string\">atom</span></span><br><span class=\"line\">  <span class=\"attr\">path:</span> <span class=\"string\">atom.xml</span></span><br><span class=\"line\">  <span class=\"attr\">limit:</span> <span class=\"number\">20</span></span><br><span class=\"line\">  <span class=\"attr\">hub:</span></span><br><span class=\"line\">  <span class=\"attr\">content:</span></span><br><span class=\"line\">  <span class=\"attr\">content_limit:</span> <span class=\"number\">140</span></span><br><span class=\"line\">  <span class=\"attr\">content_limit_delim:</span> <span class=\"string\">' '</span></span><br><span class=\"line\">  <span class=\"attr\">order_by:</span> <span class=\"string\">-date</span></span><br><span class=\"line\">  <span class=\"attr\">icon:</span> <span class=\"string\">icon.png</span></span><br><span class=\"line\">  <span class=\"attr\">autodiscovery:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">template:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># hexo-generator-searchdb</span></span><br><span class=\"line\"><span class=\"attr\">search:</span></span><br><span class=\"line\">  <span class=\"attr\">path:</span> <span class=\"string\">search.json</span></span><br><span class=\"line\">  <span class=\"attr\">field:</span> <span class=\"string\">post</span></span><br><span class=\"line\">  <span class=\"attr\">format:</span> <span class=\"string\">html</span></span><br><span class=\"line\">  <span class=\"attr\">limit:</span> <span class=\"number\">10000</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"主題設定\"><a href=\"#主題設定\" class=\"headerlink\" title=\"主題設定\"></a>主題設定</h3><p>本站使用 <span class=\"exturl\" data-url=\"aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy8=\">NexT<i class=\"fa fa-external-link-alt\"></i></span>，細節設定可參考下一篇</p>\n<figure class=\"highlight yml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">theme:</span> <span class=\"string\">next</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"手動佈署設定\"><a href=\"#手動佈署設定\" class=\"headerlink\" title=\"手動佈署設定\"></a>手動佈署設定</h3><figure class=\"highlight yml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Deployment</span></span><br><span class=\"line\"><span class=\"comment\">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">type:</span> <span class=\"string\">'git'</span></span><br><span class=\"line\">  <span class=\"attr\">repo:</span> <span class=\"string\">https://github.com/KuoAnn/kuoann.github.io.git</span></span><br><span class=\"line\">  <span class=\"attr\">branch:</span> <span class=\"string\">gh-pages</span></span><br></pre></td></tr></tbody></table></figure>\n","categories":["Others"],"tags":["Hexo","Hexo NexT"]},{"title":"Html to PDF with wkhtmltopdf.netcore","url":"/posts/4215572637/","content":"<p>某次接到的需求需實現以下功能，特此紀錄一下</p>\n<ol>\n<li>透過網頁傳入 html 字串並下載成 PDF 檔</li>\n<li>資料不落地，全程用 Stream 處理<ul>\n<li>因具多台 AP Server，若產生實體檔案會需要多生一台代理伺服器</li>\n</ul>\n</li>\n<li> Header 動態浮水印，需加入圖片及建立日期</li>\n<li>密碼保護</li>\n</ol>\n<p>原本預計採用常見的 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubnVnZXQub3JnL3BhY2thZ2VzP3E9aVRleHRTaGFycA==\">iTextSharp<i class=\"fa fa-external-link-alt\"></i></span> 處理，但後來發現有中文亂碼的問題且轉換的相容性不太好，故決定改用 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubnVnZXQub3JnL3BhY2thZ2VzL1draHRtbHRvcGRmLk5ldENvcmUvNS4wLjItcHJldmlldw==\">wkhtmltopdf.netcore<i class=\"fa fa-external-link-alt\"></i></span>，結果又發現該套件 (此時是 v5.0.2 Preview 版) 不支援加密功能，最終決定兩者混用</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Install\"><a href=\"#Install\" class=\"headerlink\" title=\"Install\"></a>Install</h2><p>從 Github 或 Nuget 皆可下載，執行檔須依預設目錄結構存放並將屬性設為 <code>Copy Always</code></p>\n<figure class=\"highlight text\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">├── Example</span><br><span class=\"line\">|   ├── Example.csproj</span><br><span class=\"line\">|   └── Rotativa</span><br><span class=\"line\">|   |   ├── Linux</span><br><span class=\"line\">|   |   |   └── wkhtmltopdf</span><br><span class=\"line\">|   |   ├── Mac</span><br><span class=\"line\">|   |   |   └── wkhtmltopdf</span><br><span class=\"line\">|   |   └── Windows</span><br><span class=\"line\">|   |       └── wkhtmltopdf.exe</span><br><span class=\"line\">└── Example.sln</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"Github\"><a href=\"#Github\" class=\"headerlink\" title=\"Github\"></a>Github</h3><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2ZwYW5hY2NpYS9Xa2h0bWx0b3BkZi5OZXRDb3Jl\">https://github.com/fpanaccia/Wkhtmltopdf.NetCore<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h3 id=\"Nuget\"><a href=\"#Nuget\" class=\"headerlink\" title=\"Nuget\"></a>Nuget</h3><ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubnVnZXQub3JnL3BhY2thZ2VzL1draHRtbHRvcGRmLk5ldENvcmUvNS4wLjItcHJldmlldw==\">wkhtmltopdf.netcore<i class=\"fa fa-external-link-alt\"></i></span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubnVnZXQub3JnL3BhY2thZ2VzP3E9aVRleHRTaGFycA==\">iTextSharp<i class=\"fa fa-external-link-alt\"></i></span></li>\n</ul>\n<h2 id=\"Client-Side\"><a href=\"#Client-Side\" class=\"headerlink\" title=\"Client-Side\"></a>Client-Side</h2><ul>\n<li><p>Html</p>\n  <figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"btn download-pdf\"</span> <span class=\"attr\">role</span>=<span class=\"string\">\"button\"</span>&gt;</span>PDF下載<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>jQuery</p>\n  <figure class=\"highlight js\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">$(<span class=\"string\">\"a.btn.download-pdf\"</span>).<span class=\"title function_\">click</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) {</span><br><span class=\"line\">    <span class=\"comment\">// html 轉 Base64</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title class_\">PdfHtmlContent</span> = <span class=\"title function_\">btoa</span>(<span class=\"built_in\">encodeURIComponent</span>($(<span class=\"string\">\".form\"</span>).<span class=\"title function_\">html</span>().<span class=\"title function_\">trim</span>().<span class=\"title function_\">replaceAll</span>(<span class=\"string\">\"\\n\"</span>, <span class=\"string\">\"\"</span>)));</span><br><span class=\"line\"></span><br><span class=\"line\">    $.<span class=\"title function_\">ajax</span>({</span><br><span class=\"line\">        <span class=\"attr\">url</span>: <span class=\"string\">'/dl/f/pdf'</span>,</span><br><span class=\"line\">        <span class=\"attr\">method</span>: <span class=\"string\">'POST'</span>,</span><br><span class=\"line\">        <span class=\"attr\">cache</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"attr\">data</span>: <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>({ <span class=\"title class_\">PdfHtmlContent</span> }),</span><br><span class=\"line\">        <span class=\"attr\">contentType</span>: <span class=\"string\">\"application/json\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">xhrFields</span>: {</span><br><span class=\"line\">            <span class=\"attr\">responseType</span>: <span class=\"string\">\"blob\"</span></span><br><span class=\"line\">        },</span><br><span class=\"line\">        <span class=\"attr\">success</span>: <span class=\"keyword\">function</span> (<span class=\"params\">response</span>) {</span><br><span class=\"line\">            <span class=\"keyword\">const</span> $a = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">\"a\"</span>)</span><br><span class=\"line\">            <span class=\"keyword\">const</span> url = <span class=\"variable constant_\">URL</span>.<span class=\"title function_\">createObjectURL</span>(response)</span><br><span class=\"line\">            $a.<span class=\"property\">download</span> = <span class=\"string\">\"檔案名稱.pdf\"</span></span><br><span class=\"line\">            $a.<span class=\"property\">href</span> = url</span><br><span class=\"line\">            $a.<span class=\"title function_\">click</span>()</span><br><span class=\"line\">            <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> <span class=\"variable constant_\">URL</span>.<span class=\"title function_\">revokeObjectURL</span>(url), <span class=\"number\">5000</span>)</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }).<span class=\"title function_\">fail</span>(<span class=\"keyword\">function</span> (<span class=\"params\">xhr, textStatus</span>) {</span><br><span class=\"line\">        <span class=\"title function_\">alert</span>(<span class=\"string\">\"下載失敗：\"</span> + textStatus);</span><br><span class=\"line\">    });</span><br><span class=\"line\">});</span><br></pre></td></tr></tbody></table></figure></li>\n</ul>\n<h2 id=\"Server-Side\"><a href=\"#Server-Side\" class=\"headerlink\" title=\"Server-Side\"></a>Server-Side</h2><ul>\n<li><p>Startup.cs</p>\n  <figure class=\"highlight csharp\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"comment\">// 註冊 wkhtmltopdf.netcore</span></span></span><br><span class=\"line\"><span class=\"function\">    services.<span class=\"title\">AddWkhtmltopdf</span>()</span>;</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>Controller</p>\n  <figure class=\"highlight csharp\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Route(<span class=\"string\">\"dl\"</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">ApiController</span>]</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">DownloadFileController</span> : <span class=\"title\">ControllerBase</span></span><br><span class=\"line\">{</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IGeneratePdf _generatePdf;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IConfiguration _configuration;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IWebHostEnvironment _webHostEnvironment;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> ILogger&lt;DownloadFileController&gt; _logger;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">DownloadFileController</span>(<span class=\"params\">IGeneratePdf generatePdf,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">        IConfiguration configuration,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">        IWebHostEnvironment webHostEnvironment,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">        ILogger&lt;DownloadFileController&gt; logger</span>)</span></span><br><span class=\"line\">    {</span><br><span class=\"line\">        _generatePdf = generatePdf;</span><br><span class=\"line\">        _configuration = configuration;</span><br><span class=\"line\">        _webHostEnvironment = webHostEnvironment;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>._logger = logger;</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">    [<span class=\"meta\">HttpPost</span>]</span><br><span class=\"line\">    [<span class=\"meta\">Route(<span class=\"string\">\"f/pdf\"</span>)</span>]</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;IActionResult&gt; <span class=\"title\">GetPdf</span>(<span class=\"params\">[FromBody] PdfModel model</span>)</span></span><br><span class=\"line\">    {</span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = <span class=\"keyword\">new</span> JObject();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span></span><br><span class=\"line\">        {</span><br><span class=\"line\">            <span class=\"keyword\">var</span> password = <span class=\"string\">\"abcd1234\"</span>;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> rootPath = _webHostEnvironment.ContentRootPath;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> base64EncodedBytes = Convert.FromBase64String(model.PdfHtmlContent);</span><br><span class=\"line\">            <span class=\"keyword\">var</span> htmlString = HttpUtility.UrlDecode(Encoding.UTF8.GetString(base64EncodedBytes));</span><br><span class=\"line\">            <span class=\"keyword\">var</span> pdfModel = <span class=\"keyword\">new</span> PdfModel()</span><br><span class=\"line\">            {</span><br><span class=\"line\">                RootPath = rootPath,</span><br><span class=\"line\">                PdfHtmlContent = htmlString,</span><br><span class=\"line\">            };</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 浮水印參數</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> headerMap = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">string</span>&gt;</span><br><span class=\"line\">            {</span><br><span class=\"line\">                { <span class=\"string\">\"year\"</span>, DateTime.Now.AddYears(<span class=\"number\">-1911</span>).ToString(<span class=\"string\">\"yyy\"</span>) },</span><br><span class=\"line\">                { <span class=\"string\">\"month\"</span>, DateTime.Now.AddYears(<span class=\"number\">-1911</span>).ToString(<span class=\"string\">\"MM\"</span>) },</span><br><span class=\"line\">                { <span class=\"string\">\"day\"</span>, DateTime.Now.AddYears(<span class=\"number\">-1911</span>).ToString(<span class=\"string\">\"dd\"</span>) },</span><br><span class=\"line\">                { <span class=\"string\">\"hour\"</span>, DateTime.Now.AddYears(<span class=\"number\">-1911</span>).ToString(<span class=\"string\">\"HH\"</span>) },</span><br><span class=\"line\">                { <span class=\"string\">\"minute\"</span>, DateTime.Now.AddYears(<span class=\"number\">-1911</span>).ToString(<span class=\"string\">\"mm\"</span>) },</span><br><span class=\"line\">            };</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// PDF 參數</span></span><br><span class=\"line\">            _generatePdf.SetConvertOptions(<span class=\"keyword\">new</span> ConvertOptions</span><br><span class=\"line\">            {</span><br><span class=\"line\">                PageMargins = <span class=\"keyword\">new</span> Wkhtmltopdf.NetCore.Options.Margins() { Top = <span class=\"number\">20</span>, Bottom = <span class=\"number\">0</span>, Left = <span class=\"number\">0</span>, Right = <span class=\"number\">0</span> },</span><br><span class=\"line\">                HeaderHtml = Path.Combine(rootPath, <span class=\"string\">\"wwwroot\"</span>, <span class=\"string\">\"html\"</span>, <span class=\"string\">\"pdf-header.html\"</span>),</span><br><span class=\"line\">                Replacements = headerMap,</span><br><span class=\"line\">            });</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// wkhtmltopdf 產生 PDF byte 資料</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> pdfByte = <span class=\"keyword\">await</span> _generatePdf.GetByteArray(<span class=\"string\">\"Pages/Template/Pdf.cshtml\"</span>, pdfModel);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// iTextSharp 讀取 byte 資料後處理加密</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> reader = <span class=\"keyword\">new</span> PdfReader(pdfByte);</span><br><span class=\"line\">            <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> ms = <span class=\"keyword\">new</span> MemoryStream())</span><br><span class=\"line\">            {</span><br><span class=\"line\">                PdfEncryptor.Encrypt(reader, ms, <span class=\"literal\">true</span>, password, password, PdfWriter.ALLOW_PRINTING);</span><br><span class=\"line\">                pdfByte = ms.ToArray();</span><br><span class=\"line\">            }</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 輸出成資料流</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> output = <span class=\"keyword\">new</span> MemoryStream();</span><br><span class=\"line\">            output.Write(pdfByte, <span class=\"number\">0</span>, pdfByte.Length);</span><br><span class=\"line\">            output.Position = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 這邊的檔名沒那麼重要，最終會由前端決定實際檔名</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> File(output, <span class=\"string\">\"application/pdf\"</span>, <span class=\"string\">\"myfile.pdf\"</span>);</span><br><span class=\"line\">        }</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">        {</span><br><span class=\"line\">            <span class=\"keyword\">return</span> StatusCode(StatusCodes.Status500InternalServerError, <span class=\"keyword\">new</span></span><br><span class=\"line\">            {</span><br><span class=\"line\">                rtnCode = <span class=\"string\">\"-9999\"</span>,</span><br><span class=\"line\">                errMsg = ex.Message</span><br><span class=\"line\">            });</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>PdfModel.cs</p>\n  <figure class=\"highlight csharp\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">PdfModel</span></span><br><span class=\"line\">{</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"built_in\">string</span> RootPath { <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>; }</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"built_in\">string</span> PdfHtmlContent { <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>; }</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure></li>\n</ul>\n<h3 id=\"Template\"><a href=\"#Template\" class=\"headerlink\" title=\"Template\"></a>Template</h3><ul>\n<li><p>Pdf 樣板: <code>Pdf.cshtml</code></p>\n  <figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">@model Model.PdfModel</span><br><span class=\"line\">@{</span><br><span class=\"line\">    Layout = null;</span><br><span class=\"line\">}</span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>PDF<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1, shrink-to-fit=no, minimum-scale=1.0, maximum-scale=1.0\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- Bootstrap core CSS --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"@(Model.RootPath + \"</span>/<span class=\"attr\">wwwroot</span>/<span class=\"attr\">vendors</span>/<span class=\"attr\">bootstrap</span>/<span class=\"attr\">bootstrap.min.css</span>\")\" /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"@(Model.RootPath + \"</span>/<span class=\"attr\">wwwroot</span>/<span class=\"attr\">vendors</span>/<span class=\"attr\">iconfonts</span>/<span class=\"attr\">style.css</span>\")\" /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"@(Model.RootPath + \"</span>/<span class=\"attr\">wwwroot</span>/<span class=\"attr\">vendors</span>/<span class=\"attr\">color</span>/<span class=\"attr\">color.css</span>\")\" /&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- Custom styles for website --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"@(Model.RootPath + \"</span>/<span class=\"attr\">wwwroot</span>/<span class=\"attr\">css</span>/<span class=\"attr\">fonts.css</span>\")\" /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"@(Model.RootPath + \"</span>/<span class=\"attr\">wwwroot</span>/<span class=\"attr\">css</span>/<span class=\"attr\">main.css</span>\")\" /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"@(Model.RootPath + \"</span>/<span class=\"attr\">wwwroot</span>/<span class=\"attr\">css</span>/<span class=\"attr\">style.css</span>\")\" /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"container-fluid project_bg px-0\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"padding-top: 20px;padding-bottom: 20px;\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"row mt-2 mx-auto\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"max-width: 1100px;\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"col-md-8 col-11 mx-auto\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">id</span>=<span class=\"string\">\"msform\"</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">fieldset</span> <span class=\"attr\">class</span>=<span class=\"string\">\"row\"</span>&gt;</span></span><br><span class=\"line\">                        @Html.Raw(Model.PdfHtmlContent)</span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>Header 浮水印樣板: <code>pdf-header.html</code></p>\n  <figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">function</span> <span class=\"title function_\">replaceParams</span>(<span class=\"params\"></span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">var</span> url = <span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">href</span>.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/#$/</span>, <span class=\"string\">\"\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">var</span> params = (url.<span class=\"title function_\">split</span>(<span class=\"string\">\"?\"</span>)[<span class=\"number\">1</span>] || <span class=\"string\">\"\"</span>).<span class=\"title function_\">split</span>(<span class=\"string\">\"&amp;\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; params.<span class=\"property\">length</span>; i++) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">var</span> param = params[i].<span class=\"title function_\">split</span>(<span class=\"string\">\"=\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">var</span> key = param[<span class=\"number\">0</span>];</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">var</span> value = param[<span class=\"number\">1</span>] || <span class=\"string\">''</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">if</span> (key == <span class=\"string\">\"hour\"</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">try</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"keyword\">var</span> realHour = <span class=\"built_in\">parseInt</span>(value);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"keyword\">var</span> ampmText = <span class=\"string\">\"上午\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"keyword\">if</span> (realHour &gt;= <span class=\"number\">12</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            ampmText = <span class=\"string\">\"下午\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            <span class=\"keyword\">if</span> (realHour &gt; <span class=\"number\">12</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                                value = realHour - <span class=\"number\">12</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        }</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">\"self-report-date\"</span>).<span class=\"property\">innerText</span> =</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">\"self-report-date\"</span>).<span class=\"property\">innerText</span>.<span class=\"title function_\">replace</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(<span class=\"string\">'{ampm}'</span>, <span class=\"string\">'g'</span>), ampmText);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    } <span class=\"keyword\">catch</span> (e) { }</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">finally</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">\"self-report-date\"</span>).<span class=\"property\">innerText</span> =</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">\"self-report-date\"</span>).<span class=\"property\">innerText</span>.<span class=\"title function_\">replace</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(<span class=\"string\">'{hour}'</span>, <span class=\"string\">'g'</span>), value);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">                    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">                }</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">else</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">\"self-report-date\"</span>).<span class=\"property\">innerText</span> =</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">\"self-report-date\"</span>).<span class=\"property\">innerText</span>.<span class=\"title function_\">replace</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(<span class=\"string\">'{'</span> + key + <span class=\"string\">'}'</span>, <span class=\"string\">'g'</span>), value);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                }</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">        }</span></span><br><span class=\"line\"><span class=\"language-javascript\">    </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span> <span class=\"attr\">style</span>=<span class=\"string\">\"margin: 0;\"</span> <span class=\"attr\">onload</span>=<span class=\"string\">\"replaceParams()\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"width: 420px; margin: 0 auto; overflow: hidden;\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"width: 80px; float: left;\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"../images/pdf-header-icon.png\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"display: block; width: 100%;\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"float: left; width: 310px; padding: 16px 0px 0px 6px; font-family: 'Microsoft JhengHei'; font-weight: bolder;\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"self-report-date\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"padding-bottom: 4px;color:red\"</span>&gt;</span>下載日期{year}年{month}月{day}日{ampm}{hour}:{minute}<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>\n</ul>\n","categories":["C#"],"tags":["C#","ASP.NET Core","PDF"]},{"title":".NET Core 自動更新版號","url":"/posts/19958632/","content":"<p>以下是 C# 專案建置時自動更新版本號的設定範例</p>\n<ul>\n<li>利用專案檔的 <code>&lt;VersionSuffix&gt;</code> 指定時間格式</li>\n<li> Ex. 建置時間：<code>2022/10/16 15:07</code> -&gt; 版號：<code>1.22.1016.1507</code></li>\n<li>可使用 <code>Condition</code> 屬性增加其他判斷</li>\n</ul>\n<span id=\"more\"></span>\n\n<h2 id=\"csproj\"><a href=\"#csproj\" class=\"headerlink\" title=\".csproj\"></a>.csproj</h2><figure class=\"highlight xml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">PropertyGroup</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">VersionSuffix</span>&gt;</span>1.$([System.DateTime]::Now.ToString(yy)).$([System.DateTime]::Now.ToString(MMdd)).$([System.DateTime]::Now.ToString(HHmm))<span class=\"tag\">&lt;/<span class=\"name\">VersionSuffix</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">AssemblyVersion</span> <span class=\"attr\">Condition</span>=<span class=\"string\">\" '$(VersionSuffix)' == '' \"</span>&gt;</span>9.9.9.9<span class=\"tag\">&lt;/<span class=\"name\">AssemblyVersion</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">AssemblyVersion</span> <span class=\"attr\">Condition</span>=<span class=\"string\">\" '$(VersionSuffix)' != '' \"</span>&gt;</span>$(VersionSuffix)<span class=\"tag\">&lt;/<span class=\"name\">AssemblyVersion</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">Version</span> <span class=\"attr\">Condition</span>=<span class=\"string\">\" '$(VersionSuffix)' == '' \"</span>&gt;</span>9.9.9.9<span class=\"tag\">&lt;/<span class=\"name\">Version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">Version</span> <span class=\"attr\">Condition</span>=<span class=\"string\">\" '$(VersionSuffix)' != '' \"</span>&gt;</span>$(VersionSuffix)<span class=\"tag\">&lt;/<span class=\"name\">Version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">PropertyGroup</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"取得版本號\"><a href=\"#取得版本號\" class=\"headerlink\" title=\"取得版本號\"></a>取得版本號</h2><figure class=\"highlight csharp\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> assemblyVersion = Assembly.GetEntryAssembly()?.GetName().Version;</span><br><span class=\"line\"><span class=\"keyword\">var</span> fileVersion = Assembly.GetEntryAssembly()?.GetCustomAttribute&lt;AssemblyFileVersionAttribute&gt;().Version;</span><br><span class=\"line\"><span class=\"keyword\">var</span> informationVersion = Assembly.GetEntryAssembly()?.GetCustomAttribute&lt;AssemblyInformationalVersionAttribute&gt;().InformationalVersion;</span><br></pre></td></tr></tbody></table></figure>\n","categories":["C#"],"tags":["C#","ASP.NET Core",".csproj"]},{"title":"NPOI 自適應欄寬","url":"/posts/1661076175/","content":"<figure class=\"highlight csharp\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> 自動適應列寬</span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"sheet\"&gt;</span>需要自適應列寬的sheet表<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"columnCount\"&gt;</span>起始列數<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">AutoFitColumnWidth</span>(<span class=\"params\">ISheet sheet, <span class=\"built_in\">int</span> columnCount, <span class=\"built_in\">int</span> startRowIndex = <span class=\"number\">0</span></span>)</span></span><br><span class=\"line\">{</span><br><span class=\"line\">    <span class=\"comment\">//列寬自適應，只對英文和數字有效</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> ci = <span class=\"number\">0</span>; ci &lt; columnCount; ci++)</span><br><span class=\"line\">    {</span><br><span class=\"line\">        sheet.AutoSizeColumn(ci);</span><br><span class=\"line\">    }</span><br><span class=\"line\">    <span class=\"comment\">//獲取當前列的寬度，然後對比本列的長度，取最大值</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> colIndex = <span class=\"number\">0</span>; colIndex &lt; columnCount; colIndex++)</span><br><span class=\"line\">    {</span><br><span class=\"line\">        <span class=\"built_in\">int</span> columnWidth = sheet.GetColumnWidth(colIndex) / <span class=\"number\">256</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> rowNum = startRowIndex; rowNum &lt; sheet.LastRowNum; rowNum++)</span><br><span class=\"line\">        {</span><br><span class=\"line\">            IRow currentRow;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//當前行未被使用過</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (sheet.GetRow(rowNum) == <span class=\"literal\">null</span>)</span><br><span class=\"line\">            {</span><br><span class=\"line\">                currentRow = sheet.CreateRow(rowNum);</span><br><span class=\"line\">            }</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            {</span><br><span class=\"line\">                currentRow = sheet.GetRow(rowNum);</span><br><span class=\"line\">            }</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (currentRow.GetCell(colIndex) != <span class=\"literal\">null</span>)</span><br><span class=\"line\">            {</span><br><span class=\"line\">                ICell currentCell = currentRow.GetCell(colIndex);</span><br><span class=\"line\">                <span class=\"built_in\">int</span> length = Encoding.Default.GetBytes(currentCell.ToString()).Length;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (columnWidth &lt; length)</span><br><span class=\"line\">                {</span><br><span class=\"line\">                    columnWidth = length;</span><br><span class=\"line\">                }</span><br><span class=\"line\">            }</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (columnWidth &gt; <span class=\"number\">255</span>)</span><br><span class=\"line\">            {</span><br><span class=\"line\">                columnWidth = <span class=\"number\">255</span>;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            }</span><br><span class=\"line\">        }</span><br><span class=\"line\"></span><br><span class=\"line\">        sheet.SetColumnWidth(colIndex, columnWidth * <span class=\"number\">256</span>);</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>","categories":["C#"],"tags":["C#"]},{"title":"Puppeteer Sharp - Chrome snapshot","url":"/posts/1250676027/","content":"<p>Chrome 自 59 版起內建了 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIuY2hyb21lLmNvbS9ibG9nL2hlYWRsZXNzLWNocm9tZS8=\">Headless<i class=\"fa fa-external-link-alt\"></i></span> 模式，允許透過命令列啟動 Chrome 以無 GUI 方式執行，藉此可透過 C# 套件快速實作開啟網頁並擷圖等功能</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Puppeteer-Sharp-套件\"><a href=\"#Puppeteer-Sharp-套件\" class=\"headerlink\" title=\"Puppeteer Sharp 套件\"></a>Puppeteer Sharp 套件</h2><p>可透過 Nuget 下載 Puppeteer Sharp 套件，不需在伺服器安裝 Chrome，它會自行下載 Chromium</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- .csproj --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ItemGroup</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">PackageReference</span> <span class=\"attr\">Include</span>=<span class=\"string\">\"PuppeteerSharp\"</span> <span class=\"attr\">Version</span>=<span class=\"string\">\"9.0.2\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ItemGroup</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"Main-Method\"><a href=\"#Main-Method\" class=\"headerlink\" title=\"Main Method\"></a>Main Method</h2><figure class=\"highlight csharp\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System.Text.RegularExpressions;</span><br><span class=\"line\"><span class=\"keyword\">using</span> PuppeteerSharp;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Job</span></span><br><span class=\"line\">{</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"built_in\">string</span> Title;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"built_in\">string</span> Url;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"built_in\">bool</span> Pass;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"built_in\">string</span> Message;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Chrome</span> : <span class=\"title\">IDisposable</span></span><br><span class=\"line\">{</span><br><span class=\"line\">    <span class=\"keyword\">private</span> IBrowser browser;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> IPage page;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"built_in\">int</span> width, height;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Chrome</span>(<span class=\"params\"><span class=\"built_in\">int</span> width = <span class=\"number\">1024</span>, <span class=\"built_in\">int</span> height = <span class=\"number\">768</span></span>)</span></span><br><span class=\"line\">    {</span><br><span class=\"line\">        <span class=\"keyword\">var</span> path = Microsoft.Win32.Registry.GetValue(<span class=\"string\">@\"HKEY_CLASSES_ROOT\\ChromeHTML\\shell\\open\\command\"</span>, <span class=\"literal\">null</span>, <span class=\"literal\">null</span>) <span class=\"keyword\">as</span> <span class=\"built_in\">string</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">string</span>.IsNullOrEmpty(path))</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationException(<span class=\"string\">\"Chrome not installed\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">var</span> m = Regex.Match(path, <span class=\"string\">\"\\\"(?&lt;p&gt;.+?)\\\"\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!m.Success)</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationException(<span class=\"string\">$\"Invalid Chrome path - <span class=\"subst\">{path}</span>\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">var</span> chromePath = m.Groups[<span class=\"string\">\"p\"</span>].Value;</span><br><span class=\"line\">        browser = Puppeteer.LaunchAsync(<span class=\"keyword\">new</span> LaunchOptions</span><br><span class=\"line\">        {</span><br><span class=\"line\">            Headless = <span class=\"literal\">false</span>,</span><br><span class=\"line\">            ExecutablePath = chromePath</span><br><span class=\"line\">        }).Result;</span><br><span class=\"line\">        page = browser.PagesAsync().Result.First();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.width = width;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.height = height;</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Navigate</span>(<span class=\"params\">Job job</span>)</span></span><br><span class=\"line\">    {</span><br><span class=\"line\">        <span class=\"keyword\">try</span></span><br><span class=\"line\">        {</span><br><span class=\"line\">            page.SetViewportAsync(<span class=\"keyword\">new</span> ViewPortOptions</span><br><span class=\"line\">            {</span><br><span class=\"line\">                Width = width,</span><br><span class=\"line\">                Height = height</span><br><span class=\"line\">            }).Wait();</span><br><span class=\"line\">            <span class=\"keyword\">var</span> response = page.GoToAsync(job.Url, <span class=\"number\">30000</span>,</span><br><span class=\"line\">                waitUntil: <span class=\"keyword\">new</span> WaitUntilNavigation[] {</span><br><span class=\"line\">                            WaitUntilNavigation.Load,</span><br><span class=\"line\">                            WaitUntilNavigation.Networkidle2</span><br><span class=\"line\">                }).GetAwaiter().GetResult();</span><br><span class=\"line\">            job.Pass = response.Status == System.Net.HttpStatusCode.OK;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!job.Pass)</span><br><span class=\"line\">            {</span><br><span class=\"line\">                job.Message = <span class=\"string\">$\"** <span class=\"subst\">{response.StatusText}</span> **\\n<span class=\"subst\">{response.TextAsync().Result}</span>\"</span>;</span><br><span class=\"line\">            }</span><br><span class=\"line\">        }</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">        {</span><br><span class=\"line\">            job.Pass = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            job.Message = ex.Message;</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TakeSnapshot</span>(<span class=\"params\"><span class=\"built_in\">string</span> path</span>)</span></span><br><span class=\"line\">    {</span><br><span class=\"line\">        <span class=\"keyword\">var</span> h = Convert.ToInt32((<span class=\"built_in\">float</span>)page.EvaluateExpressionAsync(</span><br><span class=\"line\">            <span class=\"string\">@\"Math.max(document.body.scrollHeight, document.documentElement.scrollHeight)\"</span>).Result);</span><br><span class=\"line\">        <span class=\"keyword\">var</span> w = Convert.ToInt32((<span class=\"built_in\">float</span>)page.EvaluateExpressionAsync(</span><br><span class=\"line\">            <span class=\"string\">@\"document.body.getBoundingClientRect().width\"</span>).Result);</span><br><span class=\"line\">        page.SetViewportAsync(<span class=\"keyword\">new</span> ViewPortOptions</span><br><span class=\"line\">        {</span><br><span class=\"line\">            Width = w,</span><br><span class=\"line\">            Height = h</span><br><span class=\"line\">        }).Wait();</span><br><span class=\"line\">        page.ScreenshotAsync(path).GetAwaiter().GetResult();</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Dispose</span>()</span></span><br><span class=\"line\">    {</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (page != <span class=\"literal\">null</span>) page.Dispose();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (browser != <span class=\"literal\">null</span>) browser.Dispose();</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"Using\"><a href=\"#Using\" class=\"headerlink\" title=\"Using\"></a>Using</h2><figure class=\"highlight csharp\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> browser = <span class=\"keyword\">new</span> Chrome(<span class=\"number\">1500</span>, <span class=\"number\">300</span>))</span><br><span class=\"line\">{</span><br><span class=\"line\">    <span class=\"keyword\">var</span> job = <span class=\"keyword\">new</span> Job</span><br><span class=\"line\">    {</span><br><span class=\"line\">        Title = <span class=\"string\">\"Google\"</span>,</span><br><span class=\"line\">        Url = <span class=\"string\">\"https://www.google.com/\"</span></span><br><span class=\"line\">    };</span><br><span class=\"line\">    browser.Navigate(job);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (job.Pass)</span><br><span class=\"line\">    {</span><br><span class=\"line\">        <span class=\"keyword\">var</span> imgDirectory = Path.Combine(Directory.GetCurrentDirectory(), <span class=\"string\">\"Exports\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">var</span> imgPath = Path.Combine(imgDirectory, job.Title + <span class=\"string\">\".png\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!Directory.Exists(imgDirectory))</span><br><span class=\"line\">        {</span><br><span class=\"line\">            Directory.CreateDirectory(imgDirectory);</span><br><span class=\"line\">        }</span><br><span class=\"line\">        browser.TakeSnapshot(imgPath);</span><br><span class=\"line\">    }</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    {</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"參考資料\"><a href=\"#參考資料\" class=\"headerlink\" title=\"參考資料\"></a>參考資料</h2><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmRhcmt0aHJlYWQubmV0L2Jsb2cvcHVwcGV0ZWVyLXNoYXJwLw==\">https://blog.darkthread.net/blog/puppeteer-sharp/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","categories":["C#"],"tags":["C#","Chrome Headless","Puppeteer Sharp"]},{"title":"Vue3 筆記","url":"/posts/1306031307/","content":"<p>以前寫的 Vue2 都忘得差不多了，藉著最近接到 Vue3 專案的機會，重新學習一下</p>\n<p>Vue3 推薦結合以下套件使用，透過官方推薦的初始化指令 <code>npm init vue@latest</code> 可自動建立一個基礎的 Vue 專案</p>\n<ul>\n<li>Vite: 建置工具</li>\n<li> Pinia: 狀態管理</li>\n</ul>\n<h2 id=\"Import\"><a href=\"#Import\" class=\"headerlink\" title=\"Import\"></a>Import</h2><p>CDN：</p>\n<figure class=\"highlight js\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\">&lt;script src=<span class=\"string\">\"https://unpkg.com/vue@next\"</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>\n\n<span id=\"more\"></span>\n\n<h2 id=\"Virtual-DOM\"><a href=\"#Virtual-DOM\" class=\"headerlink\" title=\"Virtual DOM\"></a>Virtual DOM</h2><p>Vue 並非直接對頁面進行渲染，其會先於背景的 Virtual DOM 運算，當確定整個頁面結構後，再一次性地將結果繪製到頁面中，以此提升效能</p>\n<p><img data-src=\"https://i.imgur.com/BFCmFYv.png\" alt=\"Virtual DOM\"></p>\n<h2 id=\"reactive-資料連動\"><a href=\"#reactive-資料連動\" class=\"headerlink\" title=\"reactive(): 資料連動\"></a>reactive (): 資料連動</h2><p>基本單向的資料連動</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1.0\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://unpkg.com/vue@next\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Type: {{ framework.type }}<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Framework: {{ framework.name }}<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> { reactive } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"title function_\">setup</span>(<span class=\"params\"></span>){</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">const</span> framework = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"attr\">type</span>: <span class=\"string\">\"Frontend\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"attr\">name</span>: <span class=\"string\">\"Vue\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            })</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">return</span> { framework }</span></span><br><span class=\"line\"><span class=\"language-javascript\">        }</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>也可以先新增好物件再掛載</p>\n<figure class=\"highlight js\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> framework = {</span><br><span class=\"line\">    <span class=\"title function_\">data</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">        <span class=\"keyword\">return</span> {</span><br><span class=\"line\">            <span class=\"attr\">type</span>: <span class=\"string\">'Frontend'</span>,</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">'Vue'</span>,</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(framework).<span class=\"title function_\">mount</span>(<span class=\"string\">'#app'</span>);</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"v-model\"><a href=\"#v-model\" class=\"headerlink\" title=\"v-model\"></a>v-model</h3><p>在 v-model 中能加入一些修飾符來加強運用，可以使用的修飾符如下：</p>\n<p>v-model.lazy: 在文字方塊 onChange 時才會觸發更新。<br>v-model.number: 將輸入值轉換為數值格式。<br>v-model.trim: 去除欄位中的前後空白字元。</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"framework.type\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Frontend\"</span>&gt;</span>Frontend<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Backend\"</span>&gt;</span>Backend<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"framework.name\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Vue\"</span>&gt;</span>Vue<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"React\"</span>&gt;</span>React<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Angular\"</span>&gt;</span>Angular<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Laravel\"</span>&gt;</span>Laravel<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"CakePHP\"</span>&gt;</span>CakePHP<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Django\"</span>&gt;</span>Django<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Type: {{ framework.type }}<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Framework: {{ framework.name }}<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> { reactive } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"title function_\">setup</span>(<span class=\"params\"></span>){</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> framework = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">type</span>: <span class=\"string\">\"Frontend\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">name</span>: <span class=\"string\">\"Vue\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">return</span> {framework};</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">}</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"v-for\"><a href=\"#v-for\" class=\"headerlink\" title=\"v-for\"></a>v-for</h3><figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">v-for</span>=<span class=\"string\">\"(value, name, index) in state.frameworks\"</span>&gt;</span></span><br><span class=\"line\">            {{ index + 1 }}. {{ name }} - {{ value }}</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> { reactive } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"title function_\">setup</span>(<span class=\"params\"></span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> state = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">frameworks</span>: {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"title class_\">Vue</span>: <span class=\"string\">\"Frontend\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"title class_\">React</span>: <span class=\"string\">\"Frontend\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"title class_\">Angular</span>: <span class=\"string\">\"Frontend\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"title class_\">Laravel</span>: <span class=\"string\">\"Backend\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"title class_\">CakePHP</span>: <span class=\"string\">\"Backend\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"title class_\">Django</span>: <span class=\"string\">\"Backend\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            },</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">return</span> { state };</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">}</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"v-bind\"><a href=\"#v-bind\" class=\"headerlink\" title=\"v-bind\"></a>v-bind</h3><p>v-bind 是在 HTML 屬性中，如果需要用到 vue data 時使用</p>\n<ul>\n<li>:value = 修飾符寫法</li>\n<li>:key = 綁定標題 / 內容，要注意給的 key 值是不能有重複的，否則頁面會發生錯誤 </li>\n</ul>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.type\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">v-for</span>=<span class=\"string\">\"item in state.types\"</span> <span class=\"attr\">v-bind:value</span>=<span class=\"string\">\"item.value\"</span>&gt;</span>{{ item.title }}<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.name\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">v-for</span>=<span class=\"string\">\"item in state.names\"</span> <span class=\"attr\">:key</span>=<span class=\"string\">\"item.title\"</span> <span class=\"attr\">:value</span>=<span class=\"string\">\"item.value\"</span>&gt;</span>{{ item.title }}<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Type: {{ state.type }}<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Framework: {{ state.name }}<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> { reactive } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"title function_\">setup</span>(<span class=\"params\"></span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> state = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">type</span>: <span class=\"string\">\"Frontend\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">name</span>: <span class=\"string\">\"Vue\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">names</span>:[</span></span><br><span class=\"line\"><span class=\"language-javascript\">                {<span class=\"attr\">title</span>: <span class=\"string\">\"Vue\"</span>, <span class=\"attr\">value</span>: <span class=\"string\">\"Vue\"</span>},</span></span><br><span class=\"line\"><span class=\"language-javascript\">                {<span class=\"attr\">title</span>: <span class=\"string\">\"React\"</span>, <span class=\"attr\">value</span>: <span class=\"string\">\"React\"</span>},</span></span><br><span class=\"line\"><span class=\"language-javascript\">                {<span class=\"attr\">title</span>: <span class=\"string\">\"Angular\"</span>, <span class=\"attr\">value</span>: <span class=\"string\">\"Angular\"</span>},</span></span><br><span class=\"line\"><span class=\"language-javascript\">                {<span class=\"attr\">title</span>: <span class=\"string\">\"Laravel\"</span>, <span class=\"attr\">value</span>: <span class=\"string\">\"Laravel\"</span>},</span></span><br><span class=\"line\"><span class=\"language-javascript\">                {<span class=\"attr\">title</span>: <span class=\"string\">\"CakePHP\"</span>, <span class=\"attr\">value</span>: <span class=\"string\">\"CakePHP\"</span>},</span></span><br><span class=\"line\"><span class=\"language-javascript\">                {<span class=\"attr\">title</span>: <span class=\"string\">\"Django\"</span>, <span class=\"attr\">value</span>: <span class=\"string\">\"Django\"</span>},</span></span><br><span class=\"line\"><span class=\"language-javascript\">            ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">types</span>:[</span></span><br><span class=\"line\"><span class=\"language-javascript\">                {<span class=\"attr\">title</span>: <span class=\"string\">\"Frontend\"</span>, <span class=\"attr\">value</span>: <span class=\"string\">\"Frontend\"</span>},</span></span><br><span class=\"line\"><span class=\"language-javascript\">                {<span class=\"attr\">title</span>: <span class=\"string\">\"Backend\"</span>, <span class=\"attr\">value</span>: <span class=\"string\">\"Backend\"</span>},</span></span><br><span class=\"line\"><span class=\"language-javascript\">            ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">return</span> { state };</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">}</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"Event\"><a href=\"#Event\" class=\"headerlink\" title=\"Event\"></a>Event</h2><figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">v-on:change</span>=<span class=\"string\">\"changeValue($event, 'type')\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Frontend\"</span>&gt;</span>Frontend<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Backend\"</span>&gt;</span>Backend<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">v-on:change</span>=<span class=\"string\">\"changeValue($event, 'name')\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Vue\"</span>&gt;</span>Vue<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"React\"</span>&gt;</span>React<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Angular\"</span>&gt;</span>Angular<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Type: {{ framework.type }}<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Framework: {{ framework.name }}<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> { reactive } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"title function_\">setup</span>(<span class=\"params\"></span>){</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">const</span> framework = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"attr\">type</span>: <span class=\"string\">\"Frontend\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"attr\">name</span>: <span class=\"string\">\"Vue\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            })</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">function</span> <span class=\"title function_\">changeValue</span>(<span class=\"params\">evt, id</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                framework[id] = evt.<span class=\"property\">currentTarget</span>.<span class=\"property\">value</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">return</span> {framework, changeValue};</span></span><br><span class=\"line\"><span class=\"language-javascript\">        }</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>v-on 可以用 @ 縮寫如下：</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> @<span class=\"attr\">change</span>=<span class=\"string\">\"changeValue($event, 'type')\"</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"事件修飾符\"><a href=\"#事件修飾符\" class=\"headerlink\" title=\"事件修飾符\"></a>事件修飾符</h3><ul>\n<li>@click.prevent: preventDefault</li>\n<li>@click.stop: 阻止事件向上傳遞</li>\n<li> @click.capture: 先將本身觸發的函數先執行完畢後再下傳事件的效果。 Ex. 使用此語法後執行順序 = navFn &gt; submitFn</li>\n<li>@click.self: 只在被點擊對象是自己的時候執行</li>\n<li> @click.once: 僅第一次按下時觸發動作</li>\n</ul>\n<h3 id=\"按鍵修飾符\"><a href=\"#按鍵修飾符\" class=\"headerlink\" title=\"按鍵修飾符\"></a>按鍵修飾符</h3><ul>\n<li>@keydown.prevent：會擋住在表單範圍內按下 Enter 鍵之後，自動送出表單的功能</li>\n<li> @keydown.ctrl.enter=”enterFn”：使用者在此 input 中按下 Ctrl + Enter 時會觸發 enterFn</li>\n<li>@click.prevent.alt.exact=”clickFn”：使用者在需要按下鍵盤上的 Alt + 滑鼠左鍵點擊按鈕才會觸發 ClickFn，若將其中 exact 的部分拿掉，則按下鍵盤 Alt + Shift + 左鍵，也會觸發該函數。</li>\n</ul>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"header\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"nav\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">form</span> @<span class=\"attr\">keydown.prevent</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> @<span class=\"attr\">keydown.ctrl.enter</span>=<span class=\"string\">\"enterFn\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click.prevent.alt.exact</span>=<span class=\"string\">\"clickFn\"</span>&gt;</span>檢查<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> @<span class=\"attr\">click.prevent.stop</span>=<span class=\"string\">\"submitFn\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Submit\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> @<span class=\"attr\">click.prevent.once</span>=<span class=\"string\">\"submitFn\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Submit Once\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> @<span class=\"attr\">click.stop</span>=<span class=\"string\">\"clearFn\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Clear\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">v-html</span>=<span class=\"string\">\"state.action\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> { reactive } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"title function_\">setup</span>(<span class=\"params\"></span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">const</span> state = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"attr\">action</span>: <span class=\"string\">\"\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            });</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">function</span> <span class=\"title function_\">submitFn</span>(<span class=\"params\"></span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">action</span> += <span class=\"string\">\"表單送出&lt;br&gt;\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">function</span> <span class=\"title function_\">navFn</span>(<span class=\"params\"></span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">action</span> += <span class=\"string\">\"選單點選&lt;br&gt;\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">function</span> <span class=\"title function_\">clearFn</span>(<span class=\"params\"></span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">action</span> = <span class=\"string\">\"\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">function</span> <span class=\"title function_\">enterFn</span>(<span class=\"params\"></span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">action</span> += <span class=\"string\">\"enterFn()&lt;br&gt;\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">function</span> <span class=\"title function_\">clickFn</span>(<span class=\"params\"></span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">action</span> += <span class=\"string\">\"clickFn()&lt;br&gt;\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">return</span> { state, submitFn, navFn, clearFn, enterFn, clickFn };</span></span><br><span class=\"line\"><span class=\"language-javascript\">        }</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"computed-計算屬性\"><a href=\"#computed-計算屬性\" class=\"headerlink\" title=\"computed(): 計算屬性\"></a>computed (): 計算屬性</h2><p>Function 寫法：</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.number1\"</span>&gt;</span> + </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.number2\"</span>&gt;</span> = {{ result() }}</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> { reactive } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"title function_\">setup</span>(<span class=\"params\"></span>){</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> state = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">number1</span>: <span class=\"number\">0</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">number2</span>: <span class=\"number\">0</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">function</span> <span class=\"title function_\">result</span>(<span class=\"params\"></span>){</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">if</span>(<span class=\"built_in\">isNaN</span>(state.<span class=\"property\">number1</span>) || <span class=\"built_in\">isNaN</span>(state.<span class=\"property\">number2</span>)){</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span> <span class=\"string\">\"Error!! Please enter the number.\"</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            }<span class=\"keyword\">else</span>{</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span> <span class=\"built_in\">parseFloat</span>(state.<span class=\"property\">number1</span>) + <span class=\"built_in\">parseFloat</span>(state.<span class=\"property\">number2</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">        }</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">return</span> { state, result };</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">}</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>Computed 寫法：僅針對參考資料異動時才會觸發運算 &gt; 效能較佳</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.number1\"</span>&gt;</span> +</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.number2\"</span>&gt;</span> = {{ result }}</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> { reactive, computed } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"title function_\">setup</span>(<span class=\"params\"></span>){</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> state = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">number1</span>: <span class=\"number\">0</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">number2</span>: <span class=\"number\">0</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> result = <span class=\"title function_\">computed</span>(<span class=\"function\">() =&gt;</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">if</span>(<span class=\"built_in\">isNaN</span>(state.<span class=\"property\">number1</span>) || <span class=\"built_in\">isNaN</span>(state.<span class=\"property\">number2</span>)){</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span> <span class=\"string\">\"Error!! Please enter the number.\"</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            }<span class=\"keyword\">else</span>{</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span> <span class=\"built_in\">parseFloat</span>(state.<span class=\"property\">number1</span>) + <span class=\"built_in\">parseFloat</span>(state.<span class=\"property\">number2</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">return</span> { state, result };</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">}</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"Setter\"><a href=\"#Setter\" class=\"headerlink\" title=\"Setter\"></a>Setter</h3><p>預設 Computed 為 read-only，若直接修改結果 Console 會跳出警告：<code>Write operation failed: computed value is readonly</code></p>\n<p>解法：</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Height:<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.height\"</span>&gt;</span>CM<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Weight:<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.weight\"</span>&gt;</span>KG<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>BMI:<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"bmi\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Suggestion:{{ bmiMessage }}<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> { reactive, computed } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"title function_\">setup</span>(<span class=\"params\"></span>){</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> state = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">height</span>: <span class=\"number\">180</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">weight</span>: <span class=\"number\">80</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> bmi = <span class=\"title function_\">computed</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">get</span>:<span class=\"function\">() =&gt;</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span> (state.<span class=\"property\">weight</span> / (<span class=\"title class_\">Math</span>.<span class=\"title function_\">pow</span>((state.<span class=\"property\">height</span> / <span class=\"number\">100</span>), <span class=\"number\">2</span>))).<span class=\"title function_\">toFixed</span>(<span class=\"number\">2</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            },</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">set</span>:<span class=\"function\">(<span class=\"params\">val</span>) =&gt;</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">\"Run Setter\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">weight</span> = ((<span class=\"title class_\">Math</span>.<span class=\"title function_\">pow</span>((state.<span class=\"property\">height</span> / <span class=\"number\">100</span>), <span class=\"number\">2</span>)) * val).<span class=\"title function_\">toFixed</span>(<span class=\"number\">2</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> bmiMessage = <span class=\"title function_\">computed</span>(<span class=\"function\">() =&gt;</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">\"Run BMI Message Computed\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">if</span> (bmi.<span class=\"property\">value</span> &gt; <span class=\"number\">35</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span> <span class=\"string\">\"重度肥胖\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (bmi.<span class=\"property\">value</span> &gt;= <span class=\"number\">30</span> &amp;&amp; bmi.<span class=\"property\">value</span> &lt; <span class=\"number\">35</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span> <span class=\"string\">\"中度肥胖\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (bmi.<span class=\"property\">value</span> &gt;= <span class=\"number\">27</span> &amp;&amp; bmi.<span class=\"property\">value</span> &lt; <span class=\"number\">30</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span> <span class=\"string\">\"輕度肥胖\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (bmi.<span class=\"property\">value</span> &gt;= <span class=\"number\">24</span> &amp;&amp; bmi.<span class=\"property\">value</span> &lt; <span class=\"number\">27</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span> <span class=\"string\">\"過重\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (bmi.<span class=\"property\">value</span> &gt;= <span class=\"number\">18.5</span> &amp;&amp; bmi.<span class=\"property\">value</span> &lt; <span class=\"number\">24</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span> <span class=\"string\">\"正常範圍\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">else</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">return</span> <span class=\"string\">\"體重過輕\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">return</span> { state, bmi, bmiMessage };</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">}</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"Watch-監聽器\"><a href=\"#Watch-監聽器\" class=\"headerlink\" title=\"Watch(): 監聽器\"></a>Watch (): 監聽器</h2><p>Watch 主要是去監聽在 Vue 裡面的數據，若數據發生變化的時候，會自動去執行相對應的動作</p>\n<p>Computed 範例改寫：</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Height:<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.height\"</span>&gt;</span>CM<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Weight:<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.weight\"</span>&gt;</span>KG<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>BMI: {{ state.bmi }}<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Suggestion:{{ state.bmiMessage }}<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> { reactive, watch } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"title function_\">setup</span>(<span class=\"params\"></span>){</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> state = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">height</span>: <span class=\"number\">180</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">weight</span>: <span class=\"number\">80</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">bmi</span>: <span class=\"number\">24.69</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">bmiMessage</span>: <span class=\"string\">\"過重\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"title function_\">watch</span>(<span class=\"function\">() =&gt;</span> [state.<span class=\"property\">height</span>, state.<span class=\"property\">weight</span>], <span class=\"function\">() =&gt;</span>{</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"title function_\">generateBMI</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">function</span> <span class=\"title function_\">generateBMI</span>(<span class=\"params\"></span>){</span></span><br><span class=\"line\"><span class=\"language-javascript\">            state.<span class=\"property\">bmi</span> = (state.<span class=\"property\">weight</span> / (<span class=\"title class_\">Math</span>.<span class=\"title function_\">pow</span>((state.<span class=\"property\">height</span> / <span class=\"number\">100</span>), <span class=\"number\">2</span>))).<span class=\"title function_\">toFixed</span>(<span class=\"number\">2</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">if</span> (state.<span class=\"property\">bmi</span> &gt; <span class=\"number\">35</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">bmiMessage</span> = <span class=\"string\">\"重度肥胖\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (state.<span class=\"property\">bmi</span> &gt;= <span class=\"number\">30</span> &amp;&amp; state.<span class=\"property\">bmi</span> &lt; <span class=\"number\">35</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">bmiMessage</span> = <span class=\"string\">\"中度肥胖\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (state.<span class=\"property\">bmi</span> &gt;= <span class=\"number\">27</span> &amp;&amp; state.<span class=\"property\">bmi</span> &lt; <span class=\"number\">30</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">bmiMessage</span> = <span class=\"string\">\"輕度肥胖\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (state.<span class=\"property\">bmi</span> &gt;= <span class=\"number\">24</span> &amp;&amp; state.<span class=\"property\">bmi</span> &lt; <span class=\"number\">27</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">bmiMessage</span> = <span class=\"string\">\"過重\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (state.<span class=\"property\">bmi</span> &gt;= <span class=\"number\">18.5</span> &amp;&amp; state.<span class=\"property\">bmi</span> &lt; <span class=\"number\">24</span>) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">bmiMessage</span> = <span class=\"string\">\"正常範圍\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">else</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">bmiMessage</span> = <span class=\"string\">\"體重過輕\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">        }</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">return</span> { state };</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">}</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></tbody></table></figure>\n\n<p>使用情境：</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>用戶姓名：</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.username\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"請輸入5~15個小寫英文，符號僅能使用@-_\"</span> <span class=\"attr\">size</span>=<span class=\"string\">\"50\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"errorMessage\"</span>&gt;</span>{{ state.usernameMsg }}<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> { reactive, watch } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"title function_\">setup</span>(<span class=\"params\"></span>){</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> state = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">username</span>: <span class=\"string\">\"\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">usernameMsg</span>: <span class=\"string\">\"\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"title function_\">watch</span>(<span class=\"function\">() =&gt;</span> state.<span class=\"property\">username</span>, <span class=\"function\">(<span class=\"params\">value</span>) =&gt;</span>{</span></span><br><span class=\"line\"><span class=\"language-javascript\">            state.<span class=\"property\">username</span> = state.<span class=\"property\">username</span>.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/[^a-zA-Z0-9_@-]/g</span>, <span class=\"string\">\"\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">const</span> usernameReg = <span class=\"regexp\">/^.{5,15}$/</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">if</span> (usernameReg.<span class=\"title function_\">test</span>(value)) {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">usernameMsg</span> = <span class=\"string\">\"\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            } <span class=\"keyword\">else</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                state.<span class=\"property\">usernameMsg</span> = <span class=\"string\">\"請輸入5~15個字以上\"</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            }</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">return</span> { state };</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">}</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>Replace 那一行一定會有問題，因為他是要將值回寫到 username 中，而 Computed 還需要透過 Setter 來做那相對來說就麻煩很多，那 Function 呢？當然以上都是可行的作法，但都不如 Watch 來得方便，所以沒有什麼是一定要用到誰，而是透過不同的使用情境來決定！</p>\n<h2 id=\"多層下拉選單\"><a href=\"#多層下拉選單\" class=\"headerlink\" title=\"多層下拉選單\"></a>多層下拉選單</h2><figure class=\"highlight html\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"app\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>Please make your decision:<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        Gender:</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.genderIdx\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">v-for</span>=<span class=\"string\">\"(item, index) in state.clothes\"</span> <span class=\"attr\">:value</span>=<span class=\"string\">\"index\"</span>&gt;</span></span><br><span class=\"line\">                {{item.gender}}</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        Type:</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.partIdx\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">v-for</span>=<span class=\"string\">\"(item, index) in pickTypes\"</span> <span class=\"attr\">:value</span>=<span class=\"string\">\"index\"</span>&gt;</span></span><br><span class=\"line\">                {{item.part}}</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">        Product:</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">v-model</span>=<span class=\"string\">\"state.itemIdx\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">v-for</span>=<span class=\"string\">\"(item, index) in pickParts\"</span> <span class=\"attr\">:value</span>=<span class=\"string\">\"index\"</span>&gt;</span></span><br><span class=\"line\">                {{item.product}}</span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> { reactive, computed, watch } = <span class=\"title class_\">Vue</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> app = {</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"title function_\">setup</span>(<span class=\"params\"></span>){</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> state = <span class=\"title function_\">reactive</span>({</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">genderIdx</span>: <span class=\"number\">0</span>, <span class=\"comment\">// 記錄第一層選單的被選取項目</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">partIdx</span>: <span class=\"number\">0</span>, <span class=\"comment\">// 記錄第二層選單的被選取項目</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">itemIdx</span>: <span class=\"number\">0</span>, <span class=\"comment\">// 記錄第三層選單的被選取項目</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            clothes : [</span></span><br><span class=\"line\"><span class=\"language-javascript\">            {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"attr\">gender</span>: <span class=\"string\">\"男\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"attr\">types</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">part</span>: <span class=\"string\">\"上衣類\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">contents</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"短袖/背心\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"長袖\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"立領/高領\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"針織衫\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"休閒襯衫\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"商務襯衫\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"法蘭絨系列\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"厚棉系列\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">part</span>: <span class=\"string\">\"外套類\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">contents</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"休閒外套\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"Fleece系列\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"極輕羽絨\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"極暖羽絨\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">part</span>: <span class=\"string\">\"下身類\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">contents</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"短/七分褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"九分/束口褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"休閒長褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"牛仔褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"保暖褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">part</span>: <span class=\"string\">\"家居服\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">contents</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"家居套裝\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"家居褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"家居毯\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">            },</span></span><br><span class=\"line\"><span class=\"language-javascript\">            {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"attr\">gender</span>: <span class=\"string\">\"女\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"attr\">types</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">part</span>: <span class=\"string\">\"上衣類\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">contents</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"印花短T\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"印花長T\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"短袖/背心\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"七分/長袖\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"長版上衣\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"針織衫\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"polo衫\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"Pima棉\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">part</span>: <span class=\"string\">\"外套類\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">contents</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"休閒外套\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"Fleece系列\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"極輕羽絨\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"極暖羽絨\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">part</span>: <span class=\"string\">\"下身類\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">contents</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"休閒短褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"七/九分褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"牛仔系列\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"寬褲系列\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"休閒長褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"裙子\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"連身/吊帶褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"緊身褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"裙子\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    {</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">part</span>: <span class=\"string\">\"洋裝\"</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"attr\">contents</span>: [</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"洋裝\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"家居褲\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                            { <span class=\"attr\">product</span>: <span class=\"string\">\"吊帶裙\"</span> },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    },</span></span><br><span class=\"line\"><span class=\"language-javascript\">                ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">            },</span></span><br><span class=\"line\"><span class=\"language-javascript\">            ],</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> pickTypes = <span class=\"title function_\">computed</span>(<span class=\"function\">() =&gt;</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">return</span> state.<span class=\"property\">clothes</span>[state.<span class=\"property\">genderIdx</span>].<span class=\"property\">types</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">const</span> pickParts = <span class=\"title function_\">computed</span>(<span class=\"function\">() =&gt;</span> {</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">return</span> state.<span class=\"property\">clothes</span>[state.<span class=\"property\">genderIdx</span>].<span class=\"property\">types</span>[state.<span class=\"property\">partIdx</span>].<span class=\"property\">contents</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"title function_\">watch</span>(<span class=\"function\">() =&gt;</span> state.<span class=\"property\">genderIdx</span>, <span class=\"function\">(<span class=\"params\">value</span>) =&gt;</span>{</span></span><br><span class=\"line\"><span class=\"language-javascript\">            state.<span class=\"property\">partIdx</span> = <span class=\"number\">0</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"title function_\">watch</span>(<span class=\"function\">() =&gt;</span> state.<span class=\"property\">genderIdx</span>, <span class=\"function\">(<span class=\"params\">value</span>) =&gt;</span>{</span></span><br><span class=\"line\"><span class=\"language-javascript\">            state.<span class=\"property\">itemIdx</span> = <span class=\"number\">0</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        })</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">return</span> { state, pickTypes, pickParts };</span></span><br><span class=\"line\"><span class=\"language-javascript\">    }</span></span><br><span class=\"line\"><span class=\"language-javascript\">}</span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> myVue = <span class=\"title class_\">Vue</span>.<span class=\"title function_\">createApp</span>(app).<span class=\"title function_\">mount</span>(<span class=\"string\">\"#app\"</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"生命週期\"><a href=\"#生命週期\" class=\"headerlink\" title=\"生命週期\"></a>生命週期</h2><p><img data-src=\"https://asus.cloudlab.tw/ue_atd/wp-content/uploads/2020/08/lifecycle-1.png\" alt=\"生命週期\"></p>\n","categories":["Node.js"],"tags":["Node.js","Vue"]},{"title":"Windows 自動封鎖 IP","url":"/posts/4026304689/","content":"<p>自架的對外伺服器常被陌生 IP try 帳密，導致事件檢視器常常卡一堆登入失敗的紀錄而影響判讀，於是決定寫隻簡單的程式來監聽 Event Log 並即時將登入失敗的 IP 加到封鎖清單中。原本以為網路上查查資料，複製貼上改一下應該一小時左右就能搞定，結果各種撞牆卡了我一整天才完成，特此紀錄一下相關注意事項！</p>\n<p><img data-src=\"/posts/4026304689/20221017233626.png\" alt=\"Event Log\"><br><img data-src=\"/posts/4026304689/20221017221448.png\" alt=\"Attack Bar Chart\">  </p>\n<span id=\"more\"></span>\n\n<h2 id=\"Nuget\"><a href=\"#Nuget\" class=\"headerlink\" title=\"Nuget\"></a>Nuget</h2><figure class=\"highlight xml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">PackageReference</span> <span class=\"attr\">Include</span>=<span class=\"string\">\"Microsoft.Extensions.Logging.EventLog\"</span> <span class=\"attr\">Version</span>=<span class=\"string\">\"6.0.0\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">PackageReference</span> <span class=\"attr\">Include</span>=<span class=\"string\">\"System.Diagnostics.EventLog\"</span> <span class=\"attr\">Version</span>=<span class=\"string\">\"6.0.0\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">PackageReference</span> <span class=\"attr\">Include</span>=<span class=\"string\">\"Microsoft.PowerShell.SDK\"</span> <span class=\"attr\">Version</span>=<span class=\"string\">\"7.2.6\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">PackageReference</span> <span class=\"attr\">Include</span>=<span class=\"string\">\"System.Management.Automation\"</span> <span class=\"attr\">Version</span>=<span class=\"string\">\"7.2.6\"</span> /&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"Step\"><a href=\"#Step\" class=\"headerlink\" title=\"Step\"></a>Step</h2><h3 id=\"1-讀取-EventLog-Security-取得-EventId-4625-的相關資訊\"><a href=\"#1-讀取-EventLog-Security-取得-EventId-4625-的相關資訊\" class=\"headerlink\" title=\"1. 讀取 EventLog/Security 取得 EventId=4625 的相關資訊\"></a>1. 讀取 <code>EventLog/Security</code> 取得 <code>EventId=4625</code> 的相關資訊</h3><ul>\n<li><p>讀取需使用 <code>系統管理員</code> 權限</p>\n</li>\n<li><p>範例：</p>\n  <figure class=\"highlight csharp\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> entries =</span><br><span class=\"line\">    <span class=\"keyword\">from</span> EventLogEntry e <span class=\"keyword\">in</span> eventLog.Entries</span><br><span class=\"line\">    <span class=\"keyword\">where</span> e.InstanceId == <span class=\"number\">4625</span></span><br><span class=\"line\">    <span class=\"keyword\">select</span> <span class=\"keyword\">new</span></span><br><span class=\"line\">    {</span><br><span class=\"line\">        e.ReplacementStrings,</span><br><span class=\"line\">    };</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (entries.Count() &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">{</span><br><span class=\"line\">    <span class=\"keyword\">var</span> events = entries.ToList();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> ips = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">int</span>&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> d <span class=\"keyword\">in</span> events)</span><br><span class=\"line\">    {</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (d.ReplacementStrings.Length &gt;= <span class=\"number\">19</span>)</span><br><span class=\"line\">        {</span><br><span class=\"line\">            <span class=\"keyword\">var</span> targetUserName = d.ReplacementStrings[<span class=\"number\">5</span>];</span><br><span class=\"line\">            <span class=\"keyword\">var</span> ip = d.ReplacementStrings[<span class=\"number\">19</span>];</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br></pre></td></tr></tbody></table></figure>\n</li>\n<li><p><code>ReplacementStrings</code> 資料結構參考：</p>\n  <figure class=\"highlight xml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"SubjectUserSid\"</span>&gt;</span>S-1-0-0<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"SubjectUserName\"</span>&gt;</span>-<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"SubjectDomainName\"</span>&gt;</span>-<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"SubjectLogonId\"</span>&gt;</span>0x0<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"TargetUserSid\"</span>&gt;</span>S-1-0-0<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"TargetUserName\"</span>&gt;</span>ѓ®бвм<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"TargetDomainName\"</span> /&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"Status\"</span>&gt;</span>0xc000006d<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"FailureReason\"</span>&gt;</span>%%2313<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"SubStatus\"</span>&gt;</span>0xc0000064<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"LogonType\"</span>&gt;</span>3<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"LogonProcessName\"</span>&gt;</span>NtLmSsp<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"AuthenticationPackageName\"</span>&gt;</span>NTLM<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"WorkstationName\"</span>&gt;</span>-<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"TransmittedServices\"</span>&gt;</span>-<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"LmPackageName\"</span>&gt;</span>-<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"KeyLength\"</span>&gt;</span>0<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"ProcessId\"</span>&gt;</span>0x0<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"ProcessName\"</span>&gt;</span>-<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"IpAddress\"</span>&gt;</span>83.69.141.105<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Data</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"IpPort\"</span>&gt;</span>5223<span class=\"tag\">&lt;/<span class=\"name\">Data</span>&gt;</span> </span><br></pre></td></tr></tbody></table></figure></li>\n</ul>\n<h3 id=\"2-從防火牆規則取得已封鎖-IP-列表\"><a href=\"#2-從防火牆規則取得已封鎖-IP-列表\" class=\"headerlink\" title=\"2. 從防火牆規則取得已封鎖 IP 列表\"></a>2. 從防火牆規則取得已封鎖 IP 列表</h3><ul>\n<li><p>使用 Powershell 語法 <code>Get-NetFirewallRule</code> 取得已封鎖 IP 列表</p>\n</li>\n<li><p>參考 Nuget 套件 <code>System.Management.Automation</code></p>\n</li>\n<li><p>需再參考 Nuget 套件 <code>Microsoft.PowerShell.SDK</code>，不然可能會出現以下錯誤：<br>  <span style=\"color:red\">“Cannot load PowerShell snap-in Microsoft.PowerShell.Diagnostics because of the following error: Could not load file or assembly”</span></p>\n</li>\n<li><p>需注意執行環境的 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWFybi5taWNyb3NvZnQuY29tL3poLXR3L3Bvd2Vyc2hlbGwvbW9kdWxlL21pY3Jvc29mdC5wb3dlcnNoZWxsLmNvcmUvYWJvdXQvYWJvdXRfZXhlY3V0aW9uX3BvbGljaWVzP3ZpZXc9cG93ZXJzaGVsbC03LjI=\">Powershell 執行原則<i class=\"fa fa-external-link-alt\"></i></span> 是否低於 <code>RemoteSigned</code>，不然可能會出現以下錯誤：<br>  <span style=\"color:red\">Cannot be loaded because running scripts is disabled on this system</span></p>\n</li>\n<li><p>範例：</p>\n  <figure class=\"highlight csharp\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> ps = PowerShell.Create())</span><br><span class=\"line\">{</span><br><span class=\"line\">    <span class=\"comment\">// 設定執行原則</span></span><br><span class=\"line\">    ps.AddScript(<span class=\"string\">\"Set-ExecutionPolicy RemoteSigned\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 從防火牆規則 firewallRuleName 取出當前已封鎖 IP 列表</span></span><br><span class=\"line\">    ps.AddScript(<span class=\"string\">\"Import-Module NetSecurity\"</span>);</span><br><span class=\"line\">    ps.AddScript(<span class=\"string\">$\"[string[]](Get-NetFirewallRule -DisplayName '<span class=\"subst\">{firewallRuleName}</span>' | Get-NetFirewallAddressFilter).RemoteAddress\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 以上語法有特別轉型成 String[]，故可用 Invoke&lt;string&gt;() 直接取得</span></span><br><span class=\"line\">    <span class=\"keyword\">foreach</span> (<span class=\"built_in\">string</span> ip <span class=\"keyword\">in</span> ps.Invoke&lt;<span class=\"built_in\">string</span>&gt;())</span><br><span class=\"line\">    {</span><br><span class=\"line\">        blockedIps.Add(ip);</span><br><span class=\"line\">    }</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Powershell 執行異常時不會拋錯，需用以下語法取出</span></span><br><span class=\"line\">    PSDataCollection&lt;ErrorRecord&gt; errors = ps.Streams.Error;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (errors != <span class=\"literal\">null</span> &amp;&amp; errors.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">    {</span><br><span class=\"line\">        <span class=\"keyword\">foreach</span> (ErrorRecord err <span class=\"keyword\">in</span> errors)</span><br><span class=\"line\">        {</span><br><span class=\"line\">            Write2EventLog(<span class=\"string\">$\"Error: <span class=\"subst\">{err}</span>\"</span>, EventLogEntryType.Error);</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure></li>\n</ul>\n<h3 id=\"3-整併-IP-列表並寫入防火牆規則\"><a href=\"#3-整併-IP-列表並寫入防火牆規則\" class=\"headerlink\" title=\"3. 整併 IP 列表並寫入防火牆規則\"></a>3. 整併 IP 列表並寫入防火牆規則</h3><ul>\n<li><p>使用 Powershell 語法  <code>Set-NetFirewallRule</code> 寫回阻擋規則</p>\n</li>\n<li><p>使用 <code>@(\"111.222.333.444\", \"111.222.333.555\")</code> 格式產生 Powershell 的 String [] 參數</p>\n</li>\n<li><p>範例：</p>\n  <figure class=\"highlight csharp\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> ps = PowerShell.Create())</span><br><span class=\"line\">{</span><br><span class=\"line\">    <span class=\"keyword\">var</span> sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    sb.Append(<span class=\"string\">\"\\\"\"</span>);</span><br><span class=\"line\">    sb.Append(<span class=\"built_in\">string</span>.Join(<span class=\"string\">\"\\\",\\\"\"</span>, ips));</span><br><span class=\"line\">    sb.Append(<span class=\"string\">\"\\\"\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    ps.AddScript(<span class=\"string\">\"Set-ExecutionPolicy RemoteSigned\"</span>);</span><br><span class=\"line\">    ps.AddScript(<span class=\"string\">\"Import-Module NetSecurity\"</span>);</span><br><span class=\"line\">    ps.AddScript(<span class=\"string\">$\"Set-NetFirewallRule -DisplayName '<span class=\"subst\">{firewallRuleName}</span>' -Direction Inbound -Action Block -RemoteAddress @(<span class=\"subst\">{sb}</span>)\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    ps.Invoke();</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure></li>\n</ul>\n<h3 id=\"4-透過-4625-事件觸發\"><a href=\"#4-透過-4625-事件觸發\" class=\"headerlink\" title=\"4. 透過 4625 事件觸發\"></a>4. 透過 <code>4625</code> 事件觸發</h3><ul>\n<li><p>可直接從 <code>EventLog/Security</code> 事件附加工作排程</p>\n<p>  <img data-src=\"/posts/4026304689/20221017231704.png\" alt=\"從 4625 事件附加工作排程\"><br>  <img data-src=\"/posts/4026304689/20221017231820.png\" alt=\"觸發程序\"></p>\n</li>\n</ul>\n<h2 id=\"Example\"><a href=\"#Example\" class=\"headerlink\" title=\"Example\"></a>Example</h2><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0t1b0Fubi9BdXRvQmxvY2tJcA==\">https://github.com/KuoAnn/AutoBlockIp<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n<h2 id=\"結果\"><a href=\"#結果\" class=\"headerlink\" title=\"結果\"></a>結果</h2><p>放了一個晚上就擋了 14 組 IP，網路的世界真是險惡…</p>\n<p><img data-src=\"/posts/4026304689/20221018221135.png\" alt=\"Event Log\">  </p>\n<p>自啟用排程後有效降低被攻擊的次數</p>\n<p><img data-src=\"/posts/4026304689/20221018222136.png\" alt=\"Attack Bar Chart\"></p>\n<h2 id=\"踩雷\"><a href=\"#踩雷\" class=\"headerlink\" title=\"踩雷\"></a>踩雷</h2><ul>\n<li>因套件使用到 Powershell 腳本，須注意不能使用單一檔案發布，不然會出現以下錯誤：</li>\n</ul>\n<blockquote>\n<p>The type initializer for ‘System.Management.Automation.ExperimentalFeature’ threw an exception.</p>\n</blockquote>\n<ul>\n<li>發布時需用可攜式，指定 RID 可能會抓不到特定版本的 dll</li>\n</ul>\n<blockquote>\n<p>Could not load file or assembly ‘Microsoft.Management.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35’. 系統找不到指定的檔案。</p>\n</blockquote>\n<blockquote>\n<p>Ref. <span class=\"exturl\" data-url=\"aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTYzNTI2NzIvcnVubmluZy1wb3dlcnNoZWxsLWZyb20tbmV0LWNvcmUtY291bGQtbm90LWxvYWQtZmlsZS1vci1hc3NlbWJseS1taWNyb3NvZnQtbWE=\">https://stackoverflow.com/questions/56352672/running-powershell-from-net-core-could-not-load-file-or-assembly-microsoft-ma<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","categories":["C#"],"tags":["Windows","Firewall","Powershell","Event Log"]},{"title":"指定 .NET 編譯時所產生的語系資源檔","url":"/posts/2071791023/","content":"<p>專案在編譯支援多語系的程式庫時，可能會產生一堆用不到的語系資源 (<span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWFybi5taWNyb3NvZnQuY29tL2VuLXVzL2RvdG5ldC9jb3JlL2V4dGVuc2lvbnMvY3JlYXRlLXNhdGVsbGl0ZS1hc3NlbWJsaWVzP1dULm1jX2lkPURPUC1NVlAtMzc1ODA=\">衛星組件 (Satellite Assembly)<i class=\"fa fa-external-link-alt\"></i></span>)。若僅會用到部分語系時，可於專案檔 (*.csproj) 內加入 &lt;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWFybi5taWNyb3NvZnQuY29tL2VuLXVzL2RvdG5ldC9jb3JlL3Byb2plY3Qtc2RrL21zYnVpbGQtcHJvcHM/V1QubWNfaWQ9RE9QLU1WUC0zNzU4MCNzYXRlbGxpdGVyZXNvdXJjZWxhbmd1YWdlcw==\">SatelliteResourceLanguages<i class=\"fa fa-external-link-alt\"></i></span>&gt;</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">PropertyGroup</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">SatelliteResourceLanguages</span>&gt;</span>en;zh-TW<span class=\"tag\">&lt;/<span class=\"name\">SatelliteResourceLanguages</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">PropertyGroup</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<span id=\"more\"></span>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmRhcmt0aHJlYWQubmV0L2Jsb2cvZmlsdGVyLXJlcy1sYW5nLWZpbGVzLw==\">【笨問題】防止 .NET 編譯產生不需要的多語系資源檔<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","categories":["C#"],"tags":["C#","ASP.NET Core",".csproj","Visual Studio"]},{"title":"自動更新當前目錄下所有 Git 儲存庫","url":"/posts/1763796179/","content":"<p>以下 Bash 腳本會自動 Pull 當前目錄下所有儲存庫的程式碼：</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\">for dir in */; do</span><br><span class=\"line\">    if [ -d \"$dir/.git\" ]; then</span><br><span class=\"line\">        echo \"Updating $dir\"</span><br><span class=\"line\">        cd \"$dir\"</span><br><span class=\"line\">        git pull</span><br><span class=\"line\">        cd ..</span><br><span class=\"line\">    fi</span><br><span class=\"line\">done</span><br></pre></td></tr></tbody></table></figure>\n","categories":["Git"],"tags":["Git","Bash"]},{"title":"自動線上文件 - Mssql Schema to Html","url":"/posts/1976722200/","content":"<ul>\n<li>將資料庫結構轉 Html 的語法</li>\n<li>搭配 bat 檔可排入排程自動更新</li>\n</ul>\n<span id=\"more\"></span>\n\n<h3 id=\"GenDBSchemaToHtml-sql\"><a href=\"#GenDBSchemaToHtml-sql\" class=\"headerlink\" title=\"GenDBSchemaToHtml.sql\"></a>GenDBSchemaToHtml.sql</h3><figure class=\"highlight sql\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--//SQL Database documentation script</span></span><br><span class=\"line\"><span class=\"keyword\">SET</span> FMTONLY <span class=\"keyword\">ON</span></span><br><span class=\"line\">use KOKON</span><br><span class=\"line\"><span class=\"keyword\">SET</span> FMTONLY OFF</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Declare</span> <span class=\"variable\">@i</span> <span class=\"type\">Int</span>, <span class=\"variable\">@maxi</span> <span class=\"type\">Int</span></span><br><span class=\"line\"><span class=\"keyword\">Declare</span> <span class=\"variable\">@j</span> <span class=\"type\">Int</span>, <span class=\"variable\">@maxj</span> <span class=\"type\">Int</span></span><br><span class=\"line\"><span class=\"keyword\">Declare</span> <span class=\"variable\">@sr</span> <span class=\"type\">int</span></span><br><span class=\"line\"><span class=\"keyword\">Declare</span> <span class=\"variable\">@Output</span> <span class=\"type\">varchar</span>(<span class=\"number\">4000</span>)</span><br><span class=\"line\"><span class=\"comment\">--Declare @tmpOutput varchar(max)</span></span><br><span class=\"line\"><span class=\"keyword\">Declare</span> <span class=\"variable\">@SqlVersion</span> <span class=\"type\">varchar</span>(<span class=\"number\">5</span>)</span><br><span class=\"line\"><span class=\"keyword\">Declare</span> <span class=\"variable\">@last</span> <span class=\"type\">varchar</span>(<span class=\"number\">155</span>), <span class=\"variable\">@current</span> <span class=\"type\">varchar</span>(<span class=\"number\">255</span>), <span class=\"variable\">@typ</span> <span class=\"type\">varchar</span>(<span class=\"number\">255</span>), <span class=\"variable\">@description</span> <span class=\"type\">varchar</span>(<span class=\"number\">4000</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">Table</span> #Tables  (id <span class=\"type\">int</span> <span class=\"keyword\">identity</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>), Object_id <span class=\"type\">int</span>, Name <span class=\"type\">varchar</span>(<span class=\"number\">155</span>), Type <span class=\"type\">varchar</span>(<span class=\"number\">20</span>), [description] <span class=\"type\">varchar</span>(<span class=\"number\">4000</span>))</span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">Table</span> #Columns (id <span class=\"type\">int</span> <span class=\"keyword\">identity</span>(<span class=\"number\">1</span>,<span class=\"number\">1</span>), Name <span class=\"type\">varchar</span>(<span class=\"number\">155</span>), Type <span class=\"type\">Varchar</span>(<span class=\"number\">155</span>), Nullable <span class=\"type\">varchar</span>(<span class=\"number\">2</span>), [description] <span class=\"type\">varchar</span>(<span class=\"number\">4000</span>))</span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">Table</span> #Fk(id <span class=\"type\">int</span> <span class=\"keyword\">identity</span>(<span class=\"number\">1</span>,<span class=\"number\">1</span>), Name <span class=\"type\">varchar</span>(<span class=\"number\">155</span>), col <span class=\"type\">Varchar</span>(<span class=\"number\">155</span>), refObj <span class=\"type\">varchar</span>(<span class=\"number\">155</span>), refCol <span class=\"type\">varchar</span>(<span class=\"number\">155</span>))</span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">Table</span> #<span class=\"keyword\">Constraint</span>(id <span class=\"type\">int</span> <span class=\"keyword\">identity</span>(<span class=\"number\">1</span>,<span class=\"number\">1</span>), Name <span class=\"type\">varchar</span>(<span class=\"number\">155</span>), col <span class=\"type\">Varchar</span>(<span class=\"number\">155</span>), definition <span class=\"type\">varchar</span>(<span class=\"number\">1000</span>))</span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">Table</span> #Indexes(id <span class=\"type\">int</span> <span class=\"keyword\">identity</span>(<span class=\"number\">1</span>,<span class=\"number\">1</span>), Name <span class=\"type\">varchar</span>(<span class=\"number\">155</span>), Type <span class=\"type\">Varchar</span>(<span class=\"number\">25</span>), cols <span class=\"type\">varchar</span>(<span class=\"number\">1000</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"> If (<span class=\"built_in\">substring</span>(@<span class=\"variable\">@VERSION</span>, <span class=\"number\">1</span>, <span class=\"number\">25</span> ) <span class=\"operator\">=</span> <span class=\"string\">'Microsoft SQL Server 2005'</span>)</span><br><span class=\"line\"> <span class=\"keyword\">set</span> <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2005'</span></span><br><span class=\"line\"><span class=\"keyword\">else</span> if (<span class=\"built_in\">substring</span>(@<span class=\"variable\">@VERSION</span>, <span class=\"number\">1</span>, <span class=\"number\">26</span> ) <span class=\"operator\">=</span> <span class=\"string\">'Microsoft SQL Server  2000'</span>)</span><br><span class=\"line\"> <span class=\"keyword\">set</span> <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2000'</span></span><br><span class=\"line\"><span class=\"keyword\">else</span> </span><br><span class=\"line\"> <span class=\"keyword\">set</span> <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2005'</span></span><br><span class=\"line\"> </span><br><span class=\"line\">Print <span class=\"string\">'&lt;html&gt;'</span></span><br><span class=\"line\">Print <span class=\"string\">'&lt;head&gt;'</span></span><br><span class=\"line\">Print <span class=\"string\">'&lt;meta charset=\"Big5\"&gt;'</span></span><br><span class=\"line\">Print <span class=\"string\">'&lt;title&gt;::'</span> <span class=\"operator\">+</span> DB_name() <span class=\"operator\">+</span> <span class=\"string\">'::&lt;/title&gt;'</span></span><br><span class=\"line\">Print <span class=\"string\">'&lt;style&gt;'</span></span><br><span class=\"line\">    </span><br><span class=\"line\">Print <span class=\"string\">'  body {'</span></span><br><span class=\"line\">Print <span class=\"string\">'   font-family:verdana;'</span></span><br><span class=\"line\">Print <span class=\"string\">'   font-size:16pt;'</span></span><br><span class=\"line\">Print <span class=\"string\">'  }'</span></span><br><span class=\"line\">  </span><br><span class=\"line\">Print <span class=\"string\">'  td {'</span></span><br><span class=\"line\">Print <span class=\"string\">'   font-family:verdana;'</span></span><br><span class=\"line\">Print <span class=\"string\">'  }'</span></span><br><span class=\"line\">  </span><br><span class=\"line\">Print <span class=\"string\">'  th {'</span></span><br><span class=\"line\">Print <span class=\"string\">'   font-family:verdana;'</span></span><br><span class=\"line\">Print <span class=\"string\">'   background:#d3d3d3;'</span></span><br><span class=\"line\">Print <span class=\"string\">'  }'</span></span><br><span class=\"line\">Print <span class=\"string\">'  table'</span></span><br><span class=\"line\">Print <span class=\"string\">'  {'</span></span><br><span class=\"line\">Print <span class=\"string\">'   background:#d3d3d3;'</span></span><br><span class=\"line\">Print <span class=\"string\">'  }'</span></span><br><span class=\"line\">Print <span class=\"string\">'  tr'</span></span><br><span class=\"line\">Print <span class=\"string\">'  {'</span></span><br><span class=\"line\">Print <span class=\"string\">'   background:#ffffff;'</span></span><br><span class=\"line\">Print <span class=\"string\">'  }'</span></span><br><span class=\"line\">Print <span class=\"string\">'  pre'</span></span><br><span class=\"line\">Print <span class=\"string\">'  {'</span></span><br><span class=\"line\">Print <span class=\"string\">'   font-size:16px;'</span></span><br><span class=\"line\">Print <span class=\"string\">'  }'</span></span><br><span class=\"line\">Print <span class=\"string\">' &lt;/style&gt;'</span></span><br><span class=\"line\">Print <span class=\"string\">'&lt;/head&gt;'</span></span><br><span class=\"line\">Print <span class=\"string\">'&lt;body&gt;'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">set</span> nocount <span class=\"keyword\">on</span></span><br><span class=\"line\"> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2000'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #Tables (Object_id, Name, Type, [description])</span><br><span class=\"line\">   <span class=\"comment\">--FOR 2000</span></span><br><span class=\"line\">   <span class=\"keyword\">select</span> object_id(table_name),  <span class=\"string\">'['</span> <span class=\"operator\">+</span> table_schema <span class=\"operator\">+</span> <span class=\"string\">'].['</span> <span class=\"operator\">+</span> table_name <span class=\"operator\">+</span> <span class=\"string\">']'</span>,  </span><br><span class=\"line\">   <span class=\"keyword\">case</span> <span class=\"keyword\">when</span> table_type <span class=\"operator\">=</span> <span class=\"string\">'BASE TABLE'</span>  <span class=\"keyword\">then</span> <span class=\"string\">'Table'</span>   <span class=\"keyword\">else</span> <span class=\"string\">'View'</span> <span class=\"keyword\">end</span>,</span><br><span class=\"line\">   <span class=\"built_in\">cast</span>(p.value <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>(<span class=\"number\">4000</span>))</span><br><span class=\"line\">   <span class=\"keyword\">from</span> information_schema.tables t</span><br><span class=\"line\">   <span class=\"keyword\">left</span> <span class=\"keyword\">outer</span> <span class=\"keyword\">join</span> sysproperties p <span class=\"keyword\">on</span> p.id <span class=\"operator\">=</span> object_id(t.table_name) <span class=\"keyword\">and</span> smallid <span class=\"operator\">=</span> <span class=\"number\">0</span> <span class=\"keyword\">and</span> p.name <span class=\"operator\">=</span> <span class=\"string\">'MS_Description'</span> </span><br><span class=\"line\">   <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> table_type, table_schema, table_name</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"> <span class=\"keyword\">else</span> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2005'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #Tables (Object_id, Name, Type, [description])</span><br><span class=\"line\">  <span class=\"comment\">--FOR 2005</span></span><br><span class=\"line\">  <span class=\"keyword\">Select</span> o.object_id,  <span class=\"string\">'['</span> <span class=\"operator\">+</span> s.name <span class=\"operator\">+</span> <span class=\"string\">'].['</span> <span class=\"operator\">+</span> o.name <span class=\"operator\">+</span> <span class=\"string\">']'</span>, </span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"keyword\">when</span> type <span class=\"operator\">=</span> <span class=\"string\">'V'</span> <span class=\"keyword\">then</span> <span class=\"string\">'View'</span> <span class=\"keyword\">when</span> type <span class=\"operator\">=</span> <span class=\"string\">'U'</span> <span class=\"keyword\">then</span> <span class=\"string\">'Table'</span> <span class=\"keyword\">end</span>,  </span><br><span class=\"line\">    <span class=\"built_in\">cast</span>(p.value <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>(<span class=\"number\">4000</span>))</span><br><span class=\"line\">    <span class=\"keyword\">from</span> sys.objects o </span><br><span class=\"line\">     <span class=\"keyword\">left</span> <span class=\"keyword\">outer</span> <span class=\"keyword\">join</span> sys.schemas s <span class=\"keyword\">on</span> s.schema_id <span class=\"operator\">=</span> o.schema_id </span><br><span class=\"line\">     <span class=\"keyword\">left</span> <span class=\"keyword\">outer</span> <span class=\"keyword\">join</span> sys.extended_properties p <span class=\"keyword\">on</span> p.major_id <span class=\"operator\">=</span> o.object_id <span class=\"keyword\">and</span> minor_id <span class=\"operator\">=</span> <span class=\"number\">0</span> <span class=\"keyword\">and</span> p.name <span class=\"operator\">=</span> <span class=\"string\">'MS_Description'</span> </span><br><span class=\"line\">    <span class=\"keyword\">where</span> type <span class=\"keyword\">in</span> (<span class=\"string\">'U'</span>, <span class=\"string\">'V'</span>) </span><br><span class=\"line\">    <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> type, s.name, o.name</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">Set</span> <span class=\"variable\">@maxi</span> <span class=\"operator\">=</span> @<span class=\"variable\">@rowcount</span></span><br><span class=\"line\"><span class=\"keyword\">set</span> <span class=\"variable\">@i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"550px\" align=\"center\"&gt;&lt;tr&gt;&lt;td colspan=\"3\" style=\"height:50;font-size:14pt;text-align:center;\"&gt;&lt;a name=\"index\"&gt;&lt;/a&gt;&lt;b&gt;Index&lt;/b&gt;&lt;div&gt;更新日期：'</span><span class=\"operator\">+</span><span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>, getdate(), <span class=\"number\">120</span>)<span class=\"operator\">+</span><span class=\"string\">'&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span></span><br><span class=\"line\">print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"1\" cellpadding=\"0\" width=\"550px\" align=\"center\"&gt;&lt;tr&gt;&lt;th&gt;Sr&lt;/th&gt;&lt;th&gt;Object&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;th&gt;Type&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\">While(<span class=\"variable\">@i</span> <span class=\"operator\">&lt;=</span> <span class=\"variable\">@maxi</span>)</span><br><span class=\"line\"><span class=\"keyword\">begin</span></span><br><span class=\"line\"> <span class=\"keyword\">select</span> <span class=\"variable\">@Output</span> <span class=\"operator\">=</span>  <span class=\"string\">'&lt;tr&gt;&lt;td align=\"center\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"built_in\">Cast</span>((<span class=\"variable\">@i</span>) <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td&gt;&lt;a href=\"#'</span> <span class=\"operator\">+</span> Type <span class=\"operator\">+</span> <span class=\"string\">':'</span> <span class=\"operator\">+</span> name <span class=\"operator\">+</span> <span class=\"string\">'\"&gt;'</span> <span class=\"operator\">+</span> name <span class=\"operator\">+</span> <span class=\"string\">'&lt;/a&gt;&lt;/td&gt;&lt;td&gt;'</span> <span class=\"operator\">+</span> isnull([description], <span class=\"string\">''</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td&gt;'</span> <span class=\"operator\">+</span> Type <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\">   <span class=\"keyword\">from</span> #Tables <span class=\"keyword\">where</span> id <span class=\"operator\">=</span> <span class=\"variable\">@i</span></span><br><span class=\"line\"> </span><br><span class=\"line\"> print <span class=\"variable\">@Output</span></span><br><span class=\"line\"> <span class=\"keyword\">set</span> <span class=\"variable\">@i</span> <span class=\"operator\">=</span> <span class=\"variable\">@i</span> <span class=\"operator\">+</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">print <span class=\"string\">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">set</span> <span class=\"variable\">@i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span></span><br><span class=\"line\">While(<span class=\"variable\">@i</span> <span class=\"operator\">&lt;=</span> <span class=\"variable\">@maxi</span>)</span><br><span class=\"line\"><span class=\"keyword\">begin</span></span><br><span class=\"line\"> <span class=\"comment\">--table header</span></span><br><span class=\"line\"> <span class=\"keyword\">select</span> <span class=\"variable\">@Output</span> <span class=\"operator\">=</span>  <span class=\"string\">'&lt;tr&gt;&lt;th align=\"left\"&gt;&lt;a name=\"'</span> <span class=\"operator\">+</span> Type <span class=\"operator\">+</span> <span class=\"string\">':'</span> <span class=\"operator\">+</span> name <span class=\"operator\">+</span> <span class=\"string\">'\"&gt;&lt;/a&gt;&lt;b&gt;'</span> <span class=\"operator\">+</span> Type <span class=\"operator\">+</span> <span class=\"string\">':'</span> <span class=\"operator\">+</span> name <span class=\"operator\">+</span> <span class=\"string\">'&lt;/b&gt;&lt;/th&gt;&lt;/tr&gt;'</span>,  <span class=\"variable\">@description</span> <span class=\"operator\">=</span> [description]</span><br><span class=\"line\">   <span class=\"keyword\">from</span> #Tables <span class=\"keyword\">where</span> id <span class=\"operator\">=</span> <span class=\"variable\">@i</span></span><br><span class=\"line\"> </span><br><span class=\"line\"> print <span class=\"string\">'&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"1200px\"&gt;&lt;tr&gt;&lt;td align=\"right\"&gt;&lt;a href=\"#index\"&gt;Index&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;'</span></span><br><span class=\"line\"> print <span class=\"variable\">@Output</span></span><br><span class=\"line\"> print <span class=\"string\">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class=\"line\"> print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Description&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;'</span> <span class=\"operator\">+</span> isnull(<span class=\"variable\">@description</span>, <span class=\"string\">''</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br /&gt;'</span> </span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">--table columns</span></span><br><span class=\"line\"> <span class=\"keyword\">truncate</span> <span class=\"keyword\">table</span> #Columns </span><br><span class=\"line\"> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2000'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #Columns  (Name, Type, Nullable, [description])</span><br><span class=\"line\">  <span class=\"comment\">--FOR 2000</span></span><br><span class=\"line\">  <span class=\"keyword\">Select</span> c.name, </span><br><span class=\"line\">     type_name(xtype) <span class=\"operator\">+</span> (</span><br><span class=\"line\">     <span class=\"keyword\">case</span> <span class=\"keyword\">when</span> (type_name(xtype) <span class=\"operator\">=</span> <span class=\"string\">'varchar'</span> <span class=\"keyword\">or</span> type_name(xtype) <span class=\"operator\">=</span> <span class=\"string\">'nvarchar'</span> <span class=\"keyword\">or</span> type_name(xtype) <span class=\"operator\">=</span><span class=\"string\">'char'</span> <span class=\"keyword\">or</span> type_name(xtype) <span class=\"operator\">=</span><span class=\"string\">'nchar'</span>)</span><br><span class=\"line\">      <span class=\"keyword\">then</span> <span class=\"string\">'('</span> <span class=\"operator\">+</span> <span class=\"built_in\">cast</span>(length <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">')'</span> </span><br><span class=\"line\">      <span class=\"keyword\">when</span> type_name(xtype) <span class=\"operator\">=</span> <span class=\"string\">'decimal'</span>  </span><br><span class=\"line\">       <span class=\"keyword\">then</span> <span class=\"string\">'('</span> <span class=\"operator\">+</span> <span class=\"built_in\">cast</span>(prec <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">','</span> <span class=\"operator\">+</span> <span class=\"built_in\">cast</span>(scale <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>)   <span class=\"operator\">+</span> <span class=\"string\">')'</span> </span><br><span class=\"line\">     <span class=\"keyword\">else</span> <span class=\"string\">''</span></span><br><span class=\"line\">     <span class=\"keyword\">end</span>    </span><br><span class=\"line\">     ), </span><br><span class=\"line\">     <span class=\"keyword\">case</span> <span class=\"keyword\">when</span> isnullable <span class=\"operator\">=</span> <span class=\"number\">1</span> <span class=\"keyword\">then</span> <span class=\"string\">'Y'</span> <span class=\"keyword\">else</span> <span class=\"string\">'N'</span>  <span class=\"keyword\">end</span>, </span><br><span class=\"line\">     <span class=\"built_in\">cast</span>(p.value <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>(<span class=\"number\">8000</span>))</span><br><span class=\"line\">    <span class=\"keyword\">from</span> syscolumns c</span><br><span class=\"line\">     <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> c.id</span><br><span class=\"line\">     <span class=\"keyword\">left</span> <span class=\"keyword\">outer</span> <span class=\"keyword\">join</span> sysproperties p <span class=\"keyword\">on</span> p.id <span class=\"operator\">=</span> c.id <span class=\"keyword\">and</span> p.smallid <span class=\"operator\">=</span> c.colid <span class=\"keyword\">and</span> p.name <span class=\"operator\">=</span> <span class=\"string\">'MS_Description'</span> </span><br><span class=\"line\">    <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span></span><br><span class=\"line\">    <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> c.colorder</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"> <span class=\"keyword\">else</span> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2005'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #Columns  (Name, Type, Nullable, [description])</span><br><span class=\"line\">  <span class=\"comment\">--FOR 2005 </span></span><br><span class=\"line\">  <span class=\"keyword\">Select</span> c.name, </span><br><span class=\"line\">     type_name(user_type_id) <span class=\"operator\">+</span> (</span><br><span class=\"line\">     <span class=\"keyword\">case</span> <span class=\"keyword\">when</span> (type_name(user_type_id) <span class=\"operator\">=</span> <span class=\"string\">'varchar'</span> <span class=\"keyword\">or</span> type_name(user_type_id) <span class=\"operator\">=</span> <span class=\"string\">'nvarchar'</span> <span class=\"keyword\">or</span> type_name(user_type_id) <span class=\"operator\">=</span><span class=\"string\">'char'</span> <span class=\"keyword\">or</span> type_name(user_type_id) <span class=\"operator\">=</span><span class=\"string\">'nchar'</span>)</span><br><span class=\"line\">      <span class=\"keyword\">then</span> <span class=\"string\">'('</span> <span class=\"operator\">+</span> <span class=\"built_in\">cast</span>(max_length <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">')'</span> </span><br><span class=\"line\">      <span class=\"keyword\">when</span> type_name(user_type_id) <span class=\"operator\">=</span> <span class=\"string\">'decimal'</span>  </span><br><span class=\"line\">       <span class=\"keyword\">then</span> <span class=\"string\">'('</span> <span class=\"operator\">+</span> <span class=\"built_in\">cast</span>([<span class=\"keyword\">precision</span>] <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">','</span> <span class=\"operator\">+</span> <span class=\"built_in\">cast</span>(scale <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>)   <span class=\"operator\">+</span> <span class=\"string\">')'</span> </span><br><span class=\"line\">     <span class=\"keyword\">else</span> <span class=\"string\">''</span></span><br><span class=\"line\">     <span class=\"keyword\">end</span>    </span><br><span class=\"line\">     ), </span><br><span class=\"line\">     <span class=\"keyword\">case</span> <span class=\"keyword\">when</span> is_nullable <span class=\"operator\">=</span> <span class=\"number\">1</span> <span class=\"keyword\">then</span> <span class=\"string\">'Y'</span> <span class=\"keyword\">else</span> <span class=\"string\">'N'</span>  <span class=\"keyword\">end</span>,</span><br><span class=\"line\">     <span class=\"built_in\">cast</span>(p.value <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>(<span class=\"number\">4000</span>))</span><br><span class=\"line\">  <span class=\"keyword\">from</span> sys.columns c</span><br><span class=\"line\">    <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> c.object_id</span><br><span class=\"line\">    <span class=\"keyword\">left</span> <span class=\"keyword\">outer</span> <span class=\"keyword\">join</span> sys.extended_properties p <span class=\"keyword\">on</span> p.major_id <span class=\"operator\">=</span> c.object_id <span class=\"keyword\">and</span> p.minor_id  <span class=\"operator\">=</span> c.column_id <span class=\"keyword\">and</span> p.name <span class=\"operator\">=</span> <span class=\"string\">'MS_Description'</span> </span><br><span class=\"line\">  <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span></span><br><span class=\"line\">  <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> c.column_id</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"> <span class=\"keyword\">Set</span> <span class=\"variable\">@maxj</span> <span class=\"operator\">=</span>   @<span class=\"variable\">@rowcount</span></span><br><span class=\"line\"> <span class=\"keyword\">set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"> print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Table Columns&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class=\"line\"> print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"1\" cellpadding=\"0\" width=\"1200px\"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Datatype&lt;/th&gt;&lt;th&gt;Nullable&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\"> </span><br><span class=\"line\"> While(<span class=\"variable\">@j</span> <span class=\"operator\">&lt;=</span> <span class=\"variable\">@maxj</span>)</span><br><span class=\"line\"> <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">select</span> <span class=\"variable\">@Output</span> <span class=\"operator\">=</span> <span class=\"string\">'&lt;tr&gt;&lt;td width=\"20px\" align=\"center\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"built_in\">Cast</span>((<span class=\"variable\">@j</span>) <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"150px\"&gt;'</span> <span class=\"operator\">+</span> isnull(name,<span class=\"string\">''</span>)  <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"150px\"&gt;'</span> <span class=\"operator\">+</span>  <span class=\"built_in\">upper</span>(isnull(Type,<span class=\"string\">''</span>)) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"50px\" align=\"center\"&gt;'</span> <span class=\"operator\">+</span> isnull(Nullable,<span class=\"string\">'N'</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td&gt;&lt;pre&gt;'</span> <span class=\"operator\">+</span> isnull([description],<span class=\"string\">''</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\">   <span class=\"keyword\">from</span> #Columns  <span class=\"keyword\">where</span> id <span class=\"operator\">=</span> <span class=\"variable\">@j</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  print  <span class=\"variable\">@Output</span>  </span><br><span class=\"line\">  <span class=\"keyword\">Set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"variable\">@j</span> <span class=\"operator\">+</span> <span class=\"number\">1</span>;</span><br><span class=\"line\"> <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"> print <span class=\"string\">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">--reference key</span></span><br><span class=\"line\"> <span class=\"keyword\">truncate</span> <span class=\"keyword\">table</span> #FK</span><br><span class=\"line\"> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2000'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #FK  (Name, col, refObj, refCol)</span><br><span class=\"line\"> <span class=\"comment\">--  FOR 2000</span></span><br><span class=\"line\">  <span class=\"keyword\">select</span> object_name(constid), s.name,  object_name(rkeyid) ,  s1.name  </span><br><span class=\"line\">    <span class=\"keyword\">from</span> sysforeignkeys f</span><br><span class=\"line\">     <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> sysobjects o <span class=\"keyword\">on</span> o.id <span class=\"operator\">=</span> f.constid</span><br><span class=\"line\">     <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> syscolumns s <span class=\"keyword\">on</span> s.id <span class=\"operator\">=</span> f.fkeyid <span class=\"keyword\">and</span> s.colorder <span class=\"operator\">=</span> f.fkey</span><br><span class=\"line\">     <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> syscolumns s1 <span class=\"keyword\">on</span> s1.id <span class=\"operator\">=</span> f.rkeyid <span class=\"keyword\">and</span> s1.colorder <span class=\"operator\">=</span> f.rkey</span><br><span class=\"line\">     <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> f.fkeyid</span><br><span class=\"line\">    <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span></span><br><span class=\"line\">    <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> <span class=\"number\">1</span></span><br><span class=\"line\">  <span class=\"keyword\">end</span> </span><br><span class=\"line\"> <span class=\"keyword\">else</span> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2005'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #FK  (Name, col, refObj, refCol)</span><br><span class=\"line\"><span class=\"comment\">--  FOR 2005</span></span><br><span class=\"line\">  <span class=\"keyword\">select</span> f.name, COL_NAME (fc.parent_object_id, fc.parent_column_id) , object_name(fc.referenced_object_id) , COL_NAME (fc.referenced_object_id, fc.referenced_column_id)     </span><br><span class=\"line\">  <span class=\"keyword\">from</span> sys.foreign_keys f</span><br><span class=\"line\">   <span class=\"keyword\">inner</span>  <span class=\"keyword\">join</span>  sys.foreign_key_columns  fc  <span class=\"keyword\">on</span> f.object_id <span class=\"operator\">=</span> fc.constraint_object_id </span><br><span class=\"line\">   <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> f.parent_object_id</span><br><span class=\"line\">  <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span></span><br><span class=\"line\">  <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> f.name</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"keyword\">Set</span> <span class=\"variable\">@maxj</span> <span class=\"operator\">=</span>   @<span class=\"variable\">@rowcount</span></span><br><span class=\"line\"> <span class=\"keyword\">set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"number\">1</span></span><br><span class=\"line\"> if (<span class=\"variable\">@maxj</span> <span class=\"operator\">&gt;</span><span class=\"number\">0</span>)</span><br><span class=\"line\"> <span class=\"keyword\">begin</span></span><br><span class=\"line\"></span><br><span class=\"line\">  print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Refrence Keys&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class=\"line\">  print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"1\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Column&lt;/th&gt;&lt;th&gt;Reference To&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\"></span><br><span class=\"line\">  While(<span class=\"variable\">@j</span> <span class=\"operator\">&lt;=</span> <span class=\"variable\">@maxj</span>)</span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">select</span> <span class=\"variable\">@Output</span> <span class=\"operator\">=</span> <span class=\"string\">'&lt;tr&gt;&lt;td width=\"20px\" align=\"center\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"built_in\">Cast</span>((<span class=\"variable\">@j</span>) <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"150px\"&gt;'</span> <span class=\"operator\">+</span> isnull(name,<span class=\"string\">''</span>)  <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"150px\"&gt;'</span> <span class=\"operator\">+</span>  isnull(col,<span class=\"string\">''</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td&gt;['</span> <span class=\"operator\">+</span> isnull(refObj,<span class=\"string\">'N'</span>) <span class=\"operator\">+</span> <span class=\"string\">'].['</span> <span class=\"operator\">+</span>  isnull(refCol,<span class=\"string\">'N'</span>) <span class=\"operator\">+</span> <span class=\"string\">']&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\">    <span class=\"keyword\">from</span> #FK  <span class=\"keyword\">where</span> id <span class=\"operator\">=</span> <span class=\"variable\">@j</span></span><br><span class=\"line\"></span><br><span class=\"line\">   print <span class=\"variable\">@Output</span></span><br><span class=\"line\">   <span class=\"keyword\">Set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"variable\">@j</span> <span class=\"operator\">+</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\">  print <span class=\"string\">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class=\"line\"> <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">--Default Constraints </span></span><br><span class=\"line\"> <span class=\"keyword\">truncate</span> <span class=\"keyword\">table</span> #<span class=\"keyword\">Constraint</span></span><br><span class=\"line\"> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2000'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #<span class=\"keyword\">Constraint</span>  (Name, col, definition)</span><br><span class=\"line\">  <span class=\"keyword\">select</span> object_name(c.constid), col_name(c.id, c.colid), s.text</span><br><span class=\"line\">    <span class=\"keyword\">from</span> sysconstraints c</span><br><span class=\"line\">     <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> c.id</span><br><span class=\"line\">     <span class=\"keyword\">left</span> <span class=\"keyword\">outer</span> <span class=\"keyword\">join</span> syscomments s <span class=\"keyword\">on</span> s.id <span class=\"operator\">=</span> c.constid</span><br><span class=\"line\">    <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span> </span><br><span class=\"line\">    <span class=\"keyword\">and</span> </span><br><span class=\"line\">    <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,<span class=\"operator\">+</span> (c.status <span class=\"operator\">&amp;</span> <span class=\"number\">1</span>)<span class=\"operator\">/</span><span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">2</span>)<span class=\"operator\">/</span><span class=\"number\">2</span>)</span><br><span class=\"line\">    <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">4</span>)<span class=\"operator\">/</span><span class=\"number\">4</span>)</span><br><span class=\"line\">    <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">8</span>)<span class=\"operator\">/</span><span class=\"number\">8</span>)</span><br><span class=\"line\">    <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">16</span>)<span class=\"operator\">/</span><span class=\"number\">16</span>)</span><br><span class=\"line\">    <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">32</span>)<span class=\"operator\">/</span><span class=\"number\">32</span>)</span><br><span class=\"line\">    <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">64</span>)<span class=\"operator\">/</span><span class=\"number\">64</span>)</span><br><span class=\"line\">    <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">128</span>)<span class=\"operator\">/</span><span class=\"number\">128</span>) <span class=\"operator\">=</span> <span class=\"string\">'10101000'</span></span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"> <span class=\"keyword\">else</span> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2005'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #<span class=\"keyword\">Constraint</span>  (Name, col, definition)</span><br><span class=\"line\">  <span class=\"keyword\">select</span> c.name,  col_name(parent_object_id, parent_column_id), c.definition </span><br><span class=\"line\">  <span class=\"keyword\">from</span> sys.default_constraints c</span><br><span class=\"line\">   <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> c.parent_object_id</span><br><span class=\"line\">  <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span></span><br><span class=\"line\">  <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> c.name</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"> <span class=\"keyword\">Set</span> <span class=\"variable\">@maxj</span> <span class=\"operator\">=</span>   @<span class=\"variable\">@rowcount</span></span><br><span class=\"line\"> <span class=\"keyword\">set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"number\">1</span></span><br><span class=\"line\"> if (<span class=\"variable\">@maxj</span> <span class=\"operator\">&gt;</span><span class=\"number\">0</span>)</span><br><span class=\"line\"> <span class=\"keyword\">begin</span></span><br><span class=\"line\"></span><br><span class=\"line\">  print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Default Constraints&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class=\"line\">  print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"1\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Column&lt;/th&gt;&lt;th&gt;Value&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\"></span><br><span class=\"line\">  While(<span class=\"variable\">@j</span> <span class=\"operator\">&lt;=</span> <span class=\"variable\">@maxj</span>)</span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">select</span> <span class=\"variable\">@Output</span> <span class=\"operator\">=</span> <span class=\"string\">'&lt;tr&gt;&lt;td width=\"20px\" align=\"center\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"built_in\">Cast</span>((<span class=\"variable\">@j</span>) <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"250px\"&gt;'</span> <span class=\"operator\">+</span> isnull(name,<span class=\"string\">''</span>)  <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"150px\"&gt;'</span> <span class=\"operator\">+</span>  isnull(col,<span class=\"string\">''</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td&gt;'</span> <span class=\"operator\">+</span>  isnull(definition,<span class=\"string\">''</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\">    <span class=\"keyword\">from</span> #<span class=\"keyword\">Constraint</span>  <span class=\"keyword\">where</span> id <span class=\"operator\">=</span> <span class=\"variable\">@j</span></span><br><span class=\"line\"></span><br><span class=\"line\">   print <span class=\"variable\">@Output</span></span><br><span class=\"line\">   <span class=\"keyword\">Set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"variable\">@j</span> <span class=\"operator\">+</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"> print <span class=\"string\">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class=\"line\"> <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">--Check  Constraints</span></span><br><span class=\"line\"> <span class=\"keyword\">truncate</span> <span class=\"keyword\">table</span> #<span class=\"keyword\">Constraint</span></span><br><span class=\"line\"> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2000'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #<span class=\"keyword\">Constraint</span>  (Name, col, definition)</span><br><span class=\"line\">   <span class=\"keyword\">select</span> object_name(c.constid), col_name(c.id, c.colid), s.text</span><br><span class=\"line\">    <span class=\"keyword\">from</span> sysconstraints c</span><br><span class=\"line\">     <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> c.id</span><br><span class=\"line\">     <span class=\"keyword\">left</span> <span class=\"keyword\">outer</span> <span class=\"keyword\">join</span> syscomments s <span class=\"keyword\">on</span> s.id <span class=\"operator\">=</span> c.constid</span><br><span class=\"line\">    <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span> </span><br><span class=\"line\">    <span class=\"keyword\">and</span> ( <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,<span class=\"operator\">+</span> (c.status <span class=\"operator\">&amp;</span> <span class=\"number\">1</span>)<span class=\"operator\">/</span><span class=\"number\">1</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">2</span>)<span class=\"operator\">/</span><span class=\"number\">2</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">4</span>)<span class=\"operator\">/</span><span class=\"number\">4</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">8</span>)<span class=\"operator\">/</span><span class=\"number\">8</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">16</span>)<span class=\"operator\">/</span><span class=\"number\">16</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">32</span>)<span class=\"operator\">/</span><span class=\"number\">32</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">64</span>)<span class=\"operator\">/</span><span class=\"number\">64</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">128</span>)<span class=\"operator\">/</span><span class=\"number\">128</span>) <span class=\"operator\">=</span> <span class=\"string\">'00101000'</span> </span><br><span class=\"line\">    <span class=\"keyword\">or</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,<span class=\"operator\">+</span> (c.status <span class=\"operator\">&amp;</span> <span class=\"number\">1</span>)<span class=\"operator\">/</span><span class=\"number\">1</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">2</span>)<span class=\"operator\">/</span><span class=\"number\">2</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">4</span>)<span class=\"operator\">/</span><span class=\"number\">4</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">8</span>)<span class=\"operator\">/</span><span class=\"number\">8</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">16</span>)<span class=\"operator\">/</span><span class=\"number\">16</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">32</span>)<span class=\"operator\">/</span><span class=\"number\">32</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">64</span>)<span class=\"operator\">/</span><span class=\"number\">64</span>)</span><br><span class=\"line\">     <span class=\"operator\">+</span> <span class=\"keyword\">convert</span>(<span class=\"type\">varchar</span>,(c.status <span class=\"operator\">&amp;</span> <span class=\"number\">128</span>)<span class=\"operator\">/</span><span class=\"number\">128</span>) <span class=\"operator\">=</span> <span class=\"string\">'00100100'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"> <span class=\"keyword\">else</span> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2005'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #<span class=\"keyword\">Constraint</span>  (Name, col, definition)</span><br><span class=\"line\">   <span class=\"keyword\">select</span> c.name,  col_name(parent_object_id, parent_column_id), definition </span><br><span class=\"line\">   <span class=\"keyword\">from</span> sys.check_constraints c</span><br><span class=\"line\">    <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> c.parent_object_id</span><br><span class=\"line\">   <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span></span><br><span class=\"line\">   <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> c.name</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"> <span class=\"keyword\">Set</span> <span class=\"variable\">@maxj</span> <span class=\"operator\">=</span>   @<span class=\"variable\">@rowcount</span></span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"keyword\">set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"number\">1</span></span><br><span class=\"line\"> if (<span class=\"variable\">@maxj</span> <span class=\"operator\">&gt;</span><span class=\"number\">0</span>)</span><br><span class=\"line\"> <span class=\"keyword\">begin</span></span><br><span class=\"line\"></span><br><span class=\"line\">  print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Check  Constraints&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class=\"line\">  print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"1\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Column&lt;/th&gt;&lt;th&gt;Definition&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\"></span><br><span class=\"line\">  While(<span class=\"variable\">@j</span> <span class=\"operator\">&lt;=</span> <span class=\"variable\">@maxj</span>)</span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">select</span> <span class=\"variable\">@Output</span> <span class=\"operator\">=</span> <span class=\"string\">'&lt;tr&gt;&lt;td width=\"20px\" align=\"center\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"built_in\">Cast</span>((<span class=\"variable\">@j</span>) <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"250px\"&gt;'</span> <span class=\"operator\">+</span> isnull(name,<span class=\"string\">''</span>)  <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"150px\"&gt;'</span> <span class=\"operator\">+</span>  isnull(col,<span class=\"string\">''</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td&gt;'</span> <span class=\"operator\">+</span>  isnull(definition,<span class=\"string\">''</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\">    <span class=\"keyword\">from</span> #<span class=\"keyword\">Constraint</span>  <span class=\"keyword\">where</span> id <span class=\"operator\">=</span> <span class=\"variable\">@j</span></span><br><span class=\"line\">   print <span class=\"variable\">@Output</span> </span><br><span class=\"line\">   <span class=\"keyword\">Set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"variable\">@j</span> <span class=\"operator\">+</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\">  print <span class=\"string\">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class=\"line\"> <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">--Triggers </span></span><br><span class=\"line\"> <span class=\"keyword\">truncate</span> <span class=\"keyword\">table</span> #<span class=\"keyword\">Constraint</span></span><br><span class=\"line\"> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2000'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #<span class=\"keyword\">Constraint</span>  (Name)</span><br><span class=\"line\">   <span class=\"keyword\">select</span> tr.name</span><br><span class=\"line\">   <span class=\"keyword\">FROM</span> sysobjects tr</span><br><span class=\"line\">    <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> tr.parent_obj</span><br><span class=\"line\">   <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span> <span class=\"keyword\">and</span> tr.type <span class=\"operator\">=</span> <span class=\"string\">'TR'</span></span><br><span class=\"line\">   <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> tr.name</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"> <span class=\"keyword\">else</span> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2005'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #<span class=\"keyword\">Constraint</span>  (Name)</span><br><span class=\"line\">   <span class=\"keyword\">SELECT</span> tr.name</span><br><span class=\"line\">   <span class=\"keyword\">FROM</span> sys.triggers tr</span><br><span class=\"line\">    <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> tr.parent_id</span><br><span class=\"line\">   <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span></span><br><span class=\"line\">   <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> tr.name</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"> <span class=\"keyword\">Set</span> <span class=\"variable\">@maxj</span> <span class=\"operator\">=</span>   @<span class=\"variable\">@rowcount</span></span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"keyword\">set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"number\">1</span></span><br><span class=\"line\"> if (<span class=\"variable\">@maxj</span> <span class=\"operator\">&gt;</span><span class=\"number\">0</span>)</span><br><span class=\"line\"> <span class=\"keyword\">begin</span></span><br><span class=\"line\"></span><br><span class=\"line\">  print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Triggers&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class=\"line\">  print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"1\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\"></span><br><span class=\"line\">  While(<span class=\"variable\">@j</span> <span class=\"operator\">&lt;=</span> <span class=\"variable\">@maxj</span>)</span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">   <span class=\"keyword\">select</span> <span class=\"variable\">@Output</span> <span class=\"operator\">=</span> <span class=\"string\">'&lt;tr&gt;&lt;td width=\"20px\" align=\"center\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"built_in\">Cast</span>((<span class=\"variable\">@j</span>) <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"150px\"&gt;'</span> <span class=\"operator\">+</span> isnull(name,<span class=\"string\">''</span>)  <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\">    <span class=\"keyword\">from</span> #<span class=\"keyword\">Constraint</span>  <span class=\"keyword\">where</span> id <span class=\"operator\">=</span> <span class=\"variable\">@j</span></span><br><span class=\"line\">   print <span class=\"variable\">@Output</span> </span><br><span class=\"line\">   <span class=\"keyword\">Set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"variable\">@j</span> <span class=\"operator\">+</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\">  print <span class=\"string\">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class=\"line\"> <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">--Indexes </span></span><br><span class=\"line\"> <span class=\"keyword\">truncate</span> <span class=\"keyword\">table</span> #Indexes</span><br><span class=\"line\"> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2000'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #Indexes  (Name, type, cols)</span><br><span class=\"line\">   <span class=\"keyword\">select</span> i.name, <span class=\"keyword\">case</span> <span class=\"keyword\">when</span> i.indid <span class=\"operator\">=</span> <span class=\"number\">0</span> <span class=\"keyword\">then</span> <span class=\"string\">'Heap'</span> <span class=\"keyword\">when</span> i.indid <span class=\"operator\">=</span> <span class=\"number\">1</span> <span class=\"keyword\">then</span> <span class=\"string\">'Clustered'</span> <span class=\"keyword\">else</span> <span class=\"string\">'Nonclustered'</span> <span class=\"keyword\">end</span> , c.name </span><br><span class=\"line\">   <span class=\"keyword\">from</span> sysindexes i</span><br><span class=\"line\">    <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> sysindexkeys k  <span class=\"keyword\">on</span> k.indid <span class=\"operator\">=</span> i.indid  <span class=\"keyword\">and</span> k.id <span class=\"operator\">=</span> i.id</span><br><span class=\"line\">    <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> syscolumns c <span class=\"keyword\">on</span> c.id <span class=\"operator\">=</span> k.id <span class=\"keyword\">and</span> c.colorder <span class=\"operator\">=</span> k.colid</span><br><span class=\"line\">    <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> i.id</span><br><span class=\"line\">   <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span> <span class=\"keyword\">and</span> i.name <span class=\"keyword\">not</span> <span class=\"keyword\">like</span> <span class=\"string\">'_WA%'</span></span><br><span class=\"line\">   <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> i.name, i.keycnt</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"> <span class=\"keyword\">else</span> if <span class=\"variable\">@SqlVersion</span> <span class=\"operator\">=</span> <span class=\"string\">'2005'</span> </span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">  <span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> #Indexes  (Name, type, cols)</span><br><span class=\"line\">   <span class=\"keyword\">select</span> i.name, <span class=\"keyword\">case</span> <span class=\"keyword\">when</span> i.type <span class=\"operator\">=</span> <span class=\"number\">0</span> <span class=\"keyword\">then</span> <span class=\"string\">'Heap'</span> <span class=\"keyword\">when</span> i.type <span class=\"operator\">=</span> <span class=\"number\">1</span> <span class=\"keyword\">then</span> <span class=\"string\">'Clustered'</span> <span class=\"keyword\">else</span> <span class=\"string\">'Nonclustered'</span> <span class=\"keyword\">end</span>,  col_name(i.object_id, c.column_id)</span><br><span class=\"line\">    <span class=\"keyword\">from</span> sys.indexes i </span><br><span class=\"line\">     <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> sys.index_columns c <span class=\"keyword\">on</span> i.index_id <span class=\"operator\">=</span> c.index_id <span class=\"keyword\">and</span> c.object_id <span class=\"operator\">=</span> i.object_id </span><br><span class=\"line\">     <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> #Tables t <span class=\"keyword\">on</span> t.object_id <span class=\"operator\">=</span> i.object_id</span><br><span class=\"line\">    <span class=\"keyword\">where</span> t.id <span class=\"operator\">=</span> <span class=\"variable\">@i</span></span><br><span class=\"line\">    <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> i.name, c.column_id</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">Set</span> <span class=\"variable\">@maxj</span> <span class=\"operator\">=</span>   @<span class=\"variable\">@rowcount</span></span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"keyword\">set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"number\">1</span></span><br><span class=\"line\"> <span class=\"keyword\">set</span> <span class=\"variable\">@sr</span> <span class=\"operator\">=</span> <span class=\"number\">1</span></span><br><span class=\"line\"> if (<span class=\"variable\">@maxj</span> <span class=\"operator\">&gt;</span><span class=\"number\">0</span>)</span><br><span class=\"line\"> <span class=\"keyword\">begin</span></span><br><span class=\"line\"></span><br><span class=\"line\">  print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Indexes&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class=\"line\">  print <span class=\"string\">'&lt;table border=\"0\" cellspacing=\"1\" cellpadding=\"0\" width=\"750px\"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Type&lt;/th&gt;&lt;th&gt;Columns&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\">  <span class=\"keyword\">set</span> <span class=\"variable\">@Output</span> <span class=\"operator\">=</span> <span class=\"string\">''</span></span><br><span class=\"line\">  <span class=\"keyword\">set</span> <span class=\"variable\">@last</span> <span class=\"operator\">=</span> <span class=\"string\">''</span></span><br><span class=\"line\">  <span class=\"keyword\">set</span> <span class=\"variable\">@current</span> <span class=\"operator\">=</span> <span class=\"string\">''</span></span><br><span class=\"line\">  While(<span class=\"variable\">@j</span> <span class=\"operator\">&lt;=</span> <span class=\"variable\">@maxj</span>)</span><br><span class=\"line\">  <span class=\"keyword\">begin</span></span><br><span class=\"line\">   <span class=\"keyword\">select</span> <span class=\"variable\">@current</span> <span class=\"operator\">=</span> isnull(name,<span class=\"string\">''</span>) <span class=\"keyword\">from</span> #Indexes  <span class=\"keyword\">where</span> id <span class=\"operator\">=</span> <span class=\"variable\">@j</span></span><br><span class=\"line\">      </span><br><span class=\"line\">   if <span class=\"variable\">@last</span> <span class=\"operator\">&lt;&gt;</span> <span class=\"variable\">@current</span>  <span class=\"keyword\">and</span> <span class=\"variable\">@last</span> <span class=\"operator\">&lt;&gt;</span> <span class=\"string\">''</span></span><br><span class=\"line\">    <span class=\"keyword\">begin</span> </span><br><span class=\"line\">    print <span class=\"string\">'&lt;tr&gt;&lt;td width=\"20px\" align=\"center\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"built_in\">Cast</span>((<span class=\"variable\">@sr</span>) <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"150px\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"variable\">@last</span> <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"150px\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"variable\">@typ</span> <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td&gt;'</span> <span class=\"operator\">+</span> <span class=\"variable\">@Output</span>  <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\">    <span class=\"keyword\">set</span> <span class=\"variable\">@Output</span>  <span class=\"operator\">=</span> <span class=\"string\">''</span></span><br><span class=\"line\">    <span class=\"keyword\">set</span> <span class=\"variable\">@sr</span> <span class=\"operator\">=</span> <span class=\"variable\">@sr</span> <span class=\"operator\">+</span> <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\">   </span><br><span class=\"line\">    </span><br><span class=\"line\">   <span class=\"keyword\">select</span> <span class=\"variable\">@Output</span> <span class=\"operator\">=</span> <span class=\"variable\">@Output</span> <span class=\"operator\">+</span> cols <span class=\"operator\">+</span> <span class=\"string\">'&lt;br /&gt;'</span> , <span class=\"variable\">@typ</span> <span class=\"operator\">=</span> type</span><br><span class=\"line\">     <span class=\"keyword\">from</span> #Indexes  <span class=\"keyword\">where</span> id <span class=\"operator\">=</span> <span class=\"variable\">@j</span></span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"keyword\">set</span> <span class=\"variable\">@last</span> <span class=\"operator\">=</span> <span class=\"variable\">@current</span>  </span><br><span class=\"line\">   <span class=\"keyword\">Set</span> <span class=\"variable\">@j</span> <span class=\"operator\">=</span> <span class=\"variable\">@j</span> <span class=\"operator\">+</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">  <span class=\"keyword\">end</span></span><br><span class=\"line\">  if <span class=\"variable\">@Output</span> <span class=\"operator\">&lt;&gt;</span> <span class=\"string\">''</span></span><br><span class=\"line\">    <span class=\"keyword\">begin</span> </span><br><span class=\"line\">    print <span class=\"string\">'&lt;tr&gt;&lt;td width=\"20px\" align=\"center\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"built_in\">Cast</span>((<span class=\"variable\">@sr</span>) <span class=\"keyword\">as</span> <span class=\"type\">varchar</span>) <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"150px\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"variable\">@last</span> <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td width=\"150px\"&gt;'</span> <span class=\"operator\">+</span> <span class=\"variable\">@typ</span> <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;td&gt;'</span> <span class=\"operator\">+</span> <span class=\"variable\">@Output</span>  <span class=\"operator\">+</span> <span class=\"string\">'&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\">  print <span class=\"string\">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class=\"line\"> <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">Set</span> <span class=\"variable\">@i</span> <span class=\"operator\">=</span> <span class=\"variable\">@i</span> <span class=\"operator\">+</span> <span class=\"number\">1</span>;</span><br><span class=\"line\"> <span class=\"comment\">--Print @Output </span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Print <span class=\"string\">'&lt;/body&gt;'</span></span><br><span class=\"line\">Print <span class=\"string\">'&lt;/html&gt;'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">drop</span> <span class=\"keyword\">table</span> #Tables</span><br><span class=\"line\"><span class=\"keyword\">drop</span> <span class=\"keyword\">table</span> #Columns</span><br><span class=\"line\"><span class=\"keyword\">drop</span> <span class=\"keyword\">table</span> #FK</span><br><span class=\"line\"><span class=\"keyword\">drop</span> <span class=\"keyword\">table</span> #<span class=\"keyword\">Constraint</span></span><br><span class=\"line\"><span class=\"keyword\">drop</span> <span class=\"keyword\">table</span> #Indexes </span><br><span class=\"line\"><span class=\"keyword\">set</span> nocount off</span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"GenSchemaDocToHtml-bat\"><a href=\"#GenSchemaDocToHtml-bat\" class=\"headerlink\" title=\"GenSchemaDocToHtml.bat\"></a>GenSchemaDocToHtml.bat</h2><figure class=\"highlight sql\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">@echo</span> off</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">set</span> exeSqlPath<span class=\"operator\">=</span>C:\\GenDBSchemaToHtml.sql</span><br><span class=\"line\"><span class=\"keyword\">set</span> outputPath<span class=\"operator\">=</span>C:\\inetpub\\wwwroot\\DBSchema.html</span><br><span class=\"line\"></span><br><span class=\"line\">echo Generate DB Schema <span class=\"keyword\">to</span> File...Execute<span class=\"operator\">!</span></span><br><span class=\"line\">sqlcmd <span class=\"operator\">-</span>S [伺服器名稱] <span class=\"operator\">-</span>U [帳號] <span class=\"operator\">-</span>P [密碼] <span class=\"operator\">-</span>d [資料庫名稱] <span class=\"operator\">-</span>i <span class=\"operator\">%</span>exeSqlPath<span class=\"operator\">%</span> <span class=\"operator\">-</span>o <span class=\"operator\">%</span>outputPath<span class=\"operator\">%</span></span><br><span class=\"line\">echo Generate DB Schema <span class=\"keyword\">to</span> File...Done<span class=\"operator\">!</span></span><br></pre></td></tr></tbody></table></figure>\n","categories":["Sql"],"tags":["Windows","Mssql","html","Batch"]},{"title":"使用 cli 部署 dotnet 站台","url":"/posts/724330086/","content":"<p>使用 cli 實現主機端自動更新 git 並發布 dotnet 站台的腳本</p>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> <span class=\"string\">\"D:\\\\Workspace\\\\FutureVision\"</span></span><br><span class=\"line\">git pull</span><br><span class=\"line\">iisreset /stop</span><br><span class=\"line\">dotnet publish <span class=\"string\">\"D:\\\\Workspace\\\\FutureVision\\\\FutureVision\"</span> -c Release -o <span class=\"string\">\"D:\\\\wwwroot\\\\FutureVision\"</span></span><br><span class=\"line\">iisreset /start</span><br></pre></td></tr></tbody></table></figure>\n","categories":["Others"],"tags":["Git","C#","Cmd","IIS"]}]