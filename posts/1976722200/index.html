<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#005757"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#005757">
  <meta name="google-site-verification" content="zVSXvgtzskGLDQEvlohYf3gAR6PuzUnGi082x4qUwQg">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.css" integrity="sha256-6cQIC71/iBIYXFK+0RHAvwmjwWzkWd+r7v/BX3/vZDc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/green/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"kuoann.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.19.1","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":"default","style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":{"gitalk":{"text":"Gittalk","order":1},"disqus":{"text":"Disqus","order":2}},"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":false,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="將資料庫結構轉 Html 的語法 搭配 bat 檔可排入排程自動更新">
<meta property="og:type" content="article">
<meta property="og:title" content="自動線上文件 - Mssql Schema to Html">
<meta property="og:url" content="https://kuoann.github.io/posts/1976722200/index.html">
<meta property="og:site_name" content="郭安安的筆記碎片">
<meta property="og:description" content="將資料庫結構轉 Html 的語法 搭配 bat 檔可排入排程自動更新">
<meta property="og:locale" content="zh_TW">
<meta property="article:published_time" content="2023-03-31T22:09:50.000Z">
<meta property="article:modified_time" content="2023-12-23T16:06:01.007Z">
<meta property="article:author" content="KuoAnn">
<meta property="article:tag" content="Windows">
<meta property="article:tag" content="Mssql">
<meta property="article:tag" content="html">
<meta property="article:tag" content="Batch">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://kuoann.github.io/posts/1976722200/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-TW","comments":true,"permalink":"https://kuoann.github.io/posts/1976722200/","path":"posts/1976722200/","title":"自動線上文件 - Mssql Schema to Html"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>自動線上文件 - Mssql Schema to Html | 郭安安的筆記碎片</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JR8M77W066"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-JR8M77W066","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="郭安安的筆記碎片" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">郭安安的筆記碎片</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">因為是碎片所以看不懂很正常</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜尋" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類<span class="badge">6</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤<span class="badge">30</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔<span class="badge">17</span></a></li><li class="menu-item menu-item-rss"><a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>RSS</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#GenDBSchemaToHtml-sql"><span class="nav-text">GenDBSchemaToHtml.sql</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GenSchemaDocToHtml-bat"><span class="nav-text">GenSchemaDocToHtml.bat</span></a></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">KuoAnn</p>
  <div class="site-description" itemprop="description">Coding 就是複製貼上改一下</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">30</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2t1b2Fubg==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kuoann"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOmI1NDc0NDA0MEBnbWFpbC5jb20=" title="E-Mail → mailto:b54744040@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
  </div>

<div class="links-of-blogroll motion-element links-of-blogroll-block">
<div class="links-of-blogroll-title">
    <!-- 設定你要的fa fa icon-->
    <i class="fa fa-history fa-" aria-hidden="true"></i>
    最新文章
</div>
<ul class="links-of-blogroll-list">
    
    
    <li>
        <a href="/posts/3327344738/" title="AI 通識" target="_blank">AI 通識</a>
    </li>
    
    <li>
        <a href="/posts/582090662/" title="Github copilot" target="_blank">Github copilot</a>
    </li>
    
    <li>
        <a href="/posts/3949037657/" title="Change Git Upstream to Origin" target="_blank">Change Git Upstream to Origin</a>
    </li>
    
    <li>
        <a href="/posts/3263803727/" title="OpenAI API in Javascript" target="_blank">OpenAI API in Javascript</a>
    </li>
    
    <li>
        <a href="/posts/1661076175/" title="NPOI 自適應欄寬" target="_blank">NPOI 自適應欄寬</a>
    </li>
    
</ul>
</div>

        </div>
      </div>
    </div>

    
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kuoann.github.io/posts/1976722200/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KuoAnn">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="郭安安的筆記碎片">
      <meta itemprop="description" content="Coding 就是複製貼上改一下">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="自動線上文件 - Mssql Schema to Html | 郭安安的筆記碎片">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          自動線上文件 - Mssql Schema to Html<span class="exturl post-edit-link" data-url="aHR0cHM6Ly9naXRodWIuY29tL0t1b0Fubi9rdW9hbm4uZ2l0aHViLmlvL2VkaXQvbWFpbi9zb3VyY2UvX3Bvc3RzL+iHquWLlee3muS4iuaWh+S7tiAtIE1zc3FsIFNjaGVtYSB0byBIdG1sLm1k" title="編輯"><i class="fa fa-pen-nib"></i></span>
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2023-04-01 06:09:50" itemprop="dateCreated datePublished" datetime="2023-04-01T06:09:50+08:00">2023-04-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2023-12-24 00:06:01" itemprop="dateModified" datetime="2023-12-24T00:06:01+08:00">2023-12-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Sql/" itemprop="url" rel="index"><span itemprop="name">Sql</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/posts/1976722200/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="posts/1976722200/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><ul>
<li>將資料庫結構轉 Html 的語法</li>
<li>搭配 bat 檔可排入排程自動更新</li>
</ul>
<span id="more"></span>

<h3 id="GenDBSchemaToHtml-sql"><a href="#GenDBSchemaToHtml-sql" class="headerlink" title="GenDBSchemaToHtml.sql"></a>GenDBSchemaToHtml.sql</h3><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">--//SQL Database documentation script</span></span><br><span class="line"><span class="keyword">SET</span> FMTONLY <span class="keyword">ON</span></span><br><span class="line">use KOKON</span><br><span class="line"><span class="keyword">SET</span> FMTONLY OFF</span><br><span class="line"></span><br><span class="line"><span class="keyword">Declare</span> <span class="variable">@i</span> <span class="type">Int</span>, <span class="variable">@maxi</span> <span class="type">Int</span></span><br><span class="line"><span class="keyword">Declare</span> <span class="variable">@j</span> <span class="type">Int</span>, <span class="variable">@maxj</span> <span class="type">Int</span></span><br><span class="line"><span class="keyword">Declare</span> <span class="variable">@sr</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">Declare</span> <span class="variable">@Output</span> <span class="type">varchar</span>(<span class="number">4000</span>)</span><br><span class="line"><span class="comment">--Declare @tmpOutput varchar(max)</span></span><br><span class="line"><span class="keyword">Declare</span> <span class="variable">@SqlVersion</span> <span class="type">varchar</span>(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">Declare</span> <span class="variable">@last</span> <span class="type">varchar</span>(<span class="number">155</span>), <span class="variable">@current</span> <span class="type">varchar</span>(<span class="number">255</span>), <span class="variable">@typ</span> <span class="type">varchar</span>(<span class="number">255</span>), <span class="variable">@description</span> <span class="type">varchar</span>(<span class="number">4000</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">Table</span> #Tables  (id <span class="type">int</span> <span class="keyword">identity</span>(<span class="number">1</span>, <span class="number">1</span>), Object_id <span class="type">int</span>, Name <span class="type">varchar</span>(<span class="number">155</span>), Type <span class="type">varchar</span>(<span class="number">20</span>), [description] <span class="type">varchar</span>(<span class="number">4000</span>))</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">Table</span> #Columns (id <span class="type">int</span> <span class="keyword">identity</span>(<span class="number">1</span>,<span class="number">1</span>), Name <span class="type">varchar</span>(<span class="number">155</span>), Type <span class="type">Varchar</span>(<span class="number">155</span>), Nullable <span class="type">varchar</span>(<span class="number">2</span>), [description] <span class="type">varchar</span>(<span class="number">4000</span>))</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">Table</span> #Fk(id <span class="type">int</span> <span class="keyword">identity</span>(<span class="number">1</span>,<span class="number">1</span>), Name <span class="type">varchar</span>(<span class="number">155</span>), col <span class="type">Varchar</span>(<span class="number">155</span>), refObj <span class="type">varchar</span>(<span class="number">155</span>), refCol <span class="type">varchar</span>(<span class="number">155</span>))</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">Table</span> #<span class="keyword">Constraint</span>(id <span class="type">int</span> <span class="keyword">identity</span>(<span class="number">1</span>,<span class="number">1</span>), Name <span class="type">varchar</span>(<span class="number">155</span>), col <span class="type">Varchar</span>(<span class="number">155</span>), definition <span class="type">varchar</span>(<span class="number">1000</span>))</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">Table</span> #Indexes(id <span class="type">int</span> <span class="keyword">identity</span>(<span class="number">1</span>,<span class="number">1</span>), Name <span class="type">varchar</span>(<span class="number">155</span>), Type <span class="type">Varchar</span>(<span class="number">25</span>), cols <span class="type">varchar</span>(<span class="number">1000</span>))</span><br><span class="line"></span><br><span class="line"> If (<span class="built_in">substring</span>(@<span class="variable">@VERSION</span>, <span class="number">1</span>, <span class="number">25</span> ) <span class="operator">=</span> <span class="string">'Microsoft SQL Server 2005'</span>)</span><br><span class="line"> <span class="keyword">set</span> <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2005'</span></span><br><span class="line"><span class="keyword">else</span> if (<span class="built_in">substring</span>(@<span class="variable">@VERSION</span>, <span class="number">1</span>, <span class="number">26</span> ) <span class="operator">=</span> <span class="string">'Microsoft SQL Server  2000'</span>)</span><br><span class="line"> <span class="keyword">set</span> <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2000'</span></span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line"> <span class="keyword">set</span> <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2005'</span></span><br><span class="line"> </span><br><span class="line">Print <span class="string">'&lt;html&gt;'</span></span><br><span class="line">Print <span class="string">'&lt;head&gt;'</span></span><br><span class="line">Print <span class="string">'&lt;meta charset="Big5"&gt;'</span></span><br><span class="line">Print <span class="string">'&lt;title&gt;::'</span> <span class="operator">+</span> DB_name() <span class="operator">+</span> <span class="string">'::&lt;/title&gt;'</span></span><br><span class="line">Print <span class="string">'&lt;style&gt;'</span></span><br><span class="line">    </span><br><span class="line">Print <span class="string">'  body {'</span></span><br><span class="line">Print <span class="string">'   font-family:verdana;'</span></span><br><span class="line">Print <span class="string">'   font-size:16pt;'</span></span><br><span class="line">Print <span class="string">'  }'</span></span><br><span class="line">  </span><br><span class="line">Print <span class="string">'  td {'</span></span><br><span class="line">Print <span class="string">'   font-family:verdana;'</span></span><br><span class="line">Print <span class="string">'  }'</span></span><br><span class="line">  </span><br><span class="line">Print <span class="string">'  th {'</span></span><br><span class="line">Print <span class="string">'   font-family:verdana;'</span></span><br><span class="line">Print <span class="string">'   background:#d3d3d3;'</span></span><br><span class="line">Print <span class="string">'  }'</span></span><br><span class="line">Print <span class="string">'  table'</span></span><br><span class="line">Print <span class="string">'  {'</span></span><br><span class="line">Print <span class="string">'   background:#d3d3d3;'</span></span><br><span class="line">Print <span class="string">'  }'</span></span><br><span class="line">Print <span class="string">'  tr'</span></span><br><span class="line">Print <span class="string">'  {'</span></span><br><span class="line">Print <span class="string">'   background:#ffffff;'</span></span><br><span class="line">Print <span class="string">'  }'</span></span><br><span class="line">Print <span class="string">'  pre'</span></span><br><span class="line">Print <span class="string">'  {'</span></span><br><span class="line">Print <span class="string">'   font-size:16px;'</span></span><br><span class="line">Print <span class="string">'  }'</span></span><br><span class="line">Print <span class="string">' &lt;/style&gt;'</span></span><br><span class="line">Print <span class="string">'&lt;/head&gt;'</span></span><br><span class="line">Print <span class="string">'&lt;body&gt;'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> nocount <span class="keyword">on</span></span><br><span class="line"> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2000'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #Tables (Object_id, Name, Type, [description])</span><br><span class="line">   <span class="comment">--FOR 2000</span></span><br><span class="line">   <span class="keyword">select</span> object_id(table_name),  <span class="string">'['</span> <span class="operator">+</span> table_schema <span class="operator">+</span> <span class="string">'].['</span> <span class="operator">+</span> table_name <span class="operator">+</span> <span class="string">']'</span>,  </span><br><span class="line">   <span class="keyword">case</span> <span class="keyword">when</span> table_type <span class="operator">=</span> <span class="string">'BASE TABLE'</span>  <span class="keyword">then</span> <span class="string">'Table'</span>   <span class="keyword">else</span> <span class="string">'View'</span> <span class="keyword">end</span>,</span><br><span class="line">   <span class="built_in">cast</span>(p.value <span class="keyword">as</span> <span class="type">varchar</span>(<span class="number">4000</span>))</span><br><span class="line">   <span class="keyword">from</span> information_schema.tables t</span><br><span class="line">   <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> sysproperties p <span class="keyword">on</span> p.id <span class="operator">=</span> object_id(t.table_name) <span class="keyword">and</span> smallid <span class="operator">=</span> <span class="number">0</span> <span class="keyword">and</span> p.name <span class="operator">=</span> <span class="string">'MS_Description'</span> </span><br><span class="line">   <span class="keyword">order</span> <span class="keyword">by</span> table_type, table_schema, table_name</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">else</span> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2005'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #Tables (Object_id, Name, Type, [description])</span><br><span class="line">  <span class="comment">--FOR 2005</span></span><br><span class="line">  <span class="keyword">Select</span> o.object_id,  <span class="string">'['</span> <span class="operator">+</span> s.name <span class="operator">+</span> <span class="string">'].['</span> <span class="operator">+</span> o.name <span class="operator">+</span> <span class="string">']'</span>, </span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">when</span> type <span class="operator">=</span> <span class="string">'V'</span> <span class="keyword">then</span> <span class="string">'View'</span> <span class="keyword">when</span> type <span class="operator">=</span> <span class="string">'U'</span> <span class="keyword">then</span> <span class="string">'Table'</span> <span class="keyword">end</span>,  </span><br><span class="line">    <span class="built_in">cast</span>(p.value <span class="keyword">as</span> <span class="type">varchar</span>(<span class="number">4000</span>))</span><br><span class="line">    <span class="keyword">from</span> sys.objects o </span><br><span class="line">     <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> sys.schemas s <span class="keyword">on</span> s.schema_id <span class="operator">=</span> o.schema_id </span><br><span class="line">     <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> sys.extended_properties p <span class="keyword">on</span> p.major_id <span class="operator">=</span> o.object_id <span class="keyword">and</span> minor_id <span class="operator">=</span> <span class="number">0</span> <span class="keyword">and</span> p.name <span class="operator">=</span> <span class="string">'MS_Description'</span> </span><br><span class="line">    <span class="keyword">where</span> type <span class="keyword">in</span> (<span class="string">'U'</span>, <span class="string">'V'</span>) </span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> type, s.name, o.name</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">Set</span> <span class="variable">@maxi</span> <span class="operator">=</span> @<span class="variable">@rowcount</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@i</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">print <span class="string">'&lt;table border="0" cellspacing="0" cellpadding="0" width="550px" align="center"&gt;&lt;tr&gt;&lt;td colspan="3" style="height:50;font-size:14pt;text-align:center;"&gt;&lt;a name="index"&gt;&lt;/a&gt;&lt;b&gt;Index&lt;/b&gt;&lt;div&gt;更新日期：'</span><span class="operator">+</span><span class="keyword">convert</span>(<span class="type">varchar</span>, getdate(), <span class="number">120</span>)<span class="operator">+</span><span class="string">'&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span></span><br><span class="line">print <span class="string">'&lt;table border="0" cellspacing="1" cellpadding="0" width="550px" align="center"&gt;&lt;tr&gt;&lt;th&gt;Sr&lt;/th&gt;&lt;th&gt;Object&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;th&gt;Type&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class="line">While(<span class="variable">@i</span> <span class="operator">&lt;=</span> <span class="variable">@maxi</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">select</span> <span class="variable">@Output</span> <span class="operator">=</span>  <span class="string">'&lt;tr&gt;&lt;td align="center"&gt;'</span> <span class="operator">+</span> <span class="built_in">Cast</span>((<span class="variable">@i</span>) <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td&gt;&lt;a href="#'</span> <span class="operator">+</span> Type <span class="operator">+</span> <span class="string">':'</span> <span class="operator">+</span> name <span class="operator">+</span> <span class="string">'"&gt;'</span> <span class="operator">+</span> name <span class="operator">+</span> <span class="string">'&lt;/a&gt;&lt;/td&gt;&lt;td&gt;'</span> <span class="operator">+</span> isnull([description], <span class="string">''</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td&gt;'</span> <span class="operator">+</span> Type <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class="line">   <span class="keyword">from</span> #Tables <span class="keyword">where</span> id <span class="operator">=</span> <span class="variable">@i</span></span><br><span class="line"> </span><br><span class="line"> print <span class="variable">@Output</span></span><br><span class="line"> <span class="keyword">set</span> <span class="variable">@i</span> <span class="operator">=</span> <span class="variable">@i</span> <span class="operator">+</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">print <span class="string">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@i</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">While(<span class="variable">@i</span> <span class="operator">&lt;=</span> <span class="variable">@maxi</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> <span class="comment">--table header</span></span><br><span class="line"> <span class="keyword">select</span> <span class="variable">@Output</span> <span class="operator">=</span>  <span class="string">'&lt;tr&gt;&lt;th align="left"&gt;&lt;a name="'</span> <span class="operator">+</span> Type <span class="operator">+</span> <span class="string">':'</span> <span class="operator">+</span> name <span class="operator">+</span> <span class="string">'"&gt;&lt;/a&gt;&lt;b&gt;'</span> <span class="operator">+</span> Type <span class="operator">+</span> <span class="string">':'</span> <span class="operator">+</span> name <span class="operator">+</span> <span class="string">'&lt;/b&gt;&lt;/th&gt;&lt;/tr&gt;'</span>,  <span class="variable">@description</span> <span class="operator">=</span> [description]</span><br><span class="line">   <span class="keyword">from</span> #Tables <span class="keyword">where</span> id <span class="operator">=</span> <span class="variable">@i</span></span><br><span class="line"> </span><br><span class="line"> print <span class="string">'&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;table border="0" cellspacing="0" cellpadding="0" width="1200px"&gt;&lt;tr&gt;&lt;td align="right"&gt;&lt;a href="#index"&gt;Index&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;'</span></span><br><span class="line"> print <span class="variable">@Output</span></span><br><span class="line"> print <span class="string">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class="line"> print <span class="string">'&lt;table border="0" cellspacing="0" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Description&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;'</span> <span class="operator">+</span> isnull(<span class="variable">@description</span>, <span class="string">''</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br /&gt;'</span> </span><br><span class="line"></span><br><span class="line"> <span class="comment">--table columns</span></span><br><span class="line"> <span class="keyword">truncate</span> <span class="keyword">table</span> #Columns </span><br><span class="line"> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2000'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #Columns  (Name, Type, Nullable, [description])</span><br><span class="line">  <span class="comment">--FOR 2000</span></span><br><span class="line">  <span class="keyword">Select</span> c.name, </span><br><span class="line">     type_name(xtype) <span class="operator">+</span> (</span><br><span class="line">     <span class="keyword">case</span> <span class="keyword">when</span> (type_name(xtype) <span class="operator">=</span> <span class="string">'varchar'</span> <span class="keyword">or</span> type_name(xtype) <span class="operator">=</span> <span class="string">'nvarchar'</span> <span class="keyword">or</span> type_name(xtype) <span class="operator">=</span><span class="string">'char'</span> <span class="keyword">or</span> type_name(xtype) <span class="operator">=</span><span class="string">'nchar'</span>)</span><br><span class="line">      <span class="keyword">then</span> <span class="string">'('</span> <span class="operator">+</span> <span class="built_in">cast</span>(length <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">')'</span> </span><br><span class="line">      <span class="keyword">when</span> type_name(xtype) <span class="operator">=</span> <span class="string">'decimal'</span>  </span><br><span class="line">       <span class="keyword">then</span> <span class="string">'('</span> <span class="operator">+</span> <span class="built_in">cast</span>(prec <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">','</span> <span class="operator">+</span> <span class="built_in">cast</span>(scale <span class="keyword">as</span> <span class="type">varchar</span>)   <span class="operator">+</span> <span class="string">')'</span> </span><br><span class="line">     <span class="keyword">else</span> <span class="string">''</span></span><br><span class="line">     <span class="keyword">end</span>    </span><br><span class="line">     ), </span><br><span class="line">     <span class="keyword">case</span> <span class="keyword">when</span> isnullable <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span> <span class="string">'Y'</span> <span class="keyword">else</span> <span class="string">'N'</span>  <span class="keyword">end</span>, </span><br><span class="line">     <span class="built_in">cast</span>(p.value <span class="keyword">as</span> <span class="type">varchar</span>(<span class="number">8000</span>))</span><br><span class="line">    <span class="keyword">from</span> syscolumns c</span><br><span class="line">     <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> c.id</span><br><span class="line">     <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> sysproperties p <span class="keyword">on</span> p.id <span class="operator">=</span> c.id <span class="keyword">and</span> p.smallid <span class="operator">=</span> c.colid <span class="keyword">and</span> p.name <span class="operator">=</span> <span class="string">'MS_Description'</span> </span><br><span class="line">    <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span></span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> c.colorder</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">else</span> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2005'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #Columns  (Name, Type, Nullable, [description])</span><br><span class="line">  <span class="comment">--FOR 2005 </span></span><br><span class="line">  <span class="keyword">Select</span> c.name, </span><br><span class="line">     type_name(user_type_id) <span class="operator">+</span> (</span><br><span class="line">     <span class="keyword">case</span> <span class="keyword">when</span> (type_name(user_type_id) <span class="operator">=</span> <span class="string">'varchar'</span> <span class="keyword">or</span> type_name(user_type_id) <span class="operator">=</span> <span class="string">'nvarchar'</span> <span class="keyword">or</span> type_name(user_type_id) <span class="operator">=</span><span class="string">'char'</span> <span class="keyword">or</span> type_name(user_type_id) <span class="operator">=</span><span class="string">'nchar'</span>)</span><br><span class="line">      <span class="keyword">then</span> <span class="string">'('</span> <span class="operator">+</span> <span class="built_in">cast</span>(max_length <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">')'</span> </span><br><span class="line">      <span class="keyword">when</span> type_name(user_type_id) <span class="operator">=</span> <span class="string">'decimal'</span>  </span><br><span class="line">       <span class="keyword">then</span> <span class="string">'('</span> <span class="operator">+</span> <span class="built_in">cast</span>([<span class="keyword">precision</span>] <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">','</span> <span class="operator">+</span> <span class="built_in">cast</span>(scale <span class="keyword">as</span> <span class="type">varchar</span>)   <span class="operator">+</span> <span class="string">')'</span> </span><br><span class="line">     <span class="keyword">else</span> <span class="string">''</span></span><br><span class="line">     <span class="keyword">end</span>    </span><br><span class="line">     ), </span><br><span class="line">     <span class="keyword">case</span> <span class="keyword">when</span> is_nullable <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span> <span class="string">'Y'</span> <span class="keyword">else</span> <span class="string">'N'</span>  <span class="keyword">end</span>,</span><br><span class="line">     <span class="built_in">cast</span>(p.value <span class="keyword">as</span> <span class="type">varchar</span>(<span class="number">4000</span>))</span><br><span class="line">  <span class="keyword">from</span> sys.columns c</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> c.object_id</span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> sys.extended_properties p <span class="keyword">on</span> p.major_id <span class="operator">=</span> c.object_id <span class="keyword">and</span> p.minor_id  <span class="operator">=</span> c.column_id <span class="keyword">and</span> p.name <span class="operator">=</span> <span class="string">'MS_Description'</span> </span><br><span class="line">  <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span></span><br><span class="line">  <span class="keyword">order</span> <span class="keyword">by</span> c.column_id</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">Set</span> <span class="variable">@maxj</span> <span class="operator">=</span>   @<span class="variable">@rowcount</span></span><br><span class="line"> <span class="keyword">set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"> print <span class="string">'&lt;table border="0" cellspacing="0" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Table Columns&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class="line"> print <span class="string">'&lt;table border="0" cellspacing="1" cellpadding="0" width="1200px"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Datatype&lt;/th&gt;&lt;th&gt;Nullable&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class="line"> </span><br><span class="line"> While(<span class="variable">@j</span> <span class="operator">&lt;=</span> <span class="variable">@maxj</span>)</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">select</span> <span class="variable">@Output</span> <span class="operator">=</span> <span class="string">'&lt;tr&gt;&lt;td width="20px" align="center"&gt;'</span> <span class="operator">+</span> <span class="built_in">Cast</span>((<span class="variable">@j</span>) <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="150px"&gt;'</span> <span class="operator">+</span> isnull(name,<span class="string">''</span>)  <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="150px"&gt;'</span> <span class="operator">+</span>  <span class="built_in">upper</span>(isnull(Type,<span class="string">''</span>)) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="50px" align="center"&gt;'</span> <span class="operator">+</span> isnull(Nullable,<span class="string">'N'</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td&gt;&lt;pre&gt;'</span> <span class="operator">+</span> isnull([description],<span class="string">''</span>) <span class="operator">+</span> <span class="string">'&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class="line">   <span class="keyword">from</span> #Columns  <span class="keyword">where</span> id <span class="operator">=</span> <span class="variable">@j</span></span><br><span class="line">  </span><br><span class="line">  print  <span class="variable">@Output</span>  </span><br><span class="line">  <span class="keyword">Set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="variable">@j</span> <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line"> <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"> print <span class="string">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">--reference key</span></span><br><span class="line"> <span class="keyword">truncate</span> <span class="keyword">table</span> #FK</span><br><span class="line"> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2000'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #FK  (Name, col, refObj, refCol)</span><br><span class="line"> <span class="comment">--  FOR 2000</span></span><br><span class="line">  <span class="keyword">select</span> object_name(constid), s.name,  object_name(rkeyid) ,  s1.name  </span><br><span class="line">    <span class="keyword">from</span> sysforeignkeys f</span><br><span class="line">     <span class="keyword">inner</span> <span class="keyword">join</span> sysobjects o <span class="keyword">on</span> o.id <span class="operator">=</span> f.constid</span><br><span class="line">     <span class="keyword">inner</span> <span class="keyword">join</span> syscolumns s <span class="keyword">on</span> s.id <span class="operator">=</span> f.fkeyid <span class="keyword">and</span> s.colorder <span class="operator">=</span> f.fkey</span><br><span class="line">     <span class="keyword">inner</span> <span class="keyword">join</span> syscolumns s1 <span class="keyword">on</span> s1.id <span class="operator">=</span> f.rkeyid <span class="keyword">and</span> s1.colorder <span class="operator">=</span> f.rkey</span><br><span class="line">     <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> f.fkeyid</span><br><span class="line">    <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span></span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">end</span> </span><br><span class="line"> <span class="keyword">else</span> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2005'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #FK  (Name, col, refObj, refCol)</span><br><span class="line"><span class="comment">--  FOR 2005</span></span><br><span class="line">  <span class="keyword">select</span> f.name, COL_NAME (fc.parent_object_id, fc.parent_column_id) , object_name(fc.referenced_object_id) , COL_NAME (fc.referenced_object_id, fc.referenced_column_id)     </span><br><span class="line">  <span class="keyword">from</span> sys.foreign_keys f</span><br><span class="line">   <span class="keyword">inner</span>  <span class="keyword">join</span>  sys.foreign_key_columns  fc  <span class="keyword">on</span> f.object_id <span class="operator">=</span> fc.constraint_object_id </span><br><span class="line">   <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> f.parent_object_id</span><br><span class="line">  <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span></span><br><span class="line">  <span class="keyword">order</span> <span class="keyword">by</span> f.name</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"> <span class="keyword">Set</span> <span class="variable">@maxj</span> <span class="operator">=</span>   @<span class="variable">@rowcount</span></span><br><span class="line"> <span class="keyword">set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"> if (<span class="variable">@maxj</span> <span class="operator">&gt;</span><span class="number">0</span>)</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">  print <span class="string">'&lt;table border="0" cellspacing="0" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Refrence Keys&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class="line">  print <span class="string">'&lt;table border="0" cellspacing="1" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Column&lt;/th&gt;&lt;th&gt;Reference To&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class="line"></span><br><span class="line">  While(<span class="variable">@j</span> <span class="operator">&lt;=</span> <span class="variable">@maxj</span>)</span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">select</span> <span class="variable">@Output</span> <span class="operator">=</span> <span class="string">'&lt;tr&gt;&lt;td width="20px" align="center"&gt;'</span> <span class="operator">+</span> <span class="built_in">Cast</span>((<span class="variable">@j</span>) <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="150px"&gt;'</span> <span class="operator">+</span> isnull(name,<span class="string">''</span>)  <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="150px"&gt;'</span> <span class="operator">+</span>  isnull(col,<span class="string">''</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td&gt;['</span> <span class="operator">+</span> isnull(refObj,<span class="string">'N'</span>) <span class="operator">+</span> <span class="string">'].['</span> <span class="operator">+</span>  isnull(refCol,<span class="string">'N'</span>) <span class="operator">+</span> <span class="string">']&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class="line">    <span class="keyword">from</span> #FK  <span class="keyword">where</span> id <span class="operator">=</span> <span class="variable">@j</span></span><br><span class="line"></span><br><span class="line">   print <span class="variable">@Output</span></span><br><span class="line">   <span class="keyword">Set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="variable">@j</span> <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  print <span class="string">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class="line"> <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">--Default Constraints </span></span><br><span class="line"> <span class="keyword">truncate</span> <span class="keyword">table</span> #<span class="keyword">Constraint</span></span><br><span class="line"> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2000'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #<span class="keyword">Constraint</span>  (Name, col, definition)</span><br><span class="line">  <span class="keyword">select</span> object_name(c.constid), col_name(c.id, c.colid), s.text</span><br><span class="line">    <span class="keyword">from</span> sysconstraints c</span><br><span class="line">     <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> c.id</span><br><span class="line">     <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> syscomments s <span class="keyword">on</span> s.id <span class="operator">=</span> c.constid</span><br><span class="line">    <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span> </span><br><span class="line">    <span class="keyword">and</span> </span><br><span class="line">    <span class="keyword">convert</span>(<span class="type">varchar</span>,<span class="operator">+</span> (c.status <span class="operator">&amp;</span> <span class="number">1</span>)<span class="operator">/</span><span class="number">1</span>)</span><br><span class="line">    <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">2</span>)<span class="operator">/</span><span class="number">2</span>)</span><br><span class="line">    <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">4</span>)<span class="operator">/</span><span class="number">4</span>)</span><br><span class="line">    <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">8</span>)<span class="operator">/</span><span class="number">8</span>)</span><br><span class="line">    <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">16</span>)<span class="operator">/</span><span class="number">16</span>)</span><br><span class="line">    <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">32</span>)<span class="operator">/</span><span class="number">32</span>)</span><br><span class="line">    <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">64</span>)<span class="operator">/</span><span class="number">64</span>)</span><br><span class="line">    <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">128</span>)<span class="operator">/</span><span class="number">128</span>) <span class="operator">=</span> <span class="string">'10101000'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">else</span> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2005'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #<span class="keyword">Constraint</span>  (Name, col, definition)</span><br><span class="line">  <span class="keyword">select</span> c.name,  col_name(parent_object_id, parent_column_id), c.definition </span><br><span class="line">  <span class="keyword">from</span> sys.default_constraints c</span><br><span class="line">   <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> c.parent_object_id</span><br><span class="line">  <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span></span><br><span class="line">  <span class="keyword">order</span> <span class="keyword">by</span> c.name</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">Set</span> <span class="variable">@maxj</span> <span class="operator">=</span>   @<span class="variable">@rowcount</span></span><br><span class="line"> <span class="keyword">set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"> if (<span class="variable">@maxj</span> <span class="operator">&gt;</span><span class="number">0</span>)</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">  print <span class="string">'&lt;table border="0" cellspacing="0" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Default Constraints&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class="line">  print <span class="string">'&lt;table border="0" cellspacing="1" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Column&lt;/th&gt;&lt;th&gt;Value&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class="line"></span><br><span class="line">  While(<span class="variable">@j</span> <span class="operator">&lt;=</span> <span class="variable">@maxj</span>)</span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">select</span> <span class="variable">@Output</span> <span class="operator">=</span> <span class="string">'&lt;tr&gt;&lt;td width="20px" align="center"&gt;'</span> <span class="operator">+</span> <span class="built_in">Cast</span>((<span class="variable">@j</span>) <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="250px"&gt;'</span> <span class="operator">+</span> isnull(name,<span class="string">''</span>)  <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="150px"&gt;'</span> <span class="operator">+</span>  isnull(col,<span class="string">''</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td&gt;'</span> <span class="operator">+</span>  isnull(definition,<span class="string">''</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class="line">    <span class="keyword">from</span> #<span class="keyword">Constraint</span>  <span class="keyword">where</span> id <span class="operator">=</span> <span class="variable">@j</span></span><br><span class="line"></span><br><span class="line">   print <span class="variable">@Output</span></span><br><span class="line">   <span class="keyword">Set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="variable">@j</span> <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"> print <span class="string">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class="line"> <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">--Check  Constraints</span></span><br><span class="line"> <span class="keyword">truncate</span> <span class="keyword">table</span> #<span class="keyword">Constraint</span></span><br><span class="line"> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2000'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #<span class="keyword">Constraint</span>  (Name, col, definition)</span><br><span class="line">   <span class="keyword">select</span> object_name(c.constid), col_name(c.id, c.colid), s.text</span><br><span class="line">    <span class="keyword">from</span> sysconstraints c</span><br><span class="line">     <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> c.id</span><br><span class="line">     <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> syscomments s <span class="keyword">on</span> s.id <span class="operator">=</span> c.constid</span><br><span class="line">    <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span> </span><br><span class="line">    <span class="keyword">and</span> ( <span class="keyword">convert</span>(<span class="type">varchar</span>,<span class="operator">+</span> (c.status <span class="operator">&amp;</span> <span class="number">1</span>)<span class="operator">/</span><span class="number">1</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">2</span>)<span class="operator">/</span><span class="number">2</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">4</span>)<span class="operator">/</span><span class="number">4</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">8</span>)<span class="operator">/</span><span class="number">8</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">16</span>)<span class="operator">/</span><span class="number">16</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">32</span>)<span class="operator">/</span><span class="number">32</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">64</span>)<span class="operator">/</span><span class="number">64</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">128</span>)<span class="operator">/</span><span class="number">128</span>) <span class="operator">=</span> <span class="string">'00101000'</span> </span><br><span class="line">    <span class="keyword">or</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,<span class="operator">+</span> (c.status <span class="operator">&amp;</span> <span class="number">1</span>)<span class="operator">/</span><span class="number">1</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">2</span>)<span class="operator">/</span><span class="number">2</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">4</span>)<span class="operator">/</span><span class="number">4</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">8</span>)<span class="operator">/</span><span class="number">8</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">16</span>)<span class="operator">/</span><span class="number">16</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">32</span>)<span class="operator">/</span><span class="number">32</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">64</span>)<span class="operator">/</span><span class="number">64</span>)</span><br><span class="line">     <span class="operator">+</span> <span class="keyword">convert</span>(<span class="type">varchar</span>,(c.status <span class="operator">&amp;</span> <span class="number">128</span>)<span class="operator">/</span><span class="number">128</span>) <span class="operator">=</span> <span class="string">'00100100'</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">else</span> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2005'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #<span class="keyword">Constraint</span>  (Name, col, definition)</span><br><span class="line">   <span class="keyword">select</span> c.name,  col_name(parent_object_id, parent_column_id), definition </span><br><span class="line">   <span class="keyword">from</span> sys.check_constraints c</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> c.parent_object_id</span><br><span class="line">   <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span></span><br><span class="line">   <span class="keyword">order</span> <span class="keyword">by</span> c.name</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">Set</span> <span class="variable">@maxj</span> <span class="operator">=</span>   @<span class="variable">@rowcount</span></span><br><span class="line"> </span><br><span class="line"> <span class="keyword">set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"> if (<span class="variable">@maxj</span> <span class="operator">&gt;</span><span class="number">0</span>)</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">  print <span class="string">'&lt;table border="0" cellspacing="0" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Check  Constraints&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class="line">  print <span class="string">'&lt;table border="0" cellspacing="1" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Column&lt;/th&gt;&lt;th&gt;Definition&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class="line"></span><br><span class="line">  While(<span class="variable">@j</span> <span class="operator">&lt;=</span> <span class="variable">@maxj</span>)</span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">select</span> <span class="variable">@Output</span> <span class="operator">=</span> <span class="string">'&lt;tr&gt;&lt;td width="20px" align="center"&gt;'</span> <span class="operator">+</span> <span class="built_in">Cast</span>((<span class="variable">@j</span>) <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="250px"&gt;'</span> <span class="operator">+</span> isnull(name,<span class="string">''</span>)  <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="150px"&gt;'</span> <span class="operator">+</span>  isnull(col,<span class="string">''</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td&gt;'</span> <span class="operator">+</span>  isnull(definition,<span class="string">''</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class="line">    <span class="keyword">from</span> #<span class="keyword">Constraint</span>  <span class="keyword">where</span> id <span class="operator">=</span> <span class="variable">@j</span></span><br><span class="line">   print <span class="variable">@Output</span> </span><br><span class="line">   <span class="keyword">Set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="variable">@j</span> <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  print <span class="string">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class="line"> <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">--Triggers </span></span><br><span class="line"> <span class="keyword">truncate</span> <span class="keyword">table</span> #<span class="keyword">Constraint</span></span><br><span class="line"> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2000'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #<span class="keyword">Constraint</span>  (Name)</span><br><span class="line">   <span class="keyword">select</span> tr.name</span><br><span class="line">   <span class="keyword">FROM</span> sysobjects tr</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> tr.parent_obj</span><br><span class="line">   <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span> <span class="keyword">and</span> tr.type <span class="operator">=</span> <span class="string">'TR'</span></span><br><span class="line">   <span class="keyword">order</span> <span class="keyword">by</span> tr.name</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">else</span> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2005'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #<span class="keyword">Constraint</span>  (Name)</span><br><span class="line">   <span class="keyword">SELECT</span> tr.name</span><br><span class="line">   <span class="keyword">FROM</span> sys.triggers tr</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> tr.parent_id</span><br><span class="line">   <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span></span><br><span class="line">   <span class="keyword">order</span> <span class="keyword">by</span> tr.name</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">Set</span> <span class="variable">@maxj</span> <span class="operator">=</span>   @<span class="variable">@rowcount</span></span><br><span class="line"> </span><br><span class="line"> <span class="keyword">set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"> if (<span class="variable">@maxj</span> <span class="operator">&gt;</span><span class="number">0</span>)</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">  print <span class="string">'&lt;table border="0" cellspacing="0" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Triggers&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class="line">  print <span class="string">'&lt;table border="0" cellspacing="1" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class="line"></span><br><span class="line">  While(<span class="variable">@j</span> <span class="operator">&lt;=</span> <span class="variable">@maxj</span>)</span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">select</span> <span class="variable">@Output</span> <span class="operator">=</span> <span class="string">'&lt;tr&gt;&lt;td width="20px" align="center"&gt;'</span> <span class="operator">+</span> <span class="built_in">Cast</span>((<span class="variable">@j</span>) <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="150px"&gt;'</span> <span class="operator">+</span> isnull(name,<span class="string">''</span>)  <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class="line">    <span class="keyword">from</span> #<span class="keyword">Constraint</span>  <span class="keyword">where</span> id <span class="operator">=</span> <span class="variable">@j</span></span><br><span class="line">   print <span class="variable">@Output</span> </span><br><span class="line">   <span class="keyword">Set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="variable">@j</span> <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  print <span class="string">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class="line"> <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">--Indexes </span></span><br><span class="line"> <span class="keyword">truncate</span> <span class="keyword">table</span> #Indexes</span><br><span class="line"> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2000'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #Indexes  (Name, type, cols)</span><br><span class="line">   <span class="keyword">select</span> i.name, <span class="keyword">case</span> <span class="keyword">when</span> i.indid <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span> <span class="string">'Heap'</span> <span class="keyword">when</span> i.indid <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span> <span class="string">'Clustered'</span> <span class="keyword">else</span> <span class="string">'Nonclustered'</span> <span class="keyword">end</span> , c.name </span><br><span class="line">   <span class="keyword">from</span> sysindexes i</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> sysindexkeys k  <span class="keyword">on</span> k.indid <span class="operator">=</span> i.indid  <span class="keyword">and</span> k.id <span class="operator">=</span> i.id</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> syscolumns c <span class="keyword">on</span> c.id <span class="operator">=</span> k.id <span class="keyword">and</span> c.colorder <span class="operator">=</span> k.colid</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> i.id</span><br><span class="line">   <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span> <span class="keyword">and</span> i.name <span class="keyword">not</span> <span class="keyword">like</span> <span class="string">'_WA%'</span></span><br><span class="line">   <span class="keyword">order</span> <span class="keyword">by</span> i.name, i.keycnt</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">else</span> if <span class="variable">@SqlVersion</span> <span class="operator">=</span> <span class="string">'2005'</span> </span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert</span> <span class="keyword">into</span> #Indexes  (Name, type, cols)</span><br><span class="line">   <span class="keyword">select</span> i.name, <span class="keyword">case</span> <span class="keyword">when</span> i.type <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span> <span class="string">'Heap'</span> <span class="keyword">when</span> i.type <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span> <span class="string">'Clustered'</span> <span class="keyword">else</span> <span class="string">'Nonclustered'</span> <span class="keyword">end</span>,  col_name(i.object_id, c.column_id)</span><br><span class="line">    <span class="keyword">from</span> sys.indexes i </span><br><span class="line">     <span class="keyword">inner</span> <span class="keyword">join</span> sys.index_columns c <span class="keyword">on</span> i.index_id <span class="operator">=</span> c.index_id <span class="keyword">and</span> c.object_id <span class="operator">=</span> i.object_id </span><br><span class="line">     <span class="keyword">inner</span> <span class="keyword">join</span> #Tables t <span class="keyword">on</span> t.object_id <span class="operator">=</span> i.object_id</span><br><span class="line">    <span class="keyword">where</span> t.id <span class="operator">=</span> <span class="variable">@i</span></span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> i.name, c.column_id</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">Set</span> <span class="variable">@maxj</span> <span class="operator">=</span>   @<span class="variable">@rowcount</span></span><br><span class="line"> </span><br><span class="line"> <span class="keyword">set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"> <span class="keyword">set</span> <span class="variable">@sr</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"> if (<span class="variable">@maxj</span> <span class="operator">&gt;</span><span class="number">0</span>)</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">  print <span class="string">'&lt;table border="0" cellspacing="0" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Indexes&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span> </span><br><span class="line">  print <span class="string">'&lt;table border="0" cellspacing="1" cellpadding="0" width="750px"&gt;&lt;tr&gt;&lt;th&gt;Sr.&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Type&lt;/th&gt;&lt;th&gt;Columns&lt;/th&gt;&lt;/tr&gt;'</span> </span><br><span class="line">  <span class="keyword">set</span> <span class="variable">@Output</span> <span class="operator">=</span> <span class="string">''</span></span><br><span class="line">  <span class="keyword">set</span> <span class="variable">@last</span> <span class="operator">=</span> <span class="string">''</span></span><br><span class="line">  <span class="keyword">set</span> <span class="variable">@current</span> <span class="operator">=</span> <span class="string">''</span></span><br><span class="line">  While(<span class="variable">@j</span> <span class="operator">&lt;=</span> <span class="variable">@maxj</span>)</span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">select</span> <span class="variable">@current</span> <span class="operator">=</span> isnull(name,<span class="string">''</span>) <span class="keyword">from</span> #Indexes  <span class="keyword">where</span> id <span class="operator">=</span> <span class="variable">@j</span></span><br><span class="line">      </span><br><span class="line">   if <span class="variable">@last</span> <span class="operator">&lt;&gt;</span> <span class="variable">@current</span>  <span class="keyword">and</span> <span class="variable">@last</span> <span class="operator">&lt;&gt;</span> <span class="string">''</span></span><br><span class="line">    <span class="keyword">begin</span> </span><br><span class="line">    print <span class="string">'&lt;tr&gt;&lt;td width="20px" align="center"&gt;'</span> <span class="operator">+</span> <span class="built_in">Cast</span>((<span class="variable">@sr</span>) <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="150px"&gt;'</span> <span class="operator">+</span> <span class="variable">@last</span> <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="150px"&gt;'</span> <span class="operator">+</span> <span class="variable">@typ</span> <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td&gt;'</span> <span class="operator">+</span> <span class="variable">@Output</span>  <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class="line">    <span class="keyword">set</span> <span class="variable">@Output</span>  <span class="operator">=</span> <span class="string">''</span></span><br><span class="line">    <span class="keyword">set</span> <span class="variable">@sr</span> <span class="operator">=</span> <span class="variable">@sr</span> <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">   </span><br><span class="line">    </span><br><span class="line">   <span class="keyword">select</span> <span class="variable">@Output</span> <span class="operator">=</span> <span class="variable">@Output</span> <span class="operator">+</span> cols <span class="operator">+</span> <span class="string">'&lt;br /&gt;'</span> , <span class="variable">@typ</span> <span class="operator">=</span> type</span><br><span class="line">     <span class="keyword">from</span> #Indexes  <span class="keyword">where</span> id <span class="operator">=</span> <span class="variable">@j</span></span><br><span class="line">   </span><br><span class="line">   <span class="keyword">set</span> <span class="variable">@last</span> <span class="operator">=</span> <span class="variable">@current</span>  </span><br><span class="line">   <span class="keyword">Set</span> <span class="variable">@j</span> <span class="operator">=</span> <span class="variable">@j</span> <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  if <span class="variable">@Output</span> <span class="operator">&lt;&gt;</span> <span class="string">''</span></span><br><span class="line">    <span class="keyword">begin</span> </span><br><span class="line">    print <span class="string">'&lt;tr&gt;&lt;td width="20px" align="center"&gt;'</span> <span class="operator">+</span> <span class="built_in">Cast</span>((<span class="variable">@sr</span>) <span class="keyword">as</span> <span class="type">varchar</span>) <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="150px"&gt;'</span> <span class="operator">+</span> <span class="variable">@last</span> <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td width="150px"&gt;'</span> <span class="operator">+</span> <span class="variable">@typ</span> <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;td&gt;'</span> <span class="operator">+</span> <span class="variable">@Output</span>  <span class="operator">+</span> <span class="string">'&lt;/td&gt;&lt;/tr&gt;'</span> </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  print <span class="string">'&lt;/table&gt;&lt;br /&gt;'</span></span><br><span class="line"> <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> <span class="variable">@i</span> <span class="operator">=</span> <span class="variable">@i</span> <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line"> <span class="comment">--Print @Output </span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Print <span class="string">'&lt;/body&gt;'</span></span><br><span class="line">Print <span class="string">'&lt;/html&gt;'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> #Tables</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> #Columns</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> #FK</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> #<span class="keyword">Constraint</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> #Indexes </span><br><span class="line"><span class="keyword">set</span> nocount off</span><br></pre></td></tr></tbody></table></figure>

<h2 id="GenSchemaDocToHtml-bat"><a href="#GenSchemaDocToHtml-bat" class="headerlink" title="GenSchemaDocToHtml.bat"></a>GenSchemaDocToHtml.bat</h2><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="variable">@echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> exeSqlPath<span class="operator">=</span>C:\GenDBSchemaToHtml.sql</span><br><span class="line"><span class="keyword">set</span> outputPath<span class="operator">=</span>C:\inetpub\wwwroot\DBSchema.html</span><br><span class="line"></span><br><span class="line">echo Generate DB Schema <span class="keyword">to</span> File...Execute<span class="operator">!</span></span><br><span class="line">sqlcmd <span class="operator">-</span>S [伺服器名稱] <span class="operator">-</span>U [帳號] <span class="operator">-</span>P [密碼] <span class="operator">-</span>d [資料庫名稱] <span class="operator">-</span>i <span class="operator">%</span>exeSqlPath<span class="operator">%</span> <span class="operator">-</span>o <span class="operator">%</span>outputPath<span class="operator">%</span></span><br><span class="line">echo Generate DB Schema <span class="keyword">to</span> File...Done<span class="operator">!</span></span><br></pre></td></tr></tbody></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Windows/" rel="tag"><i class="fa fa-tag"></i> Windows</a>
              <a href="/tags/Mssql/" rel="tag"><i class="fa fa-tag"></i> Mssql</a>
              <a href="/tags/html/" rel="tag"><i class="fa fa-tag"></i> html</a>
              <a href="/tags/Batch/" rel="tag"><i class="fa fa-tag"></i> Batch</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/724330086/" rel="prev" title="使用 cli 部署 dotnet 站台">
                  <i class="fa fa-angle-left"></i> 使用 cli 部署 dotnet 站台
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/1763796179/" rel="next" title="自動更新當前目錄下所有 Git 儲存庫">
                  自動更新當前目錄下所有 Git 儲存庫 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-gitalk">Gittalk</a></li>
            <li class="tab"><a href="#comment-disqus">Disqus</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane gitalk" id="comment-gitalk">
              <div class="comments gitalk-container"></div>
            </div>
            <div class="tab-pane disqus" id="comment-disqus">
              
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
            </div>
        </div>
      </div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2022 – 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">KuoAnn</span>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="回到頂端">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="600" alpha="0.3" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.umd.js" integrity="sha256-ytMJGN3toR+a84u7g7NuHm91VIR06Q41kMWDr2pq7Zo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  




<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"https-kuoann-github-io","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"KuoAnn","repo":"kuoann.github.io","client_id":"07ab0fda6282671c05f2","client_secret":"96bd77e90fb5809b8df39cea1b9628540339f3a1","admin_user":"KuoAnn","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-TW","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"cdd82261117e2c13ce77d7404555d969"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
